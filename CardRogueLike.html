<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>å¡ç‰Œè‚‰é¸½å†’é™©</title>
    <style>
        /* ç§»åŠ¨è®¾å¤‡å“åº”å¼è®¾è®¡ */
        @media screen and (max-width: 768px) {
            /* åŸºç¡€å¸ƒå±€è°ƒæ•´ */
            .screen {
                padding: 10px;
            }
            
            h2 {
                font-size: 1.5rem;
                margin-bottom: 20px;
            }
            
            h3 {
                font-size: 1.2rem;
            }
            
            /* æˆ˜æ–—ç•Œé¢å¸ƒå±€ */
            .battle-area {
                flex-direction: column;
                gap: 15px;
            }
            
            .enemy {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .enemy-display {
                padding: 10px;
            }
            
            .player-status {
                width: 100%;
                padding: 10px;
            }
            
            /* å¡ç‰Œå°ºå¯¸è°ƒæ•´ */
            .cards-grid {
                grid-template-columns: repeat(auto-fill, 100px);
                gap: 8px;
            }
            
            .card {
                width: 100px;
                height: 140px;
                font-size: 0.65rem;
                padding: 6px;
            }
            
            .card-name {
                font-size: 0.75rem;
                margin-bottom: 2px;
            }
            
            .card-cost {
                font-size: 0.7rem;
            }
            
            .card-description {
                font-size: 0.6rem;
                line-height: 1.2;
            }
            
            /* æ‰‹ç‰ŒåŒºåŸŸä¼˜åŒ– */
            .hand {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 10px;
            }
            
            /* è§’è‰²é€‰æ‹©ç•Œé¢ä¼˜åŒ– */
            .character-select {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            
            .character-card {
                padding: 12px;
            }
            
            .character-card h3 {
                font-size: 0.9rem;
            }
            
            .character-card p {
                font-size: 0.7rem;
                line-height: 1.3;
            }
            
            /* æŒ‰é’®ä¼˜åŒ– - å¢åŠ ç‚¹å‡»åŒºåŸŸ */
            .btn {
                padding: 12px 20px;
                font-size: 0.9rem;
                min-width: 120px;
            }
            
            /* æˆ˜æ–—æ—¥å¿—ä¼˜åŒ– */
            .log {
                max-height: 120px;
                font-size: 0.75rem;
                line-height: 1.3;
            }
            
            /* èƒ½é‡å’ŒçŠ¶æ€æ˜¾ç¤ºä¼˜åŒ– */
            .energy-display {
                font-size: 0.9rem;
                margin-bottom: 8px;
            }
            
            .health-bar {
                height: 15px;
            }
            
            /* ç‰Œç»„ç®¡ç†ç•Œé¢ä¼˜åŒ– */
            .deck-area {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .cards-scroll-area {
                max-height: 200px;
            }
        }
        
        /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
        @media (hover: none) and (pointer: coarse) {
            .card:active {
                transform: scale(0.95);
                box-shadow: 
                    0 2px 4px rgba(0,0,0,0.3),
                    inset 0 1px 0 rgba(255,255,255,0.2);
            }
            
            .btn:active {
                transform: scale(0.95);
            }
        }
        
        /* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background-image: url('backgroudImage.jpeg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            min-height: 100vh;
            color: white;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4); /* æ·»åŠ åŠé€æ˜é»‘è‰²å åŠ ï¼Œæé«˜æ–‡å­—å¯è¯»æ€§ */
            pointer-events: none;
            z-index: -1;
        }
        
        html {
            height: 100%;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
        }
        
        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .game-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .game-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .stat {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .screen {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .screen.active {
            display: block;
        }
        
        /* é¦–é¡µèœå•æ˜¾ç¤ºæ—¶éšè—æ¸¸æˆç»Ÿè®¡ä¿¡æ¯ */
        #homeScreen.active {
            position: relative;
        }
        
        #homeScreen.active ~ .game-header .game-stats {
            display: none;
        }
        
        /* é¦–é¡µèœå•æ ·å¼ */
        .home-menu {
            text-align: center;
            padding: 50px 20px;
        }
        
        .home-menu h1 {
            font-size: 3rem;
            margin-bottom: 50px;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            to { text-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.5); }
        }
        
        .home-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 300px;
            margin: 0 auto;
        }
        
        .home-btn {
            width: 100%;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border: 2px solid #667eea;
            border-radius: 10px;
            background: rgba(102, 126, 234, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .home-btn:hover {
            background: rgba(102, 126, 234, 0.4);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        /* æ¸¸æˆç®€ä»‹æ ·å¼ */
        .game-intro {
            max-width: 600px;
            margin: 40px auto 0;
            padding: 25px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 1s ease-out;
        }
        
        .game-intro h3 {
            color: #ffd700;
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .game-intro p {
            color: #fff;
            margin-bottom: 10px;
            line-height: 1.6;
            text-align: left;
        }
        
        .game-intro p strong {
            color: #667eea;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .character-select {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin: 0 auto 40px;
            max-width: 1200px;
            padding: 0 20px;
        }
        
        .character-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .character-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .character-card:hover {
            border-color: #ffd700;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        .character-card.selected {
            border-color: #ffd700;
            background: rgba(255,215,0,0.2);
        }
        
        .character-icon {
            font-size: 20rem;
            margin-bottom: 10px;
        }
        
        .deck-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .deck-section {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }
        
        .cards-scroll-area {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
            scrollbar-width: thin;
            scrollbar-color: rgba(255,255,255,0.3) transparent;
        }
        
        .cards-scroll-area::-webkit-scrollbar {
            width: 8px;
        }
        
        .cards-scroll-area::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        
        .cards-scroll-area::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
        }
        
        .cards-scroll-area::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.5);
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, 140px);
            gap: 12px;
            margin-top: 15px;
            justify-content: center;
        }
        
        .card {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border: 3px solid #ffd700;
            border-radius: 12px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.75rem;
            width: 140px;
            height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.3), 
                inset 0 1px 0 rgba(255,255,255,0.2),
                0 0 20px rgba(255,215,0,0.1);
        }
        
        /* è§’è‰²å›¾æ ‡æ ·å¼ */
        .character-icon {
            position: absolute;
            top: 5px;
            left: 5px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 25px;
            font-weight: bold;
            color: black;
            z-index: 10;
            border: 1px solid rgba(0,0,0,0.3);
        }
        
        .character-knight { background: #FFD700; } /* é‡‘è‰² - éª‘å£« */
        .character-priest { background: #FFFFFF; } /* ç™½è‰² - ç‰§å¸ˆ */
        .character-warlock { background: #800080; color: white; } /* ç´«è‰² - æœ¯å£« */
        .character-hunter { background: #008000; color: white; } /* ç»¿è‰² - çŒäºº */
        .character-warrior { background: #8B0000; color: white; } /* çº¢è‰² - æˆ˜å£« */
        .character-rogue { background: #8B4513; color: white; } /* æ£•è‰² - ç›—è´¼ */
        .character-mage { background: #0000FF; color: white; } /* è“è‰² - æ³•å¸ˆ */
        .character-neutral { background: #C0C0C0; } /* é“¶è‰² - é€šç”¨ */
        .character-curse { background: #4B0082; color: white; } /* é›è“è‰² - è¯…å’’ */
        .character-legendary { background: #FFA500; } /* æ©™è‰² - ä¼ è¯´ */
        
        /* å¡ç‰Œåˆ†ç±»æ ·å¼ */
        .card-category {
            margin-top: 20px;
            margin-bottom: 15px;
        }
        
        .category-header {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            padding: 8px 12px;
            background-color: #f0f0f0;
            border-radius: 6px;
            border-left: 4px solid #4CAF50;
        }
        
        .category-header.current-character {
            border-left: 4px solid #2196F3;
            background-color: #e3f2fd;
            font-size: 17px;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            border-radius: 12px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card-art {
            width: 100%;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
            position: relative;
        }
        
        .stickman-art {
            width: 50px;
            height: 50px;
            position: relative;
        }
        
        .card.attack {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border-color: #ff4444;
        }
        
        .card.defense {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            border-color: #00bcd4;
        }
        
        .card.magic {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            color: #333;
            border-color: #9c27b0;
        }
        
        .card.special {
            background: linear-gradient(135deg, #ffd89b, #19547b);
            border-color: #ff9800;
        }
        
        .card.curse {
            background: linear-gradient(135deg, #2c1810, #8b0000);
            border-color: #ff0000;
            box-shadow: 0 4px 8px rgba(255, 0, 0, 0.5), inset 0 1px 0 rgba(255,0,0,0.2);
        }
        
        .card.rarity-common {
            border-color: #ffffff;
        }
        
        .card.rarity-uncommon {
            border-color: #00ff00;
            box-shadow: 0 4px 8px rgba(0, 255, 0, 0.3), inset 0 1px 0 rgba(255,255,255,0.2);
        }
        
        .card.rarity-rare {
            border-color: #0080ff;
            box-shadow: 0 4px 8px rgba(0, 128, 255, 0.4), inset 0 1px 0 rgba(255,255,255,0.2);
        }
        
        .card.rarity-curse {
            border-color: #ff0000;
            box-shadow: 0 4px 8px rgba(255, 0, 0, 0.5), inset 0 1px 0 rgba(255,0,0,0.2);
        }
        
        .card.rarity-legendary {
            border-color: #ffd700;
            background: linear-gradient(135deg, #ffd700, #ff8c00, #ffd700);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.8), inset 0 1px 0 rgba(255,255,255,0.3);
            animation: legendaryGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes legendaryGlow {
            from { 
                box-shadow: 0 4px 12px rgba(255, 215, 0, 0.8), inset 0 1px 0 rgba(255,255,255,0.3);
                transform: scale(1);
            }
            to { 
                box-shadow: 0 6px 20px rgba(255, 215, 0, 1), inset 0 1px 0 rgba(255,255,255,0.5);
                transform: scale(1.02);
            }
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .card-name {
            font-weight: bold;
            margin-bottom: 3px;
            font-size: 0.8rem;
            line-height: 1.1;
        }
        
        .card-cost {
            font-size: 0.7rem;
            opacity: 0.9;
            background: rgba(0,0,0,0.3);
            padding: 2px 6px;
            border-radius: 8px;
            margin: 2px 0;
        }
        
        .card-description {
            font-size: 0.65rem;
            line-height: 1.2;
            opacity: 0.9;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            margin-top: 3px;
        }
        
        .battle-area {
            background: linear-gradient(135deg, rgba(0,0,0,0.3), rgba(255,255,255,0.1));
            border: 2px solid rgba(255,215,0,0.3);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            height: auto;
            min-height: 600px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }
        
        .enemy {
            text-align: center;
            margin-bottom: 12px;
            padding: 10px;
            background: linear-gradient(135deg, rgba(255,0,0,0.2), rgba(139,0,0,0.3));
            border: 2px solid rgba(255,0,0,0.4);
            border-radius: 15px;
            position: relative;
            box-shadow: 0 4px 16px rgba(255,0,0,0.2);
            flex-shrink: 0;
            max-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .enemy::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff0000, #ff4444, #ff0000);
            border-radius: 15px;
            z-index: -1;
            animation: enemyGlow 2s ease-in-out infinite alternate;
        }
        
        .enemy.boss::before {
            background: linear-gradient(45deg, #ffd700, #ff8c00, #ffd700, #ff8c00);
            animation: bossGlow 1.5s ease-in-out infinite alternate;
        }
        
        .boss-phase {
            background: linear-gradient(135deg, rgba(255,215,0,0.3), rgba(255,140,0,0.3));
            border: 2px solid rgba(255,215,0,0.6);
            border-radius: 10px;
            padding: 8px;
            margin: 4px 0;
            text-align: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }
        
        @keyframes bossGlow {
            from { 
                opacity: 0.6;
                background: linear-gradient(45deg, #ffd700, #ff8c00, #ffd700, #ff8c00);
            }
            to { 
                opacity: 1;
                background: linear-gradient(45deg, #ffff00, #ffd700, #ffff00, #ffd700);
            }
        }
        
        @keyframes enemyGlow {
            from { opacity: 0.3; }
            to { opacity: 0.7; }
        }
        
        .enemy-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
            min-height: 0;
        }
        
        .enemy-art {
            width: 45px;
            height: 45px;
            margin-bottom: 4px;
            position: relative;
            flex-shrink: 0;
        }
        
        .health-bar {
            background: rgba(0,0,0,0.4);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin: 3px 0;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
            width: 100%;
            flex-shrink: 0;
        }
        
        .health-fill {
            background: linear-gradient(90deg, #ff6b6b, #ee5a24);
            height: 100%;
            transition: width 0.5s ease;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
        }
        
        .player-health .health-fill {
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
        }
        
        .player-status {
            background: linear-gradient(135deg, rgba(0,255,0,0.1), rgba(0,200,0,0.2));
            border: 2px solid rgba(0,255,0,0.3);
            border-radius: 15px;
            padding: 8px;
            margin: 8px 0;
            text-align: center;
            box-shadow: 0 4px 16px rgba(0,255,0,0.1);
            flex-shrink: 0;
        }
        
        .energy-display {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700, #ffb347);
            color: #333;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(255,215,0,0.3);
        }
        
        .hand {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 8px;
            flex: 1;
            align-items: flex-start;
            min-height: 140px;
        }
        
        .hand .card {
            min-width: 90px;
            width: 90px;
            height: 140px;
            font-size: 0.65rem;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.2),
                inset 0 1px 0 rgba(255,255,255,0.2);
            /* iOSè§¦æ‘¸ä¼˜åŒ– */
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.3);
            user-select: none;
            touch-action: manipulation;
            min-width: 120px;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 6px 20px rgba(0,0,0,0.3),
                0 0 30px rgba(102, 126, 234, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn:disabled::before {
            display: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #ffd700, #ffb347);
            color: #333;
        }
        
        .btn-primary:hover {
            box-shadow: 
                0 6px 20px rgba(0,0,0,0.3),
                0 0 30px rgba(255, 215, 0, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
        }
        
        .btn-danger:hover {
            box-shadow: 
                0 6px 20px rgba(0,0,0,0.3),
                0 0 30px rgba(255, 107, 107, 0.4);
        }
        
        .rewards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .reward-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .reward-card:hover {
            border-color: #ffd700;
            transform: translateY(-5px);
        }
        
        .log {
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            padding: 12px;
            margin-top: 10px;
            min-height: 80px;
            max-height: 150px;
            overflow-y: auto;
            font-size: 0.85rem;
            flex-shrink: 0;
            border: 2px solid rgba(255,215,0,0.4);
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.5);
        }
        
        /* ç¾åŒ–æ»šåŠ¨æ¡ */
        .log::-webkit-scrollbar {
            width: 8px;
        }
        
        .log::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.3);
            border-radius: 4px;
        }
        
        .log::-webkit-scrollbar-thumb {
            background: rgba(255,215,0,0.5);
            border-radius: 4px;
        }
        
        .log::-webkit-scrollbar-thumb:hover {
            background: rgba(255,215,0,0.7);
        }
        
        .log-entry {
            margin-bottom: 6px;
            padding: 4px 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            color: #fff;
            line-height: 1.4;
        }
        
        /* ä¸ºä¸åŒç±»å‹çš„æ—¥å¿—æ·»åŠ ä¸åŒé¢œè‰² */
        .log-entry.damage {
            color: #ff8888;
        }
        
        .log-entry.heal {
            color: #88ff88;
        }
        
        .log-entry.buff {
            color: #8888ff;
        }
        
        .log-entry.debuff {
            color: #ff88ff;
        }
        
        .log-entry.system {
            color: #ffcc88;
        }
        
        .buff {
            background: linear-gradient(135deg, rgba(255,215,0,0.3), rgba(255,140,0,0.2));
            border: 2px solid #ffd700;
            border-radius: 8px;
            padding: 6px 12px;
            margin: 3px;
            display: inline-block;
            font-size: 0.8rem;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            box-shadow: 
                0 2px 6px rgba(255,215,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2);
            position: relative;
            overflow: hidden;
        }
        
        .buff::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: buffShine 2s ease-in-out infinite;
        }
        
        @keyframes buffShine {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: 100%; }
        }
        
        .damage-number {
            position: absolute;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff4444;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            pointer-events: none;
            z-index: 1000;
            animation: damageFloat 1s ease-out forwards;
        }
        
        .heal-number {
            position: absolute;
            font-size: 1.5rem;
            font-weight: bold;
            color: #44ff44;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            pointer-events: none;
            z-index: 1000;
            animation: damageFloat 1s ease-out forwards;
        }
        
        @keyframes damageFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            50% {
                opacity: 1;
                transform: translateY(-30px) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translateY(-60px) scale(0.8);
            }
        }
        
        .shake-animation {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .flash-red {
            animation: flashRed 0.3s ease-in-out;
        }
        
        @keyframes flashRed {
            0%, 100% { background-color: transparent; }
            50% { background-color: rgba(255, 0, 0, 0.3); }
        }
        
        /* æ•™ç¨‹æŒ‰é’®æ ·å¼ */
        .tutorial-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 10px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* æ€ªç‰©å›¾é‰´æŒ‰é’®æ ·å¼ */
        .monster-pedia-button {
            position: fixed;
            top: 20px;
            right: 160px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 10px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .monster-pedia-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        .tutorial-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }
        
        /* æ•™ç¨‹å¼¹çª—æ ·å¼ */
        .tutorial-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .tutorial-content {
            background: rgba(255, 255, 255, 0.95);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            color: #333;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.3s ease-out;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .tutorial-content h2 {
            color: #667eea;
            margin-top: 0;
            text-align: center;
            font-size: 2rem;
            margin-bottom: 30px;
        }
        
        .tutorial-content h3 {
            color: #764ba2;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .tutorial-content p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .tutorial-content ul,
        .tutorial-content ol {
            margin-bottom: 20px;
            padding-left: 25px;
        }
        
        .tutorial-content li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .tutorial-content strong {
            color: #667eea;
        }
        
        /* æ•™ç¨‹æ ‡ç­¾é¡µæ ·å¼ */
        .tutorial-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        
        .tutorial-tab {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid transparent;
            border-radius: 25px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #667eea;
        }
        
        .tutorial-tab:hover {
            background: rgba(102, 126, 234, 0.2);
        }
        
        .tutorial-tab.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        /* æ•™ç¨‹æ ‡ç­¾é¡µå†…å®¹æ ·å¼ */
        .tutorial-tab-content {
            display: none;
            animation: tabContentFadeIn 0.3s ease-out;
        }
        
        @keyframes tabContentFadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .tutorial-tab-content.active {
            display: block;
        }
        
        /* å…³é—­æŒ‰é’®æ ·å¼ */
        .tutorial-close,
        .monster-pedia-close {
            color: #667eea;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .tutorial-close:hover,
        .tutorial-close:focus,
        .monster-pedia-close:hover,
        .monster-pedia-close:focus {
            color: #764ba2;
            text-decoration: none;
        }
        
        /* åº•éƒ¨æŒ‰é’®æ ·å¼ */
        .tutorial-footer,
        .monster-pedia-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        
        /* æ€ªç‰©å›¾é‰´å¼¹çª—æ ·å¼ */
        .monster-pedia-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .monster-pedia-content {
            background: rgba(255, 255, 255, 0.95);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 900px;
            max-height: 80vh;
            overflow-y: auto;
            color: #333;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalFadeIn 0.3s ease-out;
        }
        
        .monster-pedia-content h2 {
            color: #667eea;
            margin-top: 0;
            text-align: center;
            font-size: 2rem;
            margin-bottom: 30px;
        }
        
        .monster-pedia-content h3 {
            color: #764ba2;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .monster-pedia-content h4 {
            color: #667eea;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .monster-pedia-content p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .monster-pedia-content ul,
        .monster-pedia-content ol {
            margin-bottom: 20px;
            padding-left: 25px;
        }
        
        .monster-pedia-content li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .monster-pedia-content strong {
            color: #667eea;
        }
        
        /* æ€ªç‰©å›¾é‰´æ ‡ç­¾é¡µæ ·å¼ */
        .monster-pedia-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        
        .monster-pedia-tab {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid transparent;
            border-radius: 25px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #667eea;
        }
        
        .monster-pedia-tab:hover {
            background: rgba(102, 126, 234, 0.2);
        }
        
        .monster-pedia-tab.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        /* æ€ªç‰©å›¾é‰´æ ‡ç­¾é¡µå†…å®¹æ ·å¼ */
        .monster-pedia-tab-content {
            display: none;
            animation: tabContentFadeIn 0.3s ease-out;
        }
        
        .monster-pedia-tab-content.active {
            display: block;
        }
        
        /* æ€ªç‰©å¡ç‰‡æ ·å¼ */
        .monster-card {
            background: rgba(102, 126, 234, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .monster-card:hover {
            background: rgba(102, 126, 234, 0.1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.15);
        }
        
        /* BOSSæ€ªç‰©å¡ç‰‡æ ·å¼ */
        .boss-card {
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.1), rgba(204, 0, 0, 0.1));
            border: 2px solid rgba(255, 153, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .boss-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 153, 0, 0.2) 0%, rgba(255, 153, 0, 0) 70%);
            animation: glowPulse 3s ease-in-out infinite;
        }
        
        .boss-card:hover {
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.15), rgba(204, 0, 0, 0.15));
            box-shadow: 0 6px 20px rgba(255, 153, 0, 0.3);
            transform: translateY(-2px);
        }
        
        /* BOSSå›¾æ ‡æ ·å¼ */
        .boss-icon {
            position: relative;
            margin-right: 20px;
        }
        
        /* BOSSè‰ºæœ¯å›¾åƒæ ·å¼ */
        .boss-art {
            width: 60px;
            height: 60px;
            animation: dragonFloat 5s ease-in-out infinite;
        }
        
        /* BOSSåç§°æ ·å¼ */
        .boss-name {
            color: #ff9900;
            text-shadow: 0 0 8px rgba(255, 153, 0, 0.6);
            font-size: 1.4rem;
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes glowPulse {
            0%, 100% {
                opacity: 0.3;
                transform: scale(0.9);
            }
            50% {
                opacity: 0.6;
                transform: scale(1.1);
            }
        }
        
        @keyframes dragonFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            25% {
                transform: translateY(-5px) rotate(2deg);
            }
            75% {
                transform: translateY(5px) rotate(-2deg);
            }
        }
        
        .monster-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .monster-icon {
            font-size: 2rem;
            margin-right: 15px;
        }
        
        .monster-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #667eea;
            margin: 0;
        }
        
        .monster-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.5);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
        }
        
        .ability-list {
            margin-top: 15px;
        }
        
        .ability-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .ability-icon {
            font-size: 1.2rem;
            margin-right: 10px;
            margin-top: 2px;
        }
        
        .ability-info {
            flex: 1;
        }
        
        .ability-name {
            font-weight: bold;
            color: #764ba2;
        }
        
        .phase-indicator {
            background: #764ba2;
            color: white;
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .phase-divider {
            height: 3px;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
            margin: 30px 0;
            border: none;
        }
        
        /* å¥–åŠ±ç•Œé¢æ ·å¼ä¼˜åŒ– */
        .rewards {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 800px;
            margin: 30px auto;
        }
        
        .reward-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            width: 220px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .reward-card:hover {
            border-color: #ffd700;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        .reward-card h3 {
            color: #ffd700;
            margin-top: 0;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .reward-card p {
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .reward-card p:last-child {
            font-size: 0.9rem;
            color: #ccc;
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- æ•™ç¨‹æŒ‰é’® -->
    <div id="monsterPediaButton" class="monster-pedia-button">
        ğŸ“– æ€ªç‰©å›¾é‰´
    </div>
    
    <div id="tutorialButton" class="tutorial-button">
        â“ æ•™ç¨‹
    </div>
    
    <!-- æ€ªç‰©å›¾é‰´å¼¹çª— -->
    <div id="monsterPediaModal" class="monster-pedia-modal">
        <div class="monster-pedia-content">
            <span class="monster-pedia-close">&times;</span>
            <h2>æ€ªç‰©å›¾é‰´</h2>
            
            <div class="monster-pedia-tabs">
                    <button class="monster-pedia-tab active" data-tab="normalMonsters">æ™®é€šæ€ªç‰©</button>
                    <button class="monster-pedia-tab" data-tab="eliteMonsters">ç²¾è‹±æ€ªç‰©</button>
                    <button class="monster-pedia-tab" data-tab="bossMonsters">BOSSæ€ªç‰©</button>
                </div>
            
            <div id="normalMonsters" class="monster-pedia-tab-content active">
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ‘¹</div>
                        <h3 class="monster-name">å“¥å¸ƒæ—</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 28</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 6</div>
                        <div class="stat-item">ç±»å‹: åŸºç¡€</div>
                    </div>
                    <p>æœ€åŸºç¡€çš„æ•Œäººï¼Œæ”»å‡»ç®€å•ç›´æ¥ã€‚ä½œä¸ºæ–°æ‰‹é‡åˆ°çš„ç¬¬ä¸€ä¸ªæ•Œäººï¼Œä»–ä»¬è¡ŒåŠ¨æ¨¡å¼ç®€å•ï¼Œæ˜¯ç†Ÿæ‚‰æˆ˜æ–—ç³»ç»Ÿçš„å¥½å¯¹æ‰‹ã€‚</p>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ¹</div>
                        <h3 class="monster-name">å“¥å¸ƒæ—å¼“æ‰‹</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 22</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 8</div>
                        <div class="stat-item">ç±»å‹: è¿œç¨‹</div>
                    </div>
                    <p>è¿œç¨‹æ”»å‡»æ•Œäººï¼Œæœ‰å‡ ç‡é€ æˆé¢å¤–ä¼¤å®³ã€‚è™½ç„¶ç”Ÿå‘½å€¼è¾ƒä½ï¼Œä½†é«˜æ”»å‡»åŠ›å’Œç²¾å‡†å°„å‡»èƒ½åŠ›è®©ä»–ä»¬æˆä¸ºä¸å¯å°è§‘çš„å¨èƒã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ¯</div>
                            <div class="ability-info">
                                <div class="ability-name">ç²¾å‡†å°„å‡»</div>
                                <div class="ability-description">æœ‰å‡ ç‡å¯¹ç©å®¶é€ æˆé¢å¤–çš„ç©¿é€ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ§Œ</div>
                        <h3 class="monster-name">å…½äººæˆ˜å£«</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 42</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 10</div>
                        <div class="stat-item">ç±»å‹: è¿‘æˆ˜</div>
                    </div>
                    <p>å¼ºå£®çš„è¿‘æˆ˜æ•Œäººï¼Œå½“ç”Ÿå‘½å€¼é™ä½æ—¶ä¼šè¿›å…¥ç‹‚æ€’çŠ¶æ€ï¼Œæ”»å‡»åŠ›å¤§å¹…æå‡ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">âš”ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">ç‹‚æ€’</div>
                                <div class="ability-description">å½“ç”Ÿå‘½å€¼ä½äº50%æ—¶ï¼Œæ”»å‡»åŠ›æå‡50%ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ¥·</div>
                        <h3 class="monster-name">æš—å½±åˆºå®¢</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 30</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 12</div>
                        <div class="stat-item">ç±»å‹: åˆºå®¢</div>
                    </div>
                    <p>æ“…é•¿æ½œè¡Œå’Œæ¯’ç´ æ”»å‡»çš„æ•Œäººï¼Œè¡ŒåŠ¨è¿…é€Ÿï¼Œéš¾ä»¥è¢«æ”»å‡»å‘½ä¸­ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ‘»</div>
                            <div class="ability-info">
                                <div class="ability-name">æ½œè¡Œ</div>
                                <div class="ability-description">æœ‰å‡ ç‡é—ªé¿ç©å®¶çš„æ”»å‡»ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ©¸</div>
                            <div class="ability-info">
                                <div class="ability-name">æ¯’ç´ </div>
                                <div class="ability-description">æ”»å‡»ä¼šä½¿ç©å®¶ä¸­æ¯’ï¼Œæ¯å›åˆé€ æˆæŒç»­ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="eliteMonsters" class="monster-pedia-tab-content">
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ—¿</div>
                        <h3 class="monster-name">çŸ³å¤´å·¨äºº</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 65</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 8</div>
                        <div class="stat-item">ç±»å‹: å¦å…‹</div>
                    </div>
                    <p>é«˜è¡€é‡é«˜é˜²å¾¡çš„ç²¾è‹±æ•Œäººï¼Œæ”»å‡»è€…ä¼šå—åˆ°åä¼¤ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ›¡ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">æŠ¤ç”²</div>
                                <div class="ability-description">æœ‰å‡ ç‡è·å¾—é¢å¤–çš„æŠ¤ç”²ï¼Œå‡å°‘å—åˆ°çš„ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒµ</div>
                            <div class="ability-info">
                                <div class="ability-name">è†æ£˜</div>
                                <div class="ability-description">æ”»å‡»è€…ä¼šå—åˆ°æ‰€é€ æˆä¼¤å®³çš„ä¸€éƒ¨åˆ†åå¼¹ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ‘º</div>
                        <h3 class="monster-name">ç«ç„°æ¶é­”</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 48</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 14</div>
                        <div class="stat-item">ç±»å‹: é­”æ³•</div>
                    </div>
                    <p>æŒæ§ç«ç„°çš„ç²¾è‹±æ•Œäººï¼Œç«ç„°æ”»å‡»ä¼šé€ æˆæŒç»­ç‡ƒçƒ§ä¼¤å®³ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ”¥</div>
                            <div class="ability-info">
                                <div class="ability-name">ç‡ƒçƒ§</div>
                                <div class="ability-description">æ”»å‡»ä¼šä½¿ç©å®¶ç‡ƒçƒ§ï¼Œæ¯å›åˆé€ æˆæŒç»­ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ›¡ï¸ğŸ”¥</div>
                            <div class="ability-info">
                                <div class="ability-name">ç«ç„°æŠ¤ç›¾</div>
                                <div class="ability-description">æœ‰å‡ ç‡è·å¾—ç«ç„°æŠ¤ç›¾ï¼Œå‡å°‘å—åˆ°çš„ä¼¤å®³å¹¶å¯¹æ”»å‡»è€…é€ æˆç‡ƒçƒ§æ•ˆæœã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ§™â€â™‚ï¸</div>
                        <h3 class="monster-name">å†°éœœæ³•å¸ˆ</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 38</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 10</div>
                        <div class="stat-item">ç±»å‹: é­”æ³•</div>
                    </div>
                    <p>ç²¾é€šå†°éœœé­”æ³•çš„æ³•å¸ˆï¼Œæ”»å‡»ä¼šå†°å†»æ•Œäººï¼Œä½¿å…¶æ— æ³•è¡ŒåŠ¨ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">â„ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">å†°å†»</div>
                                <div class="ability-description">æ”»å‡»æœ‰å‡ ç‡å†°å†»ç©å®¶ï¼Œä½¿å…¶æ— æ³•è¡ŒåŠ¨ä¸€å›åˆã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ›¡ï¸â„ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">å†°ç”²</div>
                                <div class="ability-description">æœ‰å‡ ç‡è·å¾—å†°ç”²ï¼Œå¤§å¹…å‡å°‘å—åˆ°çš„ç‰©ç†ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="bossMonsters" class="monster-pedia-tab-content">
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸ²</div>
                        <h3 class="monster-name">æš—å½±é¾™ç‹</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 200</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 18</div>
                        <div class="stat-item">ç±»å‹: BOSS (ç¬¬5å…³)</div>
                    </div>
                    <p>ç¬¬5å…³çš„å®ˆå…³BOSSï¼Œæ‹¥æœ‰å¼ºå¤§çš„æš—å½±é­”æ³•å’Œå¬å”¤èƒ½åŠ›ã€‚éšç€æˆ˜æ–—è¿›è¡Œï¼Œå®ƒä¼šè¿›å…¥ä¸åŒé˜¶æ®µï¼Œå˜å¾—è¶Šæ¥è¶Šå¼ºå¤§ã€‚</p>
                    
                    <h4><span class="phase-indicator">è§‰é†’é˜¶æ®µ</span></h4>
                    <p>æš—å½±é¾™ç‹è‹é†’ï¼Œä½¿ç”¨åŸºç¡€æ”»å‡»ã€‚è¿™æ˜¯æˆ˜æ–—çš„å¼€å§‹é˜¶æ®µï¼ŒBOSSè¿˜æ²¡æœ‰å±•ç°å…¨éƒ¨å®åŠ›ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ‘</div>
                            <div class="ability-info">
                                <div class="ability-name">æš—å½±åæ¯</div>
                                <div class="ability-description">å–·å°„æš—å½±èƒ½é‡ï¼Œå¯¹ç©å®¶é€ æˆä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ‰</div>
                            <div class="ability-info">
                                <div class="ability-name">ç¿…è†€æ”»å‡»</div>
                                <div class="ability-description">ç”¨å¼ºå¤§çš„ç¿…è†€æ”»å‡»ç©å®¶ï¼Œæœ‰å‡ ç‡é€ æˆå‡»é€€æ•ˆæœã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">æ„¤æ€’é˜¶æ®µ</span></h4>
                    <p>å½“æš—å½±é¾™ç‹ç”Ÿå‘½å€¼é™è‡³70%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šè¿›å…¥æ„¤æ€’é˜¶æ®µï¼Œå¬å”¤æš—å½±åˆ†èº«å¹¶é‡Šæ”¾è¯…å’’å…‰ç¯ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ‘¥</div>
                            <div class="ability-info">
                                <div class="ability-name">æš—å½±åˆ†èº«</div>
                                <div class="ability-description">å¬å”¤ä¸€ä¸ªæš—å½±åˆ†èº«ååŠ©æˆ˜æ–—ï¼Œåˆ†èº«å…·æœ‰æœ¬ä½“30%çš„èƒ½åŠ›ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸª¶</div>
                            <div class="ability-info">
                                <div class="ability-name">è¯…å’’å…‰ç¯</div>
                                <div class="ability-description">é‡Šæ”¾è¯…å’’å…‰ç¯ï¼Œä½¿ç©å®¶æ¯å›åˆå—åˆ°é¢å¤–ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">ç»æœ›é˜¶æ®µ</span></h4>
                    <p>å½“æš—å½±é¾™ç‹ç”Ÿå‘½å€¼é™è‡³30%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šè¿›å…¥ç»æœ›é˜¶æ®µï¼Œæ‰­æ›²ç°å®å¹¶å‡†å¤‡æœ€ç»ˆå®¡åˆ¤ã€‚è¿™æ˜¯æˆ˜æ–—çš„æœ€åé˜¶æ®µï¼ŒBOSSä¼šé‡Šæ”¾å…¶æœ€å¼ºå¤§çš„æŠ€èƒ½ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ€</div>
                            <div class="ability-info">
                                <div class="ability-name">ç°å®æ’•è£‚</div>
                                <div class="ability-description">æ’•è£‚ç°å®ï¼Œå¯¹ç©å®¶é€ æˆå·¨é¢ä¼¤å®³ï¼Œå¹¶æœ‰å‡ ç‡æ‘§æ¯ä¸€å¼ æ‰‹ç‰Œã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">â±ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">æ—¶é—´æ‰­æ›²</div>
                                <div class="ability-description">æ‰­æ›²æ—¶é—´ï¼Œä½¿ç©å®¶ä¸‹ä¸€å›åˆå°‘æŠ½ä¸€å¼ ç‰Œã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">âš–ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">æœ€ç»ˆå®¡åˆ¤</div>
                                <div class="ability-description">é‡Šæ”¾ç»ˆææŠ€èƒ½ï¼Œå¯¹ç©å®¶é€ æˆæ¯ç­æ€§ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸŒŸ</div>
                        <h3 class="monster-name">å…ƒç´ é¢†ä¸»</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 300</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 22</div>
                        <div class="stat-item">ç±»å‹: BOSS (ç¬¬10å…³)</div>
                    </div>
                    <p>ç¬¬10å…³çš„å®ˆå…³BOSSï¼ŒæŒæ§å››å¤§å…ƒç´ ä¹‹åŠ›ï¼Œä¼šåœ¨æˆ˜æ–—ä¸­è½¬æ¢ä¸åŒçš„å½¢æ€ï¼Œæ¯ç§å½¢æ€æ‹¥æœ‰ä¸åŒçš„æŠ€èƒ½å’Œç‰¹æ€§ã€‚</p>
                    
                    <h4><span class="phase-indicator">ç«ç„°å½¢æ€</span></h4>
                    <p>å…ƒç´ é¢†ä¸»ä»¥ç«ç„°å½¢æ€å‡ºç°ï¼Œç‡ƒçƒ§ä¸€åˆ‡ã€‚åœ¨è¿™ä¸ªå½¢æ€ä¸‹ï¼ŒBOSSçš„æ”»å‡»å¸¦æœ‰ç«ç„°å±æ€§ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ </div>
                            <div class="ability-info">
                                <div class="ability-name">æµæ˜Ÿæ‰“å‡»</div>
                                <div class="ability-description">å¬å”¤æµæ˜Ÿæ”»å‡»ç©å®¶ï¼Œé€ æˆé«˜é¢ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ”¥</div>
                            <div class="ability-info">
                                <div class="ability-name">ç«ç„°å…‰ç¯</div>
                                <div class="ability-description">é‡Šæ”¾ç«ç„°å…‰ç¯ï¼Œä½¿ç©å®¶æ¯å›åˆå—åˆ°ç‡ƒçƒ§ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">å†°éœœå½¢æ€</span></h4>
                    <p>å½“å…ƒç´ é¢†ä¸»ç”Ÿå‘½å€¼é™è‡³60%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šè½¬æ¢ä¸ºå†°éœœå½¢æ€ï¼Œå†°å†»æˆ˜åœºã€‚åœ¨è¿™ä¸ªå½¢æ€ä¸‹ï¼ŒBOSSçš„æ”»å‡»å¸¦æœ‰å†°éœœå±æ€§ï¼Œå¹¶ä¼šå°è¯•æ§åˆ¶ç©å®¶ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">â„ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">æš´é£é›ª</div>
                                <div class="ability-description">å¬å”¤æš´é£é›ªï¼Œå¯¹ç©å®¶é€ æˆæŒç»­ä¼¤å®³å¹¶é™ä½å…¶æ”»å‡»é€Ÿåº¦ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ”’</div>
                            <div class="ability-info">
                                <div class="ability-name">å†°ç‰¢</div>
                                <div class="ability-description">å°†ç©å®¶å›°åœ¨å†°ç‰¢ä¸­ï¼Œä½¿å…¶æ— æ³•è¡ŒåŠ¨ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">é›·ç”µå½¢æ€</span></h4>
                    <p>å½“å…ƒç´ é¢†ä¸»ç”Ÿå‘½å€¼é™è‡³30%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šè½¬æ¢ä¸ºé›·ç”µå½¢æ€ï¼Œé›·ç”µæ¯ç­ä¸€åˆ‡ã€‚è¿™æ˜¯BOSSçš„æœ€ç»ˆå½¢æ€ï¼Œæ‹¥æœ‰æœ€å¼ºå¤§çš„æ”»å‡»åŠ›ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">âš¡</div>
                            <div class="ability-info">
                                <div class="ability-name">è¿é”é—ªç”µ</div>
                                <div class="ability-description">é‡Šæ”¾è¿é”é—ªç”µï¼Œå¯¹ç©å®¶é€ æˆä¼¤å®³å¹¶ä¼ å¯¼è‡³å…¶ä»–ç›®æ ‡ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">â›ˆï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">é›·æš´</div>
                                <div class="ability-description">å¬å”¤é›·æš´ï¼Œå¯¹ç©å®¶é€ æˆæŒç»­ä¼¤å®³å¹¶æœ‰å‡ ç‡ä½¿å…¶éº»ç—¹ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">âš¡ğŸ’¥</div>
                            <div class="ability-info">
                                <div class="ability-name">èƒ½é‡è¿‡è½½</div>
                                <div class="ability-description">é‡Šæ”¾è¿‡è½½çš„èƒ½é‡ï¼Œå¯¹ç©å®¶é€ æˆæ¯ç­æ€§ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">ğŸŒŒ</div>
                        <h3 class="monster-name">è™šç©ºå›ä¸»</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 400</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 28</div>
                        <div class="stat-item">ç±»å‹: BOSS (ç¬¬15å…³)</div>
                    </div>
                    <p>ç¬¬15å…³çš„å®ˆå…³BOSSï¼Œæ¥è‡ªè™šç©ºçš„ææ€–å­˜åœ¨ï¼Œèƒ½å¤Ÿæ“æ§ç°å®å’Œå¿ƒçµã€‚</p>
                    
                    <h4><span class="phase-indicator">ç‰©è´¨å½¢æ€</span></h4>
                    <p>è™šç©ºå›ä¸»ä»¥ç‰©è´¨å½¢æ€é™ä¸´ï¼Œä½¿ç”¨åŸºç¡€çš„è™šç©ºæ”»å‡»ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒŒ</div>
                            <div class="ability-info">
                                <div class="ability-name">è™šç©ºæ‰“å‡»</div>
                                <div class="ability-description">ç”¨è™šç©ºèƒ½é‡æ”»å‡»ç©å®¶ï¼Œé€ æˆä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ’”</div>
                            <div class="ability-info">
                                <div class="ability-name">ç°å®è£‚ç—•</div>
                                <div class="ability-description">æ’•è£‚ç°å®ï¼Œå¯¹ç©å®¶é€ æˆä¼¤å®³å¹¶é™ä½å…¶æŠ¤ç”²ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">èƒ½é‡å½¢æ€</span></h4>
                    <p>å½“è™šç©ºå›ä¸»ç”Ÿå‘½å€¼é™è‡³50%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šè½¬ä¸ºçº¯èƒ½é‡ä½“ï¼Œæ“æ§å¿ƒæ™ºã€‚åœ¨è¿™ä¸ªå½¢æ€ä¸‹ï¼ŒBOSSä¼šå˜å¾—æ›´éš¾è¢«æ”»å‡»ï¼Œå¹¶å¼€å§‹æ±²å–ç©å®¶çš„ç”Ÿå‘½èƒ½é‡ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ©¸</div>
                            <div class="ability-info">
                                <div class="ability-name">èƒ½é‡æ±²å–</div>
                                <div class="ability-description">æ±²å–ç©å®¶çš„ç”Ÿå‘½èƒ½é‡ï¼Œæ¢å¤è‡ªå·±çš„ç”Ÿå‘½å€¼ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒªï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">è™šç©ºé£æš´</div>
                                <div class="ability-description">å¬å”¤è™šç©ºé£æš´ï¼Œå¯¹ç©å®¶é€ æˆæŒç»­ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ§ </div>
                            <div class="ability-info">
                                <div class="ability-name">å¿ƒçµæ§åˆ¶</div>
                                <div class="ability-description">å°è¯•æ§åˆ¶ç©å®¶çš„å¿ƒçµï¼Œä½¿å…¶æ— æ³•ä½¿ç”¨æŸäº›å¡ç‰Œã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">ç»ˆæå½¢æ€</span></h4>
                    <p>å½“è™šç©ºå›ä¸»ç”Ÿå‘½å€¼é™è‡³20%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šå±•ç°çœŸæ­£åŠ›é‡ï¼Œå¨èƒç°å®æœ¬èº«ã€‚è¿™æ˜¯æˆ˜æ–—çš„æœ€åé˜¶æ®µï¼ŒBOSSä¼šé‡Šæ”¾å…¶æœ€å¼ºå¤§çš„æŠ€èƒ½ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ’¥</div>
                            <div class="ability-info">
                                <div class="ability-name">ç°å®å´©æºƒ</div>
                                <div class="ability-description">ä½¿å‘¨å›´çš„ç°å®å´©æºƒï¼Œå¯¹ç©å®¶é€ æˆå·¨é¢ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ€</div>
                            <div class="ability-info">
                                <div class="ability-name">è™šç©ºå¥‡ç‚¹</div>
                                <div class="ability-description">å¬å”¤è™šç©ºå¥‡ç‚¹ï¼ŒæŒç»­å¸å–ç©å®¶çš„ç”Ÿå‘½å€¼å’Œèƒ½é‡ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">â˜ ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">å­˜åœ¨æŠ¹é™¤</div>
                                <div class="ability-description">å°è¯•æŠ¹é™¤ç©å®¶çš„å­˜åœ¨ï¼Œé€ æˆæ¯ç­æ€§ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card">
                    <div class="monster-header">
                        <div class="monster-icon">âœ¨</div>
                        <h3 class="monster-name">åˆ›ä¸–ç¥</h3>
                    </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 500</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 35</div>
                        <div class="stat-item">ç±»å‹: BOSS (ç¬¬20å…³)</div>
                    </div>
                    <p>ç¬¬20å…³çš„å®ˆå…³BOSSï¼ŒæŒæ§åˆ›é€ ä¸æ¯ç­çš„åŠ›é‡ï¼Œä¼šå¯¹ç©å®¶è¿›è¡Œå¤šé‡è¯•ç‚¼ã€‚</p>
                    
                    <h4><span class="phase-indicator">å®¡åˆ¤é˜¶æ®µ</span></h4>
                    <p>åˆ›ä¸–ç¥å®¡åˆ¤æŒ‘æˆ˜è€…çš„èµ„æ ¼ï¼Œä½¿ç”¨ç¥åœ£ä¹‹åŠ›è¿›è¡Œæ”»å‡»ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">âš–ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">ç¥åœ£å®¡åˆ¤</div>
                                <div class="ability-description">é‡Šæ”¾ç¥åœ£ä¹‹åŠ›ï¼Œå¯¹ç©å®¶é€ æˆä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ’«</div>
                            <div class="ability-info">
                                <div class="ability-name">åœ£å…‰</div>
                                <div class="ability-description">é‡Šæ”¾åœ£å…‰ï¼Œæ¢å¤è‡ªå·±çš„ç”Ÿå‘½å€¼ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">è¯•ç‚¼é˜¶æ®µ</span></h4>
                    <p>å½“åˆ›ä¸–ç¥ç”Ÿå‘½å€¼é™è‡³60%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šå±•ç°åˆ›é€ ä¸æ¯ç­çš„åŠ›é‡ï¼Œå¯¹ç©å®¶è¿›è¡Œæ›´ä¸¥å³»çš„è¯•ç‚¼ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒŠ</div>
                            <div class="ability-info">
                                <div class="ability-name">åˆ›é€ ä¹‹æ³¢</div>
                                <div class="ability-description">é‡Šæ”¾åˆ›é€ ä¹‹æ³¢ï¼Œå¯¹ç©å®¶é€ æˆä¼¤å®³å¹¶æ¢å¤è‡ªå·±çš„ç”Ÿå‘½å€¼ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ’¥</div>
                            <div class="ability-info">
                                <div class="ability-name">æ¯ç­å…‰æŸ</div>
                                <div class="ability-description">å‘å°„æ¯ç­å…‰æŸï¼Œå¯¹ç©å®¶é€ æˆå·¨é¢ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ”„</div>
                            <div class="ability-info">
                                <div class="ability-name">æ—¶é—´å¾ªç¯</div>
                                <div class="ability-description">åˆ›é€ æ—¶é—´å¾ªç¯ï¼Œä½¿ç©å®¶çš„æŸäº›çŠ¶æ€æŒç»­æ—¶é—´å»¶é•¿ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">ç»ˆæè¯•ç‚¼</span></h4>
                    <p>å½“åˆ›ä¸–ç¥ç”Ÿå‘½å€¼é™è‡³30%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾æœ€ç»ˆçš„è€ƒéªŒï¼Œç”Ÿæ­»è½®å›ã€‚è¿™æ˜¯æˆ˜æ–—çš„æœ€åé˜¶æ®µï¼ŒBOSSä¼šå±•ç°å…¶å…¨éƒ¨åŠ›é‡ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ€</div>
                            <div class="ability-info">
                                <div class="ability-name">åˆ›ä¸–çºªé£æš´</div>
                                <div class="ability-description">é‡Šæ”¾åˆ›ä¸–çºªé£æš´ï¼Œå¯¹ç©å®¶é€ æˆæŒç»­ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ</div>
                            <div class="ability-info">
                                <div class="ability-name">å¤©å¯</div>
                                <div class="ability-description">é‡Šæ”¾å¤©å¯ä¹‹åŠ›ï¼Œå¯¹ç©å®¶é€ æˆæ¯ç­æ€§ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">â™¾ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">é‡ç”Ÿè½®å›</div>
                                <div class="ability-description">è¿›å…¥é‡ç”Ÿè½®å›çŠ¶æ€ï¼Œæ¯å›åˆæ¢å¤ç”Ÿå‘½å€¼ï¼Œç›´åˆ°è¢«æ‰“ç ´ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="monster-card boss-card">
                        <div class="monster-header">
                            <div class="monster-icon boss-icon">
                                <svg class="enemy-art boss-art" viewBox="0 0 80 80">
                                    <defs>
                                        <linearGradient id="dragonGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#ff9900;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#cc0000;stop-opacity:1" />
                                        </linearGradient>
                                        <radialGradient id="dragonGlow" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                                            <stop offset="0%" style="stop-color:#ffcc00;stop-opacity:0.8" />
                                            <stop offset="100%" style="stop-color:#ff6600;stop-opacity:0" />
                                        </radialGradient>
                                    </defs>
                                    <g transform="translate(40,40)">
                                        <!-- å¤´éƒ¨ -->
                                        <path d="M0,-30 C-15,-25 -20,-15 -20,0 C-20,15 -15,25 0,30 C15,25 20,15 20,0 C20,-15 15,-25 0,-30 Z" fill="url(#dragonGradient)" />
                                        <!-- çœ¼ç› -->
                                        <circle cx="-10" cy="-10" r="3" fill="white" />
                                        <circle cx="10" cy="-10" r="3" fill="white" />
                                        <circle cx="-10" cy="-10" r="1.5" fill="#0000ff" />
                                        <circle cx="10" cy="-10" r="1.5" fill="#0000ff" />
                                        <!-- é¼»å­ -->
                                        <path d="M0,-25 L-5,-20 L5,-20 Z" fill="#333333" />
                                        <!-- å˜´å·´ -->
                                        <path d="M-15,-5 C-10,0 -10,5 0,10 C10,5 10,0 15,-5" stroke="#333333" stroke-width="2" fill="none" />
                                        <!-- ç‰™é½¿ -->
                                        <path d="M-10,-2 L-10,2 L-8,-2 Z" fill="white" />
                                        <path d="M0,10 L0,14 L2,10 Z" fill="white" />
                                        <path d="M10,-2 L10,2 L8,-2 Z" fill="white" />
                                        <!-- è§’ -->
                                        <path d="M0,-30 L-5,-40 L-3,-38 L0,-32 Z" fill="url(#dragonGradient)" />
                                        <path d="M0,-30 L5,-40 L3,-38 L0,-32 Z" fill="url(#dragonGradient)" />
                                        <!-- èº«ä½“ -->
                                        <path d="M0,20 C0,30 -10,40 -20,40 C-30,40 -40,30 -40,20 C-40,10 -30,0 -20,0 C-15,5 -10,10 0,20 Z" fill="url(#dragonGradient)" />
                                        <path d="M0,20 C0,30 10,40 20,40 C30,40 40,30 40,20 C40,10 30,0 20,0 C15,5 10,10 0,20 Z" fill="url(#dragonGradient)" />
                                        <!-- ç¿…è†€ -->
                                        <path d="M20,5 C25,15 35,25 35,15 C35,5 30,0 20,5 Z" fill="url(#dragonGradient)" opacity="0.8" />
                                        <path d="M-20,5 C-25,15 -35,25 -35,15 C-35,5 -30,0 -20,5 Z" fill="url(#dragonGradient)" opacity="0.8" />
                                        <!-- å°¾å·´ -->
                                        <path d="M0,40 C5,45 10,50 15,55" stroke="url(#dragonGradient)" stroke-width="4" fill="none" />
                                        <!-- çˆªå­ -->
                                        <path d="M-20,40 L-25,45 L-22,45 L-20,42 Z" fill="#333333" />
                                        <path d="M20,40 L25,45 L22,45 L20,42 Z" fill="#333333" />
                                        <!-- å‘å…‰æ•ˆæœ -->
                                        <circle cx="0" cy="0" r="45" fill="url(#dragonGlow)" />
                                        <!-- èƒ½é‡æ•ˆæœ -->
                                        <circle cx="0" cy="10" r="15" fill="none" stroke="#ffcc00" stroke-width="2" stroke-dasharray="5,3" opacity="0.6" />
                                        <!-- è…¹éƒ¨çº¹é¥° -->
                                        <path d="M0,0 C-5,5 0,10 5,5" stroke="#ffcc00" stroke-width="2" fill="none" />
                                        <path d="M0,5 C-3,10 0,15 3,10" stroke="#ffcc00" stroke-width="2" fill="none" />
                                    </g>
                                </svg>
                            </div>
                            <h3 class="monster-name boss-name">æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹</h3>
                        </div>
                    <div class="monster-stats">
                        <div class="stat-item">ç”Ÿå‘½å€¼: 650</div>
                        <div class="stat-item">æ”»å‡»åŠ›: 42</div>
                        <div class="stat-item">ç±»å‹: BOSS (ç¬¬25å…³)</div>
                    </div>
                    <p>ç¬¬25å…³çš„æœ€ç»ˆBOSSï¼Œè¿œå¤æ—¶ä»£çš„æºåˆé­”é¾™ï¼Œæ‹¥æœ‰æ— ä¸ä¼¦æ¯”çš„åŠ›é‡å’Œå¤šé˜¶æ®µçš„æˆ˜æ–—å½¢æ€ã€‚ä½œä¸ºæ¸¸æˆçš„æœ€ç»ˆæŒ‘æˆ˜ï¼Œå®ƒèåˆäº†æ‰€æœ‰å…ƒç´ çš„åŠ›é‡ï¼Œå¹¶ä¸”å…·æœ‰å¤æ´»çš„èƒ½åŠ›ã€‚</p>
                    
                    <h4><span class="phase-indicator">è¿œå¤è‹é†’</span></h4>
                    <p>æºåˆé­”é¾™ä»è¿œå¤æ²‰ç¡ä¸­è‹é†’ï¼Œå±•ç°å…¶å¤è€çš„åŠ›é‡ã€‚è¿™æ˜¯æˆ˜æ–—çš„å¼€å§‹é˜¶æ®µï¼ŒBOSSä¼šä½¿ç”¨åŸºç¡€çš„é¾™æ¯å’Œé˜²å¾¡æŠ€èƒ½ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ”¥</div>
                            <div class="ability-info">
                                <div class="ability-name">åŸå§‹ç«ç„°åæ¯</div>
                                <div class="ability-description">å–·å°„åŸå§‹ç«ç„°ï¼Œå¯¹ç©å®¶é€ æˆé«˜é¢ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ—£ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">éœ‡å¤©é¾™åŸ</div>
                                <div class="ability-description">å‘å‡ºéœ‡å¤©é¾™åŸï¼Œä½¿ç©å®¶æ²‰é»˜2å›åˆå¹¶å¤±å»2ç‚¹èƒ½é‡ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ›¡ï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">é³ç‰‡æŠ¤ç”²</div>
                                <div class="ability-description">æ¿€æ´»é³ç‰‡æŠ¤ç”²ï¼Œè·å¾—2å±‚æŠ¤ç”²ï¼Œæ¯å±‚å‡å°‘3ç‚¹å—åˆ°çš„ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">å…ƒç´ èåˆ</span></h4>
                    <p>å½“æºåˆé­”é¾™ç”Ÿå‘½å€¼é™è‡³70%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šèåˆå››å¤§å…ƒç´ ä¹‹åŠ›ï¼Œå¼€å§‹æ‰­æ›²ç°å®æ³•åˆ™ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒBOSSçš„æ”»å‡»ä¼šå˜å¾—æ›´åŠ å¤šæ ·åŒ–ï¼Œå¹¶é™„å¸¦å…ƒç´ æ•ˆæœã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒªï¸</div>
                            <div class="ability-info">
                                <div class="ability-name">å…ƒç´ æ··ä¹±</div>
                                <div class="ability-description">å¼•å‘å…ƒç´ æ··ä¹±ï¼Œé€ æˆä¼¤å®³å¹¶éšæœºæ–½åŠ ç‡ƒçƒ§ã€å†°å†»æˆ–ä¸­æ¯’æ•ˆæœã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ€</div>
                            <div class="ability-info">
                                <div class="ability-name">ç°å®æ–­è£‚</div>
                                <div class="ability-description">æ–­è£‚ç°å®ï¼Œé€ æˆä¼¤å®³å¹¶æ‘§æ¯ä¸€å¼ éšæœºæ‰‹ç‰Œã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ‘</div>
                            <div class="ability-info">
                                <div class="ability-name">æ—¶é—´æ—¥é£Ÿ</div>
                                <div class="ability-description">å¼•å‘æ—¶é—´æ—¥é£Ÿï¼Œæ¥ä¸‹æ¥2å›åˆç©å®¶æ¯å›åˆå°‘æŠ½1å¼ ç‰Œã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">ä¸–ç•Œæœ«æ—¥</span></h4>
                    <p>å½“æºåˆé­”é¾™ç”Ÿå‘½å€¼é™è‡³40%ä»¥ä¸‹æ—¶ï¼Œå®ƒä¼šé™·å…¥ç–¯ç‹‚ï¼Œé‡Šæ”¾è¶³ä»¥æ¯ç­ä¸–ç•Œçš„åŠ›é‡ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒBOSSçš„æ”»å‡»ä¼šå˜å¾—æ›´åŠ è‡´å‘½ï¼Œå¹¶ä¸”ä¼šå¼€å§‹é™ä½ç©å®¶çš„æœ€å¤§ç”Ÿå‘½å€¼ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸŒ</div>
                            <div class="ability-info">
                                <div class="ability-name">å¤§ç¾å˜</div>
                                <div class="ability-description">é‡Šæ”¾å¤§ç¾å˜ï¼Œé€ æˆå·¨é¢ä¼¤å®³å¹¶æ°¸ä¹…é™ä½ç©å®¶çš„æœ€å¤§ç”Ÿå‘½å€¼ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ©¸</div>
                            <div class="ability-info">
                                <div class="ability-name">è™šç©ºå¸æ”¶</div>
                                <div class="ability-description">æ”»å‡»å¹¶å¸æ”¶é€ æˆä¼¤å®³çš„30%ä½œä¸ºç”Ÿå‘½å€¼ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ˜ˆ</div>
                            <div class="ability-info">
                                <div class="ability-name">é¾™ç–¯ç‹‚</div>
                                <div class="ability-description">è¿›å…¥ç–¯ç‹‚çŠ¶æ€ï¼Œæ”»å‡»åŠ›å’Œæ”»å‡»é€Ÿåº¦å¤§å¹…æå‡ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">æ­»äº¡è½®å›</span></h4>
                    <p>å½“æºåˆé­”é¾™ç”Ÿå‘½å€¼é™è‡³0æ—¶ï¼Œå®ƒä¼šè¿›å…¥æ­»äº¡è½®å›çŠ¶æ€ï¼Œå¤æ´»å¹¶è·å¾—ä¸æ­»ç‰¹æ€§ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒBOSSä¼šæ±²å–ç”Ÿå‘½èƒ½é‡ï¼Œç©å®¶å¿…é¡»åœ¨5å›åˆå†…æ‰“ç ´è¿™ä¸ªçŠ¶æ€ï¼Œå¦åˆ™æˆ˜æ–—å°†å˜å¾—æ›´åŠ å›°éš¾ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ”¥</div>
                            <div class="ability-info">
                                <div class="ability-name">å¤æ´»ç«ç„°</div>
                                <div class="ability-description">åœ¨æ­»äº¡æ—¶è§¦å‘ï¼Œæ¢å¤ä¸€å®šç”Ÿå‘½å€¼å¹¶è·å¾—ä¸æ­»ç‰¹æ€§ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ’€</div>
                            <div class="ability-info">
                                <div class="ability-name">æ°¸æ’ç—›è‹¦</div>
                                <div class="ability-description">ä½¿ç©å®¶æ¯å›åˆå—åˆ°5ç‚¹ä¼¤å®³ï¼Œæ•ˆæœä¼šé€’å‡ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ©¸</div>
                            <div class="ability-info">
                                <div class="ability-name">ç”Ÿå‘½æ±²å–</div>
                                <div class="ability-description">æ±²å–ç©å®¶çš„ç”Ÿå‘½èƒ½é‡ï¼Œæ¢å¤è‡ªå·±çš„ç”Ÿå‘½å€¼ã€‚</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="phase-divider">
                    
                    <h4><span class="phase-indicator">ç»ˆç„‰æ—¶åˆ»</span></h4>
                    <p>å½“æ­»äº¡è½®å›é˜¶æ®µæŒç»­5å›åˆåï¼Œæºåˆé­”é¾™ä¼šè¿›å…¥ç»ˆç„‰æ—¶åˆ»é˜¶æ®µï¼Œå®Œå…¨è§‰é†’ä¸ºé¾™ç¥å½¢æ€ï¼Œå¸¦æ¥ç»ˆç„‰å®¡åˆ¤ã€‚åœ¨è¿™ä¸ªæœ€ç»ˆé˜¶æ®µï¼ŒBOSSä¼šè·å¾—æ— æ•ŒæŠ¤ç›¾ï¼ŒæŠ¤ç›¾ä¼šæŒç»­ä¸€æ®µæ—¶é—´åæ¶ˆå¤±ï¼Œç©å®¶å¿…é¡»æŠ“ä½æœºä¼šè¿›è¡Œæ”»å‡»ã€‚</p>
                    <div class="ability-list">
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ’¥</div>
                            <div class="ability-info">
                                <div class="ability-name">å¤©å¯å…‰æŸ</div>
                                <div class="ability-description">é‡Šæ”¾å¤©å¯å…‰æŸï¼Œå¯¹ç©å®¶é€ æˆæ¯ç­æ€§ä¼¤å®³ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">âš¡</div>
                            <div class="ability-info">
                                <div class="ability-name">æºåˆæ¹®ç­</div>
                                <div class="ability-description">ä½¿ç”¨æºåˆä¹‹åŠ›ï¼Œè¯•å›¾å½»åº•æ¹®ç­ç©å®¶ã€‚</div>
                            </div>
                        </div>
                        <div class="ability-item">
                            <div class="ability-icon">ğŸ‰</div>
                            <div class="ability-info">
                                <div class="ability-name">é¾™ç¥å½¢æ€</div>
                                <div class="ability-description">å®Œå…¨è§‰é†’ä¸ºé¾™ç¥å½¢æ€ï¼Œè·å¾—æ— æ•ŒæŠ¤ç›¾å’Œæ‰€æœ‰å…ƒç´ çš„åŠ›é‡ã€‚</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="monster-pedia-footer">
                <button class="btn" id="closeMonsterPedia">å…³é—­</button>
            </div>
        </div>
    </div>
    
    <!-- æ•™ç¨‹å¼¹çª— -->
    <div id="tutorialModal" class="tutorial-modal">
        <div class="tutorial-content">
            <span class="tutorial-close">&times;</span>
            <h2>å¡ç‰Œè‚‰é¸½å†’é™© æ¸¸æˆæ•™ç¨‹</h2>
            
            <div class="tutorial-tabs">
                <button class="tutorial-tab active" data-tab="basicInfo">åŸºæœ¬ä»‹ç»</button>
                <button class="tutorial-tab" data-tab="cardSystem">å¡ç‰Œç³»ç»Ÿ</button>
                <button class="tutorial-tab" data-tab="battleSystem">æˆ˜æ–—ç³»ç»Ÿ</button>
                <button class="tutorial-tab" data-tab="buffEffects">BUFFä¸çŠ¶æ€</button>
                <button class="tutorial-tab" data-tab="enemies">æ•Œäººä¸BOSS</button>
            </div>
            
            <div id="basicInfo" class="tutorial-tab-content active">
                <h3>æ¸¸æˆç®€ä»‹</h3>
                <p>ã€Šå¡ç‰Œè‚‰é¸½å†’é™©ã€‹æ˜¯ä¸€æ¬¾ç»“åˆäº†å¡ç‰Œæˆ˜æ–—å’Œè‚‰é¸½å…ƒç´ çš„å†’é™©æ¸¸æˆã€‚ç©å®¶å°†é€‰æ‹©ä¸€ä¸ªè§’è‰²ï¼Œé€šè¿‡æ”¶é›†å¡ç‰Œã€å‡çº§èƒ½åŠ›æ¥æŒ‘æˆ˜å„ç§æ•Œäººï¼Œæœ€ç»ˆå‡»è´¥å¼ºå¤§çš„BOSSã€‚</p>
                
                <h3>æ¸¸æˆç›®æ ‡</h3>
                <p>æ¸¸æˆå…±æœ‰25ä¸ªå…³å¡ï¼Œæ¯5å…³ä¼šé‡åˆ°ä¸€ä¸ªå¼ºå¤§çš„BOSSï¼Œæœ€ç»ˆæŒ‘æˆ˜ç¬¬25å…³çš„æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹ã€‚é€šè¿‡æ”¶é›†å¡ç‰Œã€å‡çº§èƒ½åŠ›æ¥å‡»è´¥æ‰€æœ‰æ•Œäººï¼Œè·å¾—èƒœåˆ©ï¼æ¯ä¸€åœºæˆ˜æ–—éƒ½æ˜¯ä¸€æ¬¡å…¨æ–°çš„å†’é™©ä½“éªŒï¼</p>
                
                <h3>è§’è‰²é€‰æ‹©</h3>
                <p>æ¸¸æˆå¼€å§‹æ—¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸ƒç§ä¸åŒçš„è§’è‰²ï¼š</p>
                <ul>
                    <li><strong>æˆ˜å£«</strong>ï¼šé«˜ç”Ÿå‘½å€¼å’Œç‰©ç†ä¼¤å®³ï¼Œæ“…é•¿è¿‘è·ç¦»æˆ˜æ–—</li>
                    <li><strong>æ³•å¸ˆ</strong>ï¼šå¼ºå¤§çš„é­”æ³•ä¼¤å®³å’Œæ•ˆæœï¼Œä½†ç”Ÿå‘½å€¼è¾ƒä½</li>
                    <li><strong>ç›—è´¼</strong>ï¼šé«˜æš´å‡»å‡ ç‡å’Œæ•æ·ï¼Œæ“…é•¿è¿å‡»å’Œé—ªé¿</li>
                    <li><strong>çŒäºº</strong>ï¼šç²¾å‡†çš„è¿œç¨‹æ”»å‡»å’Œæˆ˜æœ¯å¸ƒå±€ï¼Œæ“…é•¿æ§åˆ¶æˆ˜åœº</li>
                    <li><strong>éª‘å£«</strong>ï¼šæé«˜ç”Ÿå‘½å€¼å’Œé˜²å¾¡èƒ½åŠ›ï¼Œæ“…é•¿ç¥åœ£é­”æ³•å’Œèƒ½é‡ç®¡ç†</li>
                    <li><strong>ç‰§å¸ˆ</strong>ï¼šå¼ºå¤§çš„æ²»ç–—å’Œå¢ç›Šèƒ½åŠ›ï¼Œæ“…é•¿ç»´æŒè‡ªèº«å’Œé˜Ÿå‹ç”Ÿå‘½</li>
                    <li><strong>æœ¯å£«</strong>ï¼šç‰ºç‰²ç”Ÿå‘½å€¼æ¢å–å¼ºå¤§é­”æ³•ä¼¤å®³ï¼Œæ“…é•¿æš—å½±å’Œæ¶é­”é­”æ³•</li>
                </ul>
            </div>
            
            <div id="cardSystem" class="tutorial-tab-content">
                <h3>å¡ç‰Œç±»å‹</h3>
                <p>æ¸¸æˆä¸­æœ‰å¤šç§ç±»å‹çš„å¡ç‰Œï¼š</p>
                <ul>
                    <li><strong>æ”»å‡»å¡</strong>ï¼šå¯¹æ•Œäººé€ æˆä¼¤å®³</li>
                    <li><strong>é˜²å¾¡å¡</strong>ï¼šè·å¾—æŠ¤ç›¾ï¼Œå‡å°‘å—åˆ°çš„ä¼¤å®³</li>
                    <li><strong>é­”æ³•å¡</strong>ï¼šé€ æˆé­”æ³•ä¼¤å®³æˆ–é™„åŠ ç‰¹æ®Šæ•ˆæœ</li>
                    <li><strong>ç‰¹æ®Šå¡</strong>ï¼šå…·æœ‰ç‹¬ç‰¹æ•ˆæœçš„å¡ç‰Œ</li>
                    <li><strong>è¯…å’’å¡</strong>ï¼šè´Ÿé¢æ•ˆæœçš„å¡ç‰Œï¼Œé€šå¸¸ä¼šåœ¨ç‰¹æ®Šäº‹ä»¶ä¸­è·å¾—</li>
                </ul>
                
                <h3>å¡ç‰Œç¨€æœ‰åº¦</h3>
                <p>å¡ç‰Œæœ‰ä¸åŒçš„ç¨€æœ‰åº¦ï¼Œä»æ™®é€šåˆ°ä¼ å¥‡ï¼š</p>
                <ul>
                    <li><strong>æ™®é€š</strong>ï¼šåŸºç¡€å¡ç‰Œï¼Œå®¹æ˜“è·å¾—</li>
                    <li><strong>ç¨€æœ‰</strong>ï¼šæ›´å¼ºçš„å¡ç‰Œï¼Œæ•ˆæœæ›´ç‹¬ç‰¹</li>
                    <li><strong>ä¼ å¥‡</strong>ï¼šéå¸¸å¼ºå¤§çš„å¡ç‰Œï¼Œæ‹¥æœ‰ç‹¬ç‰¹çš„ç‰¹æ®Šæ•ˆæœ</li>
                </ul>
                
                <h3>å¡ç‰Œå¼ºåŒ–</h3>
                <p>åœ¨æ¸¸æˆä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é‡‘å¸å¼ºåŒ–å¡ç‰Œï¼Œæå‡å…¶æ•ˆæœã€‚å¼ºåŒ–åçš„å¡ç‰Œä¼šæœ‰"+"æ ‡è®°ã€‚</p>
            </div>
            
            <div id="battleSystem" class="tutorial-tab-content">
                <h3>æˆ˜æ–—æµç¨‹</h3>
                <p>æˆ˜æ–—éµå¾ªä»¥ä¸‹æµç¨‹ï¼š</p>
                <ol>
                    <li>ç©å®¶å›åˆï¼šä½¿ç”¨å¡ç‰Œæ”»å‡»ã€é˜²å¾¡æˆ–æ–½åŠ æ•ˆæœ</li>
                    <li>æ•Œäººå›åˆï¼šæ•Œäººæ‰§è¡Œå…¶è¡ŒåŠ¨ï¼Œå¯èƒ½æ˜¯æ”»å‡»ã€é˜²å¾¡æˆ–ä½¿ç”¨ç‰¹æ®Šèƒ½åŠ›</li>
                    <li>å›åˆç»“æŸï¼šå¼ƒç‰Œå †æ´—ç‰Œæˆä¸ºæ–°çš„ç‰Œåº“ï¼Œè¿›å…¥ä¸‹ä¸€å›åˆ</li>
                </ol>
                
                <h3>èƒ½é‡ç³»ç»Ÿ</h3>
                <p>æ¯å¼ å¡ç‰Œéƒ½éœ€è¦æ¶ˆè€—ä¸€å®šçš„èƒ½é‡æ‰èƒ½ä½¿ç”¨ã€‚æ¯å›åˆå¼€å§‹æ—¶ï¼Œæ‚¨çš„èƒ½é‡ä¼šé‡ç½®ã€‚åˆç†ç®¡ç†èƒ½é‡æ˜¯å–å¾—èƒœåˆ©çš„å…³é”®ï¼</p>
                
                <h3>ç»“æŸå›åˆ</h3>
                <p>å½“æ‚¨æ— æ³•æˆ–ä¸æƒ³ç»§ç»­ä½¿ç”¨å¡ç‰Œæ—¶ï¼Œå¯ä»¥ç‚¹å‡»"ç»“æŸå›åˆ"æŒ‰é’®è¿›å…¥æ•Œäººå›åˆã€‚</p>
                
                <h3>æ’¤é€€</h3>
                <p>åœ¨æˆ˜æ–—ä¸­ï¼Œæ‚¨å¯ä»¥é€‰æ‹©æ’¤é€€ï¼Œä½†ä¼šæŸå¤±10ç‚¹ç”Ÿå‘½å€¼ã€‚è¿™æ˜¯åœ¨å±é™©æƒ…å†µä¸‹ä¿å­˜æ€§å‘½çš„æ–¹å¼ã€‚</p>
            </div>
            
            <div id="buffEffects" class="tutorial-tab-content">
                <h3>æ­£é¢æ•ˆæœï¼ˆBUFFï¼‰</h3>
                <ul>
                    <li><strong>åŠ›é‡</strong>ï¼šæå‡æ”»å‡»åŠ›</li>
                    <li><strong>æŠ¤ç”²</strong>ï¼šå‡å°‘å—åˆ°çš„ç‰©ç†ä¼¤å®³</li>
                    <li><strong>æŠ¤ç›¾</strong>ï¼šä¸´æ—¶çš„é˜²å¾¡å€¼ï¼Œä¼˜å…ˆæ‰¿å—ä¼¤å®³</li>
                    <li><strong>æ½œè¡Œ</strong>ï¼šé¿å…æ•Œäººçš„æ”»å‡»</li>
                    <li><strong>è†æ£˜</strong>ï¼šå—åˆ°æ”»å‡»æ—¶åå¼¹ä¼¤å®³</li>
                    <li><strong>åå‡»</strong>ï¼šæ•Œäººæ”»å‡»ååå‡»é€ æˆä¼¤å®³</li>
                </ul>
                
                <h3>è´Ÿé¢æ•ˆæœï¼ˆDEBUFFï¼‰</h3>
                <ul>
                    <li><strong>è™šå¼±</strong>ï¼šé™ä½æ”»å‡»åŠ›</li>
                    <li><strong>æ¯’ç´ </strong>ï¼šæ¯å›åˆå—åˆ°ä¼¤å®³</li>
                    <li><strong>ç‡ƒçƒ§</strong>ï¼šæ¯å›åˆå—åˆ°åŒå€ä¼¤å®³</li>
                    <li><strong>ææƒ§</strong>ï¼šæ— æ³•ä½¿ç”¨æ”»å‡»å¡</li>
                    <li><strong>è¯…å’’</strong>ï¼šå¤šç§è´Ÿé¢æ•ˆæœ</li>
                </ul>
                
                <h3>ç‰¹æ®Šæ•ˆæœ</h3>
                <ul>
                    <li><strong>æš´å‡»</strong>ï¼šé€ æˆåŒå€ä¼¤å®³</li>
                    <li><strong>è¿å‡»</strong>ï¼šè¿ç»­ä½¿ç”¨å¡ç‰Œæ—¶å¢å¼ºæ•ˆæœ</li>
                    <li><strong>ç©¿åˆº</strong>ï¼šæ— è§†æ•Œäººçš„æŠ¤ç›¾</li>
                    <li><strong>å¸è¡€</strong>ï¼šå°†ä¼¤å®³è½¬åŒ–ä¸ºç”Ÿå‘½å€¼</li>
                    <li><strong>æ½œè¡Œæ”»å‡»</strong>ï¼šåœ¨æ½œè¡ŒçŠ¶æ€ä¸‹ä¼¤å®³ç¿»å€</li>
                </ul>
            </div>
            
            <div id="enemies" class="tutorial-tab-content">
                <h3>æ™®é€šæ•Œäºº</h3>
                <p>æ¸¸æˆä¸­æœ‰å¤šç§æ™®é€šæ•Œäººï¼Œæ¯ç§éƒ½æœ‰ç‹¬ç‰¹çš„èƒ½åŠ›å’Œç­–ç•¥ï¼š</p>
                <ul>
                    <li><strong>å“¥å¸ƒæ—</strong>ï¼šåŸºç¡€æ•Œäººï¼Œç®€å•ç›´æ¥</li>
                    <li><strong>å“¥å¸ƒæ—å¼“æ‰‹</strong>ï¼šè¿œç¨‹æ”»å‡»ï¼Œæœ‰å‡ ç‡é€ æˆé¢å¤–ä¼¤å®³</li>
                    <li><strong>å…½äººæˆ˜å£«</strong>ï¼šè¡€é‡ä½æ—¶è¿›å…¥ç‹‚æ€’çŠ¶æ€</li>
                    <li><strong>æš—å½±åˆºå®¢</strong>ï¼šæ“…é•¿æ½œè¡Œå’Œæ¯’ç´ æ”»å‡»</li>
                    <li><strong>çŸ³å¤´å·¨äºº</strong>ï¼šé«˜è¡€é‡é«˜é˜²å¾¡ï¼Œæ”»å‡»è€…ä¼šå—åˆ°åä¼¤</li>
                    <li>è¿˜æœ‰æ›´å¤šæ•Œäººç­‰å¾…æ‚¨çš„å‘ç°ï¼</li>
                </ul>
                
                <h3>å®ˆå…³BOSS</h3>
                <p>æ¯5ä¸ªå…³å¡ä¼šå‡ºç°ä¸€ä¸ªå¼ºå¤§çš„BOSSï¼š</p>
                <ul>
                    <li><strong>æš—å½±é¾™ç‹</strong>ï¼ˆç¬¬5å…³ï¼‰ï¼šæ‹¥æœ‰æš—å½±é­”æ³•å’Œå¬å”¤èƒ½åŠ›</li>
                    <li><strong>å…ƒç´ é¢†ä¸»</strong>ï¼ˆç¬¬10å…³ï¼‰ï¼šæŒæ§ç«ç„°ã€å†°éœœå’Œé›·ç”µå…ƒç´ </li>
                    <li><strong>è™šç©ºå›ä¸»</strong>ï¼ˆç¬¬15å…³ï¼‰ï¼šæ“æ§è™šç©ºèƒ½é‡ï¼Œæ‰­æ›²ç°å®</li>
                    <li><strong>åˆ›ä¸–ç¥</strong>ï¼ˆç¬¬20å…³ï¼‰ï¼šåˆ›é€ ä¸æ¯ç­çš„åŒ–èº«</li>
                    <li><strong>æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹</strong>ï¼ˆç¬¬25å…³ï¼‰ï¼šæ¸¸æˆçš„æœ€ç»ˆæŒ‘æˆ˜ï¼Œè¿œå¤æ—¶ä»£çš„æºåˆé­”é¾™ï¼Œæ‹¥æœ‰æ— ä¸ä¼¦æ¯”çš„åŠ›é‡å’Œå¤šé˜¶æ®µæˆ˜æ–—å½¢æ€</li>
                </ul>
                
                <h3>BOSSé˜¶æ®µ</h3>
                <p>BOSSä¼šéšç€è¡€é‡é™ä½è¿›å…¥ä¸åŒé˜¶æ®µï¼Œè·å¾—æ–°çš„èƒ½åŠ›å’Œæ›´å¼ºå¤§çš„æ”»å‡»ã€‚</p>
                
                <h4>æºåˆé­”é¾™ç‰¹æ®Šé˜¶æ®µ</h4>
                <p>ä½œä¸ºæœ€ç»ˆBOSSï¼Œæºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹æ‹¥æœ‰ç‹¬ç‰¹çš„5é˜¶æ®µæˆ˜æ–—æ¨¡å¼ï¼š</p>
                <ul>
                    <li><strong>è¿œå¤è‹é†’</strong>ï¼šåˆå§‹é˜¶æ®µï¼Œä½¿ç”¨åŸºç¡€çš„é¾™æ¯å’Œé˜²å¾¡æŠ€èƒ½</li>
                    <li><strong>å…ƒç´ èåˆ</strong>ï¼šç”Ÿå‘½å€¼é™è‡³70%ä»¥ä¸‹æ—¶ï¼Œèåˆå››å¤§å…ƒç´ ä¹‹åŠ›ï¼Œæ”»å‡»å˜å¾—æ›´åŠ å¤šæ ·åŒ–</li>
                    <li><strong>ä¸–ç•Œæœ«æ—¥</strong>ï¼šç”Ÿå‘½å€¼é™è‡³40%ä»¥ä¸‹æ—¶ï¼Œé™·å…¥ç–¯ç‹‚ï¼Œé‡Šæ”¾è¶³ä»¥æ¯ç­ä¸–ç•Œçš„åŠ›é‡</li>
                    <li><strong>æ­»äº¡è½®å›</strong>ï¼šç”Ÿå‘½å€¼é™è‡³0æ—¶ï¼Œè¿›å…¥æ­»äº¡è½®å›çŠ¶æ€ï¼Œå¤æ´»å¹¶è·å¾—ä¸æ­»ç‰¹æ€§</li>
                    <li><strong>ç»ˆç„‰æ—¶åˆ»</strong>ï¼šæ­»äº¡è½®å›æŒç»­5å›åˆåï¼Œå®Œå…¨è§‰é†’ä¸ºé¾™ç¥å½¢æ€ï¼Œå¸¦æ¥ç»ˆç„‰å®¡åˆ¤</li>
                </ul>
                <p>å‡»è´¥æºåˆé­”é¾™éœ€è¦å……åˆ†åˆ©ç”¨ä¹‹å‰å…³å¡ä¸­æ”¶é›†çš„å¡ç‰Œå’Œèƒ½åŠ›ï¼Œåˆ¶å®šåˆç†çš„æˆ˜æ–—ç­–ç•¥ï¼</p>
            </div>
            
            <div class="tutorial-footer">
                <button class="btn" id="closeTutorial">å…³é—­</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="game-header">
            <h1 class="game-title">ğŸƒ å¡ç‰Œè‚‰é¸½å†’é™©</h1>
            <div class="game-stats">
                <div class="stat">
                    <div>å…³å¡: <span id="level">1</span></div>
                </div>
                <div class="stat">
                    <div>é‡‘å¸: <span id="gold">50</span></div>
                </div>
                <div class="stat">
                    <div>ç‰Œç»„: <span id="deckCount">0</span>å¼ </div>
                </div>
            </div>
            <div id="buffs"></div>
        </div>

        <!-- é¦–é¡µèœå•ç•Œé¢ -->
        <div id="homeScreen" class="screen active">
            <div class="home-menu">
                <h1>å¡ç‰Œè‚‰é¸½å†’é™©</h1>
                <div class="home-buttons">
                    <button id="startButton" class="home-btn">å¼€å§‹æ¸¸æˆ</button>
                    <button id="exitButton" class="home-btn">é€€å‡ºæ¸¸æˆ</button>
                </div>
                
                <div class="game-intro">
                    <h3>ğŸ® æ¸¸æˆç®€ä»‹</h3>
                    <p>ã€Šå¡ç‰Œè‚‰é¸½å†’é™©ã€‹æ˜¯ä¸€æ¬¾ç»“åˆå¡ç‰Œæˆ˜æ–—ä¸è‚‰é¸½å…ƒç´ çš„å†’é™©æ¸¸æˆã€‚ç©å®¶éœ€é€‰æ‹©æˆ˜å£«ã€æ³•å¸ˆã€ç›—è´¼ç­‰7ç§è§’è‰²ä¹‹ä¸€ï¼Œé€šè¿‡æ”¶é›†å¡ç‰Œã€å‡çº§èƒ½åŠ›æŒ‘æˆ˜25ä¸ªå…³å¡ï¼Œæ¯5å…³å°†é­é‡å¼ºåŠ›BOSSï¼Œæœ€ç»ˆå‡»è´¥ç¬¬25å…³çš„æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹ã€‚</p>
                    <p>æ¸¸æˆæ ¸å¿ƒç©æ³•ä¸ºå›åˆåˆ¶å¡ç‰Œæˆ˜æ–—ï¼šç©å®¶å›åˆæ¶ˆè€—èƒ½é‡ä½¿ç”¨æ”»å‡»ã€é˜²å¾¡ã€é­”æ³•ç­‰ä¸åŒç±»å‹å¡ç‰Œï¼›æ•Œäººå›åˆç”±æ•Œæ–¹è¡ŒåŠ¨ï¼›å›åˆç»“æŸåå¼ƒç‰Œå †æ´—ç‰Œæˆä¸ºæ–°ç‰Œåº“ã€‚å¡ç‰Œåˆ†ä¸ºæ™®é€šã€ç¨€æœ‰ã€ä¼ å¥‡ä¸‰ä¸ªç¨€æœ‰åº¦ï¼Œå¯é€šè¿‡é‡‘å¸å¼ºåŒ–æå‡æ•ˆæœã€‚æ¯åœºæˆ˜æ–—éƒ½æ˜¯ç‹¬ç‰¹ä½“éªŒï¼Œåˆç†æ­é…å¡ç‰Œä¸ç­–ç•¥æ˜¯å–èƒœå…³é”®ã€‚</p>
                </div>
            </div>
        </div>
        
        <!-- è§’è‰²é€‰æ‹©ç•Œé¢ -->
        <div id="characterScreen" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">é€‰æ‹©ä½ çš„è§’è‰²</h2>
            <div class="character-select">
                <div class="character-card" data-character="warrior">
                    <div class="character-icon">âš”ï¸</div>
                    <h3>æˆ˜å£«</h3>
                    <p>ç”Ÿå‘½å€¼: 100 | èƒ½é‡: 3</p>
                    <p>æŠ¤ç”²ç²¾é€š: æ¯å›åˆå¼€å§‹è·å¾—2ç‚¹æŠ¤ç›¾</p>
                    <p>é˜²å¾¡åŠ æˆ: +2æŠ¤ç›¾æ•ˆæœ</p>
                </div>
                <div class="character-card" data-character="mage">
                    <div class="character-icon">ğŸ”®</div>
                    <h3>æ³•å¸ˆ</h3>
                    <p>ç”Ÿå‘½å€¼: 70 | èƒ½é‡: 4</p>
                    <p>å¥¥æœ¯æ™ºæ…§: æ¯æ‰“å‡º2å¼ æ³•æœ¯ç‰ŒæŠ½1å¼ ç‰Œ</p>
                    <p>æ³•æœ¯å¼ºåº¦: +2æ³•æœ¯ä¼¤å®³</p>
                </div>
                <div class="character-card" data-character="rogue">
                    <div class="character-icon">ğŸ—¡ï¸</div>
                    <h3>ç›—è´¼</h3>
                    <p>ç”Ÿå‘½å€¼: 85 | èƒ½é‡: 3</p>
                    <p>è¿å‡»ç²¾é€š: æ¯å›åˆç¬¬ä¸€å¼ ç‰Œæ¶ˆè€—-1</p>
                    <p>æš´å‡»å‡ ç‡: 15%é€ æˆ1.5å€ä¼¤å®³</p>
                </div>
                <div class="character-card" data-character="hunter">
                    <div class="character-icon">ğŸ¹</div>
                    <h3>çŒäºº</h3>
                    <p>ç”Ÿå‘½å€¼: 90 | èƒ½é‡: 3</p>
                    <p>ç²¾å‡†å°„å‡»: æ¯å›åˆç¬¬ä¸€å‘è¿œç¨‹æ”»å‡»ä¼¤å®³+50%</p>
                    <p>å°„ç¨‹ä¼˜åŠ¿: è¿œç¨‹æ”»å‡»+2ä¼¤å®³</p>
                </div>
                <div class="character-card" data-character="knight">
                    <div class="character-icon">ğŸ›¡ï¸</div>
                    <h3>éª‘å£«</h3>
                    <p>ç”Ÿå‘½å€¼: 105 | èƒ½é‡: 3</p>
                    <p>ç¥åœ£å®ˆæŠ¤: æ¯å›åˆå¼€å§‹æœ‰50%å‡ ç‡è·å¾—1ç‚¹èƒ½é‡å’Œ2ç‚¹æŠ¤ç›¾</p>
                    <p>åœ£èƒ½äº²å’Œ: ç¥åœ£æŠ€èƒ½æ•ˆæœå¢å¼º</p>
                </div>
                <div class="character-card" data-character="priest">
                    <div class="character-icon">ğŸ™</div>
                    <h3>ç‰§å¸ˆ</h3>
                    <p>ç”Ÿå‘½å€¼: 80 | èƒ½é‡: 3</p>
                    <p>ç¥åœ£æ²»ç–—: æ¯å›åˆç»“æŸæ—¶ï¼Œè‹¥ç”Ÿå‘½å€¼ä½äº50%ï¼Œæ¢å¤6ç‚¹ç”Ÿå‘½å€¼</p>
                    <p>æ²»ç–—å¢æ•ˆ: æ²»ç–—æ•ˆæœ+2</p>
                </div>
                <div class="character-card" data-character="warlock">
                    <div class="character-icon">ğŸ‘¹</div>
                    <h3>æœ¯å£«</h3>
                    <p>ç”Ÿå‘½å€¼: 65 | èƒ½é‡: 4</p>
                    <p>é‚ªèƒ½å¢å¹…: æ¯ä½¿ç”¨ä¸€å¼ æ¶ˆè€—ç”Ÿå‘½çš„å¡ç‰Œï¼Œè·å¾—1å±‚é‚ªèƒ½ï¼ˆæ¯å±‚+1é­”æ³•ä¼¤å®³ï¼‰</p>
                    <p>æ¶é­”ä¹‹åŠ›: åˆå§‹é­”æ³•ä¼¤å®³+2</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" id="startGame" disabled>å¼€å§‹å†’é™©</button>
            </div>
        </div>

        <!-- ç‰Œç»„ç®¡ç†ç•Œé¢ -->
        <div id="deckScreen" class="screen">
            <div class="deck-area">
                <div class="deck-section">
                    <h3>å¯é€‰å¡ç‰Œ</h3>
                    <div class="cards-scroll-area">
                        <div class="cards-grid" id="availableCards"></div>
                    </div>
                </div>
                <div class="deck-section">
                    <h3>æˆ‘çš„ç‰Œç»„</h3>
                    <div class="cards-scroll-area">
                        <div class="cards-grid" id="playerDeck"></div>
                    </div>
                </div>
            </div>
            <div style="text-align: center;">
                <button class="btn btn-primary" id="enterBattle">è¿›å…¥æˆ˜æ–—</button>
                <button class="btn" id="shopBtn">å•†åº— (10é‡‘å¸æŠ½å¡)</button>
                <button class="btn" id="randomEventBtn">æ¢ç´¢äº‹ä»¶</button>
                <button class="btn" id="upgradeBtn">å¼ºåŒ–å¡ç‰Œ (25é‡‘å¸)</button>
            </div>
        </div>

        <!-- æˆ˜æ–—ç•Œé¢ -->
        <div id="battleScreen" class="screen">
            <div class="battle-area">
                <div class="enemy">
                    <div class="enemy-display">
                        <div class="enemy-art" id="enemyArt"></div>
                        <h4 id="enemyName" style="margin: 2px 0; font-size: 0.9rem; line-height: 1.1;">å“¥å¸ƒæ—</h4>
                        <div class="health-bar">
                            <div class="health-fill" id="enemyHealth" style="width: 100%"></div>
                        </div>
                        <div id="enemyStats" style="font-size: 0.75rem; margin: 2px 0; line-height: 1;">ç”Ÿå‘½å€¼: <span id="enemyHp">30</span> / <span id="enemyMaxHp">30</span></div>
                        <div id="enemyIntent" style="margin-top: 4px; padding: 3px 6px; background: rgba(255,255,255,0.2); border-radius: 6px; font-size: 0.7rem; line-height: 1.1; flex-shrink: 0;">
                            <span id="intentIcon">âš”ï¸</span> <span id="intentText">å‡†å¤‡æ”»å‡» (6ä¼¤å®³)</span>
                        </div>
                    </div>
                </div>

                <div class="player-status">
                    <div class="energy-display">âš¡ èƒ½é‡: <span id="energy">3</span> / 3</div>
                    <div class="health-bar player-health">
                        <div class="health-fill" id="playerHealth" style="width: 100%"></div>
                    </div>
                    <div>â¤ï¸ ç”Ÿå‘½å€¼: <span id="playerHp">100</span> / <span id="playerMaxHp">100</span></div>
                    <div id="playerStatusEffects" style="margin-top: 8px; display: flex; flex-wrap: wrap; gap: 4px; font-size: 0.8rem;"></div>
                    <div id="enemyStatusEffects" style="margin-top: 8px; display: flex; flex-wrap: wrap; gap: 4px; font-size: 0.8rem;"></div>
                </div>

                <div class="hand" id="hand"></div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" id="endTurn">ğŸ”„ ç»“æŸå›åˆ</button>
                    <button class="btn btn-danger" id="retreatBtn">ğŸƒ æ’¤é€€</button>
                </div>

                <h3 style="text-align: center; margin-bottom: 10px; color: #ffd700;">ğŸ“ æˆ˜æ–—æ—¥å¿—</h3>
                <div class="log" id="battleLog"></div>
            </div>
        </div>

        <!-- å¥–åŠ±ç•Œé¢ -->
        <div id="rewardScreen" class="screen">
            <h2 style="text-align: center;">èƒœåˆ©ï¼é€‰æ‹©ä½ çš„å¥–åŠ±</h2>
            <div class="rewards" id="rewards"></div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" id="nextLevel">ä¸‹ä¸€å…³</button>
            </div>
        </div>

        <!-- é€šå…³ç•Œé¢ -->
        <div id="victoryScreen" class="screen">
            <div style="text-align: center;">
                <h2 style="color: #ffd700; font-size: 3rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">ğŸ† æ­å–œé€šå…³ï¼</h2>
                <p style="font-size: 1.5rem; margin: 20px 0;">ä½ å‡»è´¥äº†ç¬¬ <span id="victoryLevel">5</span> å…³çš„å®ˆå…³BOSSï¼</p>
                <p style="font-size: 1.2rem; color: #ffd700;">è·å¾—äº†ä¼ å¥‡å¡ç‰Œå¥–åŠ±ï¼</p>
                <div id="victoryRewards" style="margin: 30px 0;"></div>
                <div style="margin-top: 30px;">
                    <button class="btn btn-primary" id="continueAdventure">ç»§ç»­å†’é™© (éš¾åº¦æå‡)</button>
                    <button class="btn" id="backToMenu">è¿”å›ä¸»é¡µ</button>
                </div>
            </div>
        </div>

        <!-- éšæœºäº‹ä»¶ç•Œé¢ -->
        <div id="eventScreen" class="screen">
            <div style="text-align: center;">
                <h2 id="eventTitle">éšæœºäº‹ä»¶</h2>
                <p id="eventDescription" style="font-size: 1.2rem; margin: 20px 0; line-height: 1.5;"></p>
                <div id="eventChoices" style="margin: 30px 0;"></div>
            </div>
        </div>

        <!-- æˆå°±ç•Œé¢ -->
        <div id="achievementScreen" class="screen">
            <div style="text-align: center;">
                <h2>ğŸ† æˆå°±ç³»ç»Ÿ</h2>
                <div id="achievementsList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 30px 0;"></div>
                <button class="btn" id="closeAchievements">è¿”å›</button>
            </div>
        </div>

        <!-- å¡ç‰Œå¼ºåŒ–ç•Œé¢ -->
        <div id="upgradeScreen" class="screen">
            <div style="text-align: center;">
                <h2>âš¡ å¡ç‰Œå¼ºåŒ–</h2>
                <p>é€‰æ‹©ä¸€å¼ å¡ç‰Œè¿›è¡Œå¼ºåŒ–</p>
                <div id="upgradeCards" class="cards-grid" style="margin: 30px 0;"></div>
                <button class="btn" id="skipUpgrade">è·³è¿‡å¼ºåŒ–</button>
            </div>
        </div>

        <!-- æ¸¸æˆç»“æŸç•Œé¢ -->
        <div id="gameOverScreen" class="screen">
            <div style="text-align: center;">
                <h2>æ¸¸æˆç»“æŸ</h2>
                <p>ä½ åˆ°è¾¾äº†ç¬¬ <span id="finalLevel">1</span> å…³</p>
                <div id="gameOverAchievements" style="margin: 20px 0;"></div>
                <button class="btn btn-primary" id="restartGame">é‡æ–°å¼€å§‹</button>
                <button class="btn" id="viewAchievements">æŸ¥çœ‹æˆå°±</button>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            level: 1,
            gold: 50,
            selectedCharacter: null,
            playerDeck: [],
            playerHp: 100,
            playerMaxHp: 100,
            energy: 3,
            maxEnergy: 3,
            hand: [],
            buffs: [],
            currentEnemy: null,
            battleLog: [],
            // æ–°å¡ç‰Œæ•ˆæœç›¸å…³çŠ¶æ€
            enemyBleed: 0,
            enemyStunned: 0,
            enemyFear: 0,
            tauntActive: false,
            soulLinkActive: false,
            soulLinkTurns: 0,
            firstRangedAttackThisTurn: true,
            badLuckThisTurn: false,
            badLuckActive: 0,
            // æ§åˆ¶æ•ˆæœç–²åŠ³è®¡æ•°å™¨
            stunCount: 0,
            freezeCount: 0,
            fearCount: 0,
            // æ½œè¡Œæ•ˆæœç–²åŠ³è®¡æ•°å™¨
            stealthCount: 0,
            // æºåˆé­”é¾™ç‰¹æ®ŠçŠ¶æ€
            scaleArmor: 0,
            eternalPain: 0,
            deathReincarnationCount: 0,
            // æ–°è§’è‰²ç›¸å…³å±æ€§
            passiveAbility: '',
            spellsPlayedThisTurn: 0,
            firstCardThisTurn: true,
            demonicEnergy: 0,
            // é™·é˜±ç›¸å…³çŠ¶æ€
            trapActive: false,
            trapType: null
        };

        // è§’è‰²æ•°æ®
        const characters = {
            warrior: {
                name: 'æˆ˜å£«',
                icon: 'âš”ï¸',
                maxHp: 100,
                maxEnergy: 3,
                attackBonus: 0,
                defenseBonus: 2,
                passive: 'armor_mastery', // æŠ¤ç”²ç²¾é€šï¼šæ¯å›åˆå¼€å§‹è·å¾—2ç‚¹æŠ¤ç›¾
                startingCards: ['é‡å‡»', 'é“å£é˜²å¾¡', 'æˆ˜å¼', 'é‡å‡»', 'é“å£é˜²å¾¡', 'æ„¤æ€’', 'åšéŸ§', 'æˆ˜æœ¯æ’¤é€€']
            },
            mage: {
                name: 'æ³•å¸ˆ',
                icon: 'ğŸ”®',
                maxHp: 70,
                maxEnergy: 4,
                magicBonus: 1,
                spellPower: 2,
                passive: 'arcane_intellect', // å¥¥æœ¯æ™ºæ…§ï¼šæ¯æ‰“å‡º2å¼ æ³•æœ¯ç‰ŒæŠ½1å¼ ç‰Œ
                startingCards: ['é­”æ³•é£å¼¹', 'æ³•å¸ˆæŠ¤ç”²', 'å¥¥æœ¯æ´å¯Ÿ', 'é­”æ³•é£å¼¹', 'æ³•å¸ˆæŠ¤ç”²', 'å†°éœœæ–°æ˜Ÿ', 'é­”åŠ›æ¶Œæµ', 'ä¼ é€']
            },
            rogue: {
                name: 'ç›—è´¼',
                icon: 'ğŸ—¡ï¸',
                maxHp: 85,
                maxEnergy: 3,
                comboBonus: 1,
                critChance: 0.15,
                passive: 'combo_mastery', // è¿å‡»ç²¾é€šï¼šæ¯å›åˆç¬¬ä¸€å¼ ç‰Œæ¶ˆè€—-1
                startingCards: ['å¿«åˆ€', 'é—ªé¿', 'æ¯’åˆƒ', 'å¿«åˆ€', 'é—ªé¿', 'å½±è¢­', 'æ½œè¡Œ', 'è‡´å‘½æ¯’è¯']
            },
            hunter: {
                name: 'çŒäºº',
                icon: 'ğŸ¹',
                maxHp: 90,
                maxEnergy: 3,
                markBonus: 1,
                rangeBonus: 2,
                passive: 'precision_shot', // ç²¾å‡†å°„å‡»ï¼šæ¯å›åˆç¬¬ä¸€å‘è¿œç¨‹æ”»å‡»é€ æˆ1.5å€ä¼¤å®³
                startingCards: ['ç²¾å‡†å°„å‡»', 'é¹°çœ¼', 'é™·é˜±', 'ç²¾å‡†å°„å‡»', 'é¹°çœ¼', 'çŒäººæ ‡è®°', 'è¿½è¸ª', 'ç®­é›¨']
            },
            knight: {
                name: 'éª‘å£«',
                icon: 'ğŸ›¡ï¸',
                maxHp: 105,
                maxEnergy: 3,
                holyBonus: 1,
                energyEfficiency: 1,
                passive: 'holy_guardian', // ç¥åœ£å®ˆæŠ¤ï¼šæ¯å›åˆå¼€å§‹æœ‰50%å‡ ç‡è·å¾—1ç‚¹èƒ½é‡å’Œ2ç‚¹æŠ¤ç›¾
                startingCards: ['åœ£ç›¾æœ¯', 'æ­£ä¹‰æ‰“å‡»', 'è™”è¯š', 'åå­—å†›æ‰“å‡»', 'åœ£ç›¾æœ¯', 'ç¥åœ£æ„¤æ€’', 'å…‰æ˜ç¥ç¦', 'ä¿æŠ¤ç¥ç¦']
            },
            priest: {
                name: 'ç‰§å¸ˆ',
                icon: 'ğŸ™',
                maxHp: 80,
                maxEnergy: 3,
                healingPower: 2,
                holyBonus: 2,
                passive: 'holy_healing', // ç¥åœ£æ²»ç–—ï¼šæ¯å›åˆç»“æŸæ—¶ï¼Œè‹¥ç”Ÿå‘½å€¼ä½äº50%ï¼Œæ¢å¤6ç‚¹ç”Ÿå‘½å€¼
                startingCards: ['æ²»ç–—æœ¯', 'å¿ƒçµä¹‹ç«', 'ç¥åœ£ä¹‹å…‰', 'æ²»ç–—æœ¯', 'å¿ƒçµä¹‹ç«', 'å‡€åŒ–', 'ç²¾ç¥ä¸“æ³¨', 'ç¥åœ£å¹²æ¶‰']
            },
            warlock: {
                name: 'æœ¯å£«',
                icon: 'ğŸ‘¹',
                maxHp: 65,
                maxEnergy: 4,
                magicBonus: 2,
                demonicPower: 1,
                passive: 'demonic_amplification', // é‚ªèƒ½å¢å¹…ï¼šæ¯ä½¿ç”¨ä¸€å¼ æ¶ˆè€—ç”Ÿå‘½çš„å¡ç‰Œï¼Œè·å¾—1å±‚é‚ªèƒ½ï¼ˆæ¯å±‚é‚ªèƒ½æä¾›+1é­”æ³•ä¼¤å®³ï¼‰
                startingCards: ['è…èš€æœ¯', 'ç”Ÿå‘½åˆ†æµ', 'æš—å½±ç®­', 'è…èš€æœ¯', 'ç”Ÿå‘½åˆ†æµ', 'å¸å–çµé­‚', 'çŒ®ç¥­', 'æå“']
            }
        };

        // å¡ç‰Œæ•°æ®
        const cardDatabase = {
            // éª‘å£«ç¥åœ£å¡ç‰Œ
            'æ­£ä¹‰æ‰“å‡»': { type: 'attack', cost: 1, damage: 7, holy: true, description: 'é€ æˆ7ç‚¹ç¥åœ£ä¼¤å®³', art: 'holy-strike', rarity: 'common', character: 'knight' },
            'åå­—å†›æ‰“å‡»': { type: 'attack', cost: 2, damage: 9, holy: true, description: 'é€ æˆ9ç‚¹ç¥åœ£ä¼¤å®³', art: 'crusader-strike', rarity: 'common', character: 'knight' },
            'ç¥åœ£æ„¤æ€’': { type: 'attack', cost: 2, damage: 8, holy: true, splash: 4, description: 'é€ æˆ8ç‚¹ç¥åœ£ä¼¤å®³ï¼Œå¯¹å…¶ä»–æ•Œäººé€ æˆ4ç‚¹æº…å°„ä¼¤å®³', art: 'holy-wrath', rarity: 'uncommon', character: 'knight' },
            'å…‰æ˜å®¡åˆ¤': { type: 'attack', cost: 2, damage: 10, holy: true, heal: 3, description: 'é€ æˆ10ç‚¹ç¥åœ£ä¼¤å®³å¹¶æ¢å¤3ç‚¹ç”Ÿå‘½å€¼', art: 'holy-judgment', rarity: 'uncommon', character: 'knight' },
            'å¤ä»‡æ‰“å‡»': { type: 'attack', cost: 3, damage: 12, holy: true, maxHealthBonus: 0.05, description: 'é€ æˆ12ç‚¹ç¥åœ£ä¼¤å®³ï¼Œå¹¶é™„åŠ ç›®æ ‡æœ€å¤§ç”Ÿå‘½å€¼5%çš„é¢å¤–ä¼¤å®³', art: 'vengeance', rarity: 'rare', character: 'knight' },
            'åœ£ç›¾æœ¯': { type: 'defense', cost: 1, block: 8, holy: true, description: 'è·å¾—8ç‚¹æŠ¤ç›¾', art: 'holy-shield', rarity: 'common', character: 'knight' },
            'è™”è¯š': { type: 'ability', cost: 0, buff: 'holy_strength', stacks: 1, description: 'è·å¾—1å±‚ç¥åœ£ä¹‹åŠ›ï¼ˆä¸‹æ¬¡ç¥åœ£æ”»å‡»+4ä¼¤å®³ï¼‰', art: 'devotion', rarity: 'common', character: 'knight' },
            'å…‰æ˜ç¥ç¦': { type: 'ability', cost: 2, buff: 'holy_armor', stacks: 2, description: 'è·å¾—2å±‚ç¥åœ£æŠ¤ç”²ï¼ˆæ¯å±‚+2æŠ¤ç›¾æ•ˆæœï¼‰', art: 'holy-blessing', rarity: 'uncommon', character: 'knight' },
            'ä¿æŠ¤ç¥ç¦': { type: 'ability', cost: 2, invulnerable: 1, exhaust: true, description: 'è·å¾—1å›åˆæ— æ•Œæ•ˆæœï¼Œä½¿ç”¨åæ¶ˆè€—', art: 'protection', rarity: 'rare', character: 'knight' },
            'ç¥åœ£å¥‰çŒ®': { type: 'ability', cost: 3, aoe: true, damage: 6, holy: true, description: 'å¯¹æ‰€æœ‰æ•Œäººé€ æˆ6ç‚¹ç¥åœ£ä¼¤å®³', art: 'consecration', rarity: 'rare', character: 'knight' },
            
            // ç‰§å¸ˆç¥åœ£å¡ç‰Œ
            'å¿ƒçµä¹‹ç«': { type: 'attack', cost: 1, damage: 6, holy: true, description: 'é€ æˆ6ç‚¹ç¥åœ£ä¼¤å®³ï¼Œæ ¹æ®å·²æ¢å¤çš„ç”Ÿå‘½å€¼é¢å¤–+1ä¼¤å®³/æ¯8ç‚¹ç”Ÿå‘½æ¢å¤', art: 'holy-fire', rarity: 'common', character: 'priest' },
            'ç¥åœ£ä¹‹å…‰': { type: 'ability', cost: 1, heal: 5, damage: 2, holy: true, description: 'æ¢å¤5ç‚¹ç”Ÿå‘½å€¼å¹¶é€ æˆ2ç‚¹ç¥åœ£ä¼¤å®³', art: 'holy-light', rarity: 'common', character: 'priest' },
            'æ²»ç–—æœ¯': { type: 'ability', cost: 2, heal: 8, damage: 3, holy: true, description: 'æ¢å¤8ç‚¹ç”Ÿå‘½å€¼å¹¶é€ æˆ3ç‚¹ç¥åœ£ä¼¤å®³', art: 'heal', rarity: 'common', character: 'priest' },
            'å‡€åŒ–': { type: 'ability', cost: 1, cleanse: true, damage: 2, holy: true, description: 'ç§»é™¤è‡ªèº«æ‰€æœ‰è´Ÿé¢æ•ˆæœå¹¶é€ æˆ2ç‚¹ç¥åœ£ä¼¤å®³', art: 'cleanse', rarity: 'common', character: 'priest' },
            'ç²¾ç¥ä¸“æ³¨': { type: 'ability', cost: 1, draw: 1, damage: 1, holy: true, description: 'æŠ½1å¼ ç‰Œå¹¶é€ æˆ1ç‚¹ç¥åœ£ä¼¤å®³', art: 'focus', rarity: 'common', character: 'priest' },
            'ç¥åœ£å¹²æ¶‰': { type: 'ability', cost: 3, heal: 12, draw: 1, damage: 5, holy: true, description: 'æ¢å¤12ç‚¹ç”Ÿå‘½å€¼ï¼ŒæŠ½1å¼ ç‰Œå¹¶é€ æˆ5ç‚¹ç¥åœ£ä¼¤å®³', art: 'divine-intervention', rarity: 'rare', character: 'priest' },
            'ä¿¡ä»°ä¹‹åŠ›': { type: 'ability', cost: 2, buff: 'faith', stacks: 2, damage: 3, holy: true, description: 'è·å¾—2å±‚ä¿¡ä»°ï¼ˆæ¯å±‚+1æ²»ç–—æ•ˆæœï¼‰å¹¶é€ æˆ3ç‚¹ç¥åœ£ä¼¤å®³', art: 'faith', rarity: 'uncommon', character: 'priest' },
            'ç¥åœ£æ–°æ˜Ÿ': { type: 'ability', cost: 3, aoe: true, damage: 7, holy: true, heal: 5, description: 'å¯¹æ‰€æœ‰æ•Œäººé€ æˆ7ç‚¹ç¥åœ£ä¼¤å®³å¹¶æ¢å¤5ç‚¹ç”Ÿå‘½å€¼', art: 'holy-nova', rarity: 'rare', character: 'priest' },
            'è™”è¯šç¥ˆç¥·': { type: 'ability', cost: 3, heal: 15, exhaust: true, damage: 6, holy: true, description: 'æ¢å¤15ç‚¹ç”Ÿå‘½å€¼ï¼Œä½¿ç”¨åç§»é™¤ï¼Œå¹¶é€ æˆ6ç‚¹ç¥åœ£ä¼¤å®³', art: 'prayer', rarity: 'rare', character: 'priest' },
            'å¿ƒçµæ§åˆ¶': { type: 'ability', cost: 4, control: true, damage: 4, holy: true, description: 'æ§åˆ¶ä¸€ä¸ªæ•Œäºº1å›åˆï¼Œä½¿å…¶æ”»å‡»è‡ªèº«ï¼Œå¹¶é€ æˆ4ç‚¹ç¥åœ£ä¼¤å®³', art: 'mind-control', rarity: 'rare', character: 'priest' },
            
            // æœ¯å£«æš—å½±å¡ç‰Œ
            'æš—å½±ç®­': { type: 'magic', cost: 1, damage: 7, shadow: true, description: 'é€ æˆ7ç‚¹æš—å½±ä¼¤å®³', art: 'shadow-bolt', rarity: 'common', character: 'warlock' },
            'è…èš€æœ¯': { type: 'magic', cost: 1, damage: 4, dot: 3, shadow: true, description: 'é€ æˆ4ç‚¹æš—å½±ä¼¤å®³å¹¶æ¯å›åˆé€ æˆ3ç‚¹ä¼¤å®³ï¼ŒæŒç»­3å›åˆ', art: 'corruption', rarity: 'common', character: 'warlock' },
            'ç”Ÿå‘½åˆ†æµ': { type: 'ability', cost: 1, energy_gain: 2, self_damage: 5, description: 'è·å¾—2ç‚¹èƒ½é‡ï¼Œå¯¹è‡ªå·±é€ æˆ5ç‚¹ä¼¤å®³', art: 'life-tap', rarity: 'common', character: 'warlock' },
            'å¸å–çµé­‚': { type: 'magic', cost: 2, damage: 8, lifesteal: true, shadow: true, description: 'é€ æˆ8ç‚¹æš—å½±ä¼¤å®³å¹¶æ¢å¤6ç‚¹ç”Ÿå‘½å€¼', art: 'siphon-soul', rarity: 'uncommon', character: 'warlock' },
            'çŒ®ç¥­': { type: 'magic', cost: 2, damage: 10, fire: true, description: 'é€ æˆ10ç‚¹ç«ç„°ä¼¤å®³', art: 'immolate', rarity: 'uncommon', character: 'warlock' },
            'æå“': { type: 'ability', cost: 2, fear: true, description: 'ä½¿æ•Œäººææƒ§1å›åˆï¼Œæ— æ³•è¡ŒåŠ¨', art: 'fear', rarity: 'uncommon', character: 'warlock' },
            'æ¶é­”å°è®°': { type: 'ability', cost: 1, buff: 'demonic_power', stacks: 1, description: 'è·å¾—1å±‚æ¶é­”ä¹‹åŠ›ï¼ˆæ¯å±‚+1é­”æ³•ä¼¤å®³ï¼‰', art: 'demon-mark', rarity: 'common', character: 'warlock' },
            'æš—å½±å½¢æ€': { type: 'ability', cost: 3, buff: 'shadow_form', stacks: 1, description: 'è¿›å…¥æš—å½±å½¢æ€ï¼Œæ‰€æœ‰æš—å½±ä¼¤å®³+5ï¼ŒæŒç»­2å›åˆ', art: 'shadow-form', rarity: 'rare', character: 'warlock' },
            'åœ°ç‹±ç«': { type: 'magic', cost: 4, damage: 15, fire: true, aoe: true, self_damage: 8, description: 'å¯¹æ‰€æœ‰æ•Œäººé€ æˆ15ç‚¹ç«ç„°ä¼¤å®³ï¼Œå¯¹è‡ªå·±é€ æˆ8ç‚¹ä¼¤å®³', art: 'hellfire', rarity: 'rare', character: 'warlock' },
            'çµé­‚æ”¶å‰²': { type: 'magic', cost: 3, damage: 12, execute: 0.25, shadow: true, description: 'é€ æˆ12ç‚¹æš—å½±ä¼¤å®³ï¼Œæ•Œäººè¡€é‡ä½äº25%æ—¶ä¼¤å®³ç¿»å€', art: 'soul-reaper', rarity: 'rare', character: 'warlock' },
            
            // çŒäººå°„å‡»å¡ç‰Œ
            'ç²¾å‡†å°„å‡»': { type: 'attack', cost: 1, damage: 6, range: true, description: 'é€ æˆ6ç‚¹è¿œç¨‹ä¼¤å®³', art: 'bow-shot', rarity: 'common', character: 'hunter' },
            'ç®­é›¨': { type: 'attack', cost: 2, damage: 5, hits: 2, range: true, description: 'å‘å°„2æ”¯ç®­ï¼Œæ¯æ”¯é€ æˆ5ç‚¹è¿œç¨‹ä¼¤å®³', art: 'arrow-rain', rarity: 'common', character: 'hunter' },
            'çŒäººæ ‡è®°': { type: 'ability', cost: 1, mark: true, description: 'æ ‡è®°æ•Œäººï¼Œæ‰€æœ‰å¯¹å…¶çš„æ”»å‡»+3ä¼¤å®³', art: 'target', rarity: 'common', character: 'hunter' },
            'ç©¿é€å°„å‡»': { type: 'attack', cost: 2, damage: 10, pierce: true, range: true, description: 'é€ æˆ10ç‚¹è¿œç¨‹ä¼¤å®³ï¼Œæ— è§†æŠ¤ç›¾', art: 'pierce', rarity: 'uncommon', character: 'hunter' },
            'å¤šé‡å°„å‡»': { type: 'attack', cost: 3, damage: 4, hits: 3, range: true, description: 'å‘å°„3æ”¯ç®­ï¼Œæ¯æ”¯é€ æˆ4ç‚¹è¿œç¨‹ä¼¤å®³', art: 'multishot', rarity: 'uncommon', character: 'hunter' },
            'ç„å‡†å°„å‡»': { type: 'attack', cost: 2, damage: 12, precision: true, range: true, description: 'é€ æˆ12ç‚¹è¿œç¨‹ä¼¤å®³ï¼Œå¯¹æ ‡è®°çš„æ•Œäººä¼¤å®³ç¿»å€', art: 'snipe', rarity: 'rare', character: 'hunter' },
            'é™·é˜±': { type: 'ability', cost: 1, trap: true, stun: 1, description: 'è®¾ç½®é™·é˜±ï¼Œæ•Œäººè¡ŒåŠ¨æ—¶å—åˆ°8ç‚¹ä¼¤å®³å¹¶çœ©æ™•1å›åˆ', art: 'trap', rarity: 'uncommon', character: 'hunter' },
            'çˆ†ç‚¸é™·é˜±': { type: 'ability', cost: 2, trap: true, explosion: true, description: 'è®¾ç½®çˆ†ç‚¸é™·é˜±ï¼Œæ•Œäººè¡ŒåŠ¨æ—¶å—åˆ°12ç‚¹ä¼¤å®³å¹¶å¯¹å…¶ä»–æ•Œäººé€ æˆ4ç‚¹æº…å°„ä¼¤å®³', art: 'explosive-trap', rarity: 'rare', character: 'hunter' },
            'æ¯’è›‡é™·é˜±': { type: 'ability', cost: 2, trap: true, poison: 3, description: 'è®¾ç½®æ¯’è›‡é™·é˜±ï¼Œæ•Œäººè¡ŒåŠ¨æ—¶å—åˆ°6ç‚¹ä¼¤å®³å¹¶æ–½åŠ 3å±‚æ¯’ç´ ', art: 'snake-trap', rarity: 'rare', character: 'hunter' },
            'è¿½è¸ª': { type: 'ability', cost: 1, draw: 1, description: 'æŠ½1å¼ ç‰Œ', art: 'track', rarity: 'common', character: 'hunter' },
            'é¹°çœ¼': { type: 'ability', cost: 0, buff: 'precision', stacks: 1, description: 'è·å¾—1å±‚ç²¾å‡†ï¼ˆä¸‹æ¬¡è¿œç¨‹æ”»å‡»ä¼¤å®³+4ï¼‰', art: 'eagle-eye', rarity: 'common', character: 'hunter' },
            'æ€¥é€Ÿå°„å‡»': { type: 'attack', cost: 2, damage: 7, range: true, draw: 1, description: 'é€ æˆ7ç‚¹è¿œç¨‹ä¼¤å®³å¹¶æŠ½1å¼ ç‰Œ', art: 'rapid-shot', rarity: 'uncommon', character: 'hunter' },
            'ç¨³å›ºå°„å‡»': { type: 'attack', cost: 3, damage: 15, range: true, exhaust: true, description: 'é€ æˆ15ç‚¹è¿œç¨‹ä¼¤å®³ï¼Œä½¿ç”¨åç§»é™¤', art: 'steady-shot', rarity: 'rare', character: 'hunter' },
            
            // æˆ˜å£«æ”»å‡»å¡ç‰Œ
            'é‡å‡»': { type: 'attack', cost: 2, damage: 10, description: 'é€ æˆ10ç‚¹ä¼¤å®³', art: 'sword-strike', rarity: 'common', character: 'warrior' },
            'æˆ˜å¼': { type: 'attack', cost: 1, damage: 6, buff: 'strength', stacks: 1, description: 'é€ æˆ6ç‚¹ä¼¤å®³ï¼Œè·å¾—1å±‚åŠ›é‡', art: 'charge', rarity: 'common', character: 'warrior' },
            'æ„¤æ€’': { type: 'attack', cost: 1, damage: 8, self_damage: 2, description: 'é€ æˆ8ç‚¹ä¼¤å®³ï¼Œå¯¹è‡ªå·±é€ æˆ2ç‚¹ä¼¤å®³', art: 'berserker', rarity: 'common', character: 'warrior' },
            'å—œè¡€': { type: 'attack', cost: 2, damage: 8, lifesteal: true, description: 'é€ æˆ8ç‚¹ä¼¤å®³å¹¶æ¢å¤ç­‰é‡ç”Ÿå‘½å€¼', art: 'vampiric', rarity: 'common', character: 'warrior' },
            'ç‹‚æš´æ”»å‡»': { type: 'attack', cost: 3, damage: 16, exhaust: true, description: 'é€ æˆ16ç‚¹ä¼¤å®³ï¼Œä½¿ç”¨åç§»é™¤', art: 'berserker', rarity: 'uncommon', character: 'warrior' },
            'åŒåˆƒæ–©': { type: 'attack', cost: 2, damage: 6, hits: 2, description: 'æ”»å‡»2æ¬¡ï¼Œæ¯æ¬¡6ç‚¹ä¼¤å®³', art: 'dual-slash', rarity: 'uncommon', character: 'warrior' },
            'æ¨ªæ‰«åƒå†›': { type: 'attack', cost: 3, damage: 8, splash: 6, description: 'é€ æˆ8ç‚¹ä¼¤å®³ï¼Œå¯¹å…¶ä»–æ•Œäººé€ æˆ6ç‚¹æº…å°„ä¼¤å®³', art: 'cleave', rarity: 'uncommon', character: 'warrior' },
            'æ–©é¦–': { type: 'attack', cost: 3, damage: 12, execute: 0.3, description: 'é€ æˆ12ç‚¹ä¼¤å®³ï¼Œæ•Œäººè¡€é‡ä½äº30%æ—¶ç§’æ€', art: 'execute', rarity: 'rare', character: 'warrior' },
            'æˆ˜äº‰è·µè¸': { type: 'attack', cost: 3, damage: 12, stun: 1, description: 'é€ æˆ12ç‚¹ä¼¤å®³å¹¶çœ©æ™•æ•Œäºº1å›åˆ', art: 'stomp', rarity: 'rare', character: 'warrior' },
            
            // ç›—è´¼æ”»å‡»å¡ç‰Œ
            'å¿«åˆ€': { type: 'attack', cost: 1, damage: 5, description: 'é€ æˆ5ç‚¹ä¼¤å®³', art: 'dagger', rarity: 'common', character: 'rogue' },
            'å½±è¢­': { type: 'attack', cost: 2, damage: 8, combo: true, description: 'é€ æˆ8ç‚¹ä¼¤å®³ï¼Œè¿å‡»ï¼š+3ä¼¤å®³', art: 'combo', rarity: 'common', character: 'rogue' },
            'æ¯’åˆƒ': { type: 'attack', cost: 2, damage: 6, poison: 2, description: 'é€ æˆ6ç‚¹ä¼¤å®³å¹¶æ–½åŠ 2å±‚æ¯’ç´ ', art: 'poison-blade', rarity: 'common', character: 'rogue' },
            'å‰²è£‚': { type: 'attack', cost: 2, damage: 6, bleed: 4, description: 'é€ æˆ6ç‚¹ä¼¤å®³å¹¶æ–½åŠ 4å±‚æµè¡€', art: 'bleed', rarity: 'common', character: 'rogue', dot_multiplier: 0.75 },
            'è‡´å‘½ä¸€å‡»': { type: 'attack', cost: 2, damage: 12, crit_bonus: 0.3, description: 'é€ æˆ12ç‚¹ä¼¤å®³ï¼Œ30%å‡ ç‡é€ æˆåŒå€ä¼¤å®³', art: 'critical', rarity: 'uncommon', character: 'rogue' },
            'ç©¿åˆº': { type: 'attack', cost: 2, damage: 10, pierce: true, description: 'é€ æˆ10ç‚¹ä¼¤å®³ï¼Œæ— è§†æŠ¤ç›¾', art: 'pierce', rarity: 'uncommon', character: 'rogue' },
            'è¿å‡»é£æš´': { type: 'attack', cost: 2, damage: 4, combo: true, hits: 3, description: 'è¿å‡»ï¼šé€ æˆ3æ¬¡4ç‚¹ä¼¤å®³', art: 'combo-storm', rarity: 'uncommon', character: 'rogue' },
            'æš—æ€': { type: 'attack', cost: 3, damage: 20, stealth_bonus: true, description: 'é€ æˆ20ç‚¹ä¼¤å®³ï¼Œæ½œè¡Œæ—¶ä¼¤å®³ç¿»å€', art: 'execute', rarity: 'rare', character: 'rogue' },
            
            // æˆ˜å£«é˜²å¾¡å¡ç‰Œ
            'é“å£é˜²å¾¡': { type: 'defense', cost: 1, block: 6, description: 'è·å¾—6ç‚¹æŠ¤ç›¾', art: 'shield', rarity: 'common', character: 'warrior' },
            'åšéŸ§': { type: 'defense', cost: 1, buff: 'armor', stacks: 1, description: 'è·å¾—1å±‚æŠ¤ç”²ï¼ˆæ°¸ä¹…å‡ä¼¤1ç‚¹ï¼‰', art: 'toughness', rarity: 'common', character: 'warrior' },
            'æˆ˜æœ¯æ’¤é€€': { type: 'defense', cost: 1, block: 4, draw: 1, description: 'è·å¾—4æŠ¤ç›¾å¹¶æŠ½1å¼ ç‰Œ', art: 'parry', rarity: 'common', character: 'warrior' },
            'å˜²è®½': { type: 'defense', cost: 1, block: 3, taunt: true, description: 'è·å¾—3æŠ¤ç›¾ï¼Œå¸å¼•æ•Œäººæ”»å‡»', art: 'taunt', rarity: 'common', character: 'warrior' },
            'åå‡»': { type: 'defense', cost: 2, block: 5, counter: 6, description: 'è·å¾—5æŠ¤ç›¾ï¼Œå—åˆ°æ”»å‡»æ—¶åå‡»6ç‚¹ä¼¤å®³', art: 'counter', rarity: 'uncommon', character: 'warrior' },
            'é’¢é“æ„å¿—': { type: 'defense', cost: 2, block: 10, buff: 'strength', stacks: 1, description: 'è·å¾—10æŠ¤ç›¾å’Œ1å±‚åŠ›é‡', art: 'iron-will', rarity: 'uncommon', character: 'warrior' },
            'ç›¾ç‰ŒçŒ›å‡»': { type: 'defense', cost: 2, block: 8, damage: 6, description: 'è·å¾—8æŠ¤ç›¾å¹¶é€ æˆ6ç‚¹ä¼¤å®³', art: 'shield-bash', rarity: 'uncommon', character: 'warrior' },
            'å®Œç¾é˜²å¾¡': { type: 'defense', cost: 3, block: 18, exhaust: true, description: 'è·å¾—18æŠ¤ç›¾ï¼Œä½¿ç”¨åç§»é™¤', art: 'perfect-defense', rarity: 'rare', character: 'warrior' },
            
            // ç›—è´¼é˜²å¾¡å¡ç‰Œ
            'é—ªé¿': { type: 'defense', cost: 1, block: 5, description: 'è·å¾—5ç‚¹æŠ¤ç›¾', art: 'dodge', rarity: 'common', character: 'rogue' },
            'æ½œè¡Œ': { type: 'defense', cost: 2, stealth: 1, draw: 1, description: 'è·å¾—1å›åˆæ½œè¡Œå¹¶æŠ½1å¼ ç‰Œï¼ˆä¸€åœºæˆ˜æ–—ä¸­ä½¿ç”¨è¶…è¿‡2æ¬¡åï¼Œæ¯å¤šä½¿ç”¨ä¸€æ¬¡å¢åŠ 20%å¤±è´¥æ¦‚ç‡ï¼‰', art: 'stealth', rarity: 'common', character: 'rogue' },
            'çƒŸé›¾å¼¹': { type: 'defense', cost: 1, dodge_next: true, description: 'ä¸‹æ¬¡æ”»å‡»å¿…å®šé—ªé¿', art: 'dodge', rarity: 'uncommon', character: 'rogue' },
            'å½±åˆ†èº«': { type: 'defense', cost: 2, block: 8, combo: true, description: 'è·å¾—8æŠ¤ç›¾ï¼Œè¿å‡»ï¼šå†è·å¾—4æŠ¤ç›¾', art: 'clone', rarity: 'uncommon', character: 'rogue' },
            'æ¶ˆå¤±': { type: 'defense', cost: 3, stealth: 2, draw: 2, description: 'è·å¾—2å›åˆæ½œè¡Œå¹¶æŠ½2å¼ ç‰Œï¼ˆä¸€åœºæˆ˜æ–—ä¸­ä½¿ç”¨è¶…è¿‡2æ¬¡åï¼Œæ¯å¤šä½¿ç”¨ä¸€æ¬¡å¢åŠ 20%å¤±è´¥æ¦‚ç‡ï¼‰', art: 'vanish', rarity: 'rare', character: 'rogue' },
            
            // æ³•å¸ˆé­”æ³•å¡ç‰Œ
            'é­”æ³•é£å¼¹': { type: 'magic', cost: 1, damage: 4, hits: 2, description: 'å‘å°„2æšé£å¼¹ï¼Œæ¯æšé€ æˆ4ç‚¹ä¼¤å®³', art: 'magic-missile', rarity: 'common', character: 'mage' },
            'æ³•å¸ˆæŠ¤ç”²': { type: 'magic', cost: 1, block: 5, description: 'è·å¾—5ç‚¹æŠ¤ç›¾', art: 'magic-shield', rarity: 'common', character: 'mage' },
            'å¥¥æœ¯æ´å¯Ÿ': { type: 'magic', cost: 1, draw: 2, energy_gain: 1, description: 'æŠ½2å¼ ç‰Œå¹¶è·å¾—1ç‚¹èƒ½é‡', art: 'focus', rarity: 'common', character: 'mage' },
            'å†°éœœæ–°æ˜Ÿ': { type: 'magic', cost: 2, damage: 6, freeze: 1, description: 'é€ æˆ6ç‚¹ä¼¤å®³å¹¶å†°å†»æ•Œäºº1å›åˆ', art: 'freeze-ray', rarity: 'common', character: 'mage' },
            'é­”åŠ›æ¶Œæµ': { type: 'magic', cost: 0, energy_gain: 2, exhaust: true, description: 'è·å¾—2ç‚¹èƒ½é‡ï¼Œä½¿ç”¨åç§»é™¤', art: 'mana-drain', rarity: 'common', character: 'mage' },
            'ä¼ é€': { type: 'magic', cost: 1, dodge_next: true, draw: 1, description: 'ä¸‹æ¬¡æ”»å‡»å¿…å®šé—ªé¿ï¼ŒæŠ½1å¼ ç‰Œ', art: 'teleport', rarity: 'common', character: 'mage' },
            'ç«çƒæœ¯': { type: 'magic', cost: 2, damage: 12, burn: 1, description: 'é€ æˆ12ç‚¹ä¼¤å®³å¹¶æ–½åŠ 1å±‚ç‡ƒçƒ§', art: 'fireball', rarity: 'uncommon', character: 'mage' },
            'é—ªç”µé“¾': { type: 'magic', cost: 2, damage: 8, chain: true, description: 'é€ æˆ8ç‚¹ä¼¤å®³ï¼Œæ¯æœ‰1å¼ æ³•æœ¯ç‰Œåœ¨æ‰‹ä¸­+2ä¼¤å®³', art: 'lightning', rarity: 'uncommon', character: 'mage' },
            'å†°å¢™æœ¯': { type: 'magic', cost: 2, block: 12, freeze_attacker: true, description: 'è·å¾—12æŠ¤ç›¾ï¼Œæ”»å‡»è€…è¢«å†°å†»1å›åˆ', art: 'frost-shield', rarity: 'uncommon', character: 'mage' },
            'å¥¥æ•°å¼ºåŒ–': { type: 'magic', cost: 2, buff: 'spellpower', stacks: 2, description: 'è·å¾—2å±‚æ³•æœ¯å¼ºåº¦', art: 'spell-enhance', rarity: 'uncommon', character: 'mage' },
            'å¥¥æœ¯çˆ†å‘': { type: 'magic', cost: 3, damage: 18, discard_hand: true, description: 'é€ æˆ18ç‚¹ä¼¤å®³ï¼Œå¼ƒæ‰æ‰€æœ‰æ‰‹ç‰Œ', art: 'elemental-burst', rarity: 'rare', character: 'mage' },
            'æ—¶é—´æ‰­æ›²': { type: 'magic', cost: 4, extra_turn: true, exhaust: true, description: 'è·å¾—é¢å¤–å›åˆï¼Œä½¿ç”¨åç§»é™¤', art: 'time-warp', rarity: 'rare', character: 'mage' },
            'å…ƒç´ è¿å‡»': { type: 'magic', cost: 3, damage: 15, combo: true, description: 'è¿å‡»ï¼šæ ¹æ®å…ƒç´ æ•ˆæœå¼ºåŒ–ä¼¤å®³', art: 'elemental-combo', rarity: 'rare', character: 'mage' },
            
            // é€šç”¨ç‰¹æ®Šå¡ç‰Œ
            'è‡´å‘½æ¯’è¯': { type: 'special', cost: 1, poison: 3, description: 'ç»™æ•Œäººæ–½åŠ 3å±‚æ¯’ç´ ', art: 'poison-blade', rarity: 'common', character: 'neutral' },
            'æ²»ç–—è¯æ°´': { type: 'special', cost: 1, heal: 8, description: 'æ¢å¤8ç‚¹ç”Ÿå‘½å€¼', art: 'heal', rarity: 'common', character: 'neutral' },
            'ä¸“æ³¨': { type: 'special', cost: 1, draw: 2, description: 'æŠ½2å¼ ç‰Œ', art: 'focus', rarity: 'common', character: 'neutral' },
            'èƒ½é‡æ°´æ™¶': { type: 'special', cost: 0, energy_gain: 1, description: 'è·å¾—1ç‚¹èƒ½é‡', art: 'energy-crystal', rarity: 'common', character: 'neutral' },
            'å¸è¡€': { type: 'special', cost: 2, damage: 8, lifesteal: true, description: 'é€ æˆ8ä¼¤å®³å¹¶æ¢å¤ç­‰é‡ç”Ÿå‘½', art: 'vampiric', rarity: 'uncommon', character: 'neutral' },
            'ç‹‚æ€’è¯å‰‚': { type: 'special', cost: 2, buff: 'strength', stacks: 2, self_damage: 3, description: 'è·å¾—2å±‚åŠ›é‡ï¼Œå—åˆ°3ç‚¹ä¼¤å®³', art: 'rage', rarity: 'uncommon', character: 'neutral' },
            'å‡€åŒ–': { type: 'special', cost: 1, cleanse: true, heal: 6, description: 'ç§»é™¤æ‰€æœ‰è´Ÿé¢æ•ˆæœå¹¶æ¢å¤6ç”Ÿå‘½', art: 'purify', rarity: 'uncommon', character: 'neutral' },
            'çµé­‚é“¾æ¥': { type: 'special', cost: 2, link: true, link_duration: 2, description: 'ä¸æ•Œäººå»ºç«‹çµé­‚é“¾æ¥ï¼Œ2å›åˆå†…åŒæ–¹ä¼¤å®³å…±äº«', art: 'soul-link', rarity: 'uncommon', character: 'neutral' },
            'å…ƒç´ èåˆ': { type: 'special', cost: 3, combine_elements: true, base_damage: 6, effect_multiplier: 2.5, description: 'ç»“åˆæ‰€æœ‰è´Ÿé¢æ•ˆæœé€ æˆåŸºç¡€ä¼¤å®³Ã—(1+æ•ˆæœæ•°é‡Ã—å€ç‡)çš„ä¼¤å®³', art: 'elemental-fusion', rarity: 'uncommon', character: 'neutral' },
            'å¹¸è¿ç¡¬å¸': { type: 'special', cost: 0, lucky: true, description: 'éšæœºè·å¾—æ­£é¢æ•ˆæœ', art: 'lucky-coin', rarity: 'rare', character: 'neutral' },
            'é‡ç”ŸæŠ¤ç¬¦': { type: 'special', cost: 3, revive: true, exhaust: true, description: 'æ­»äº¡æ—¶å¤æ´»å¹¶æ¢å¤50%ç”Ÿå‘½ï¼Œä½¿ç”¨åç§»é™¤', art: 'rebirth', rarity: 'rare', character: 'neutral' },
            'æ— é™å¾ªç¯': { type: 'special', cost: 3, loop: true, description: 'å°†1å¼ å¡ç‰Œæ”¾å›ç‰Œåº“é¡¶éƒ¨', art: 'infinite-loop', rarity: 'rare', character: 'neutral' },
            
            // è¯…å’’å¡ç‰Œï¼ˆè´Ÿé¢æ•ˆæœï¼‰
            'è™šå¼±è¯…å’’': { type: 'curse', cost: 1, weakness: 2, description: 'æ”»å‡»åŠ›-2ï¼Œæ— æ³•ç§»é™¤', art: 'weakness-curse', unremovable: true, rarity: 'curse', character: 'curse' },
            'ç–²åŠ³': { type: 'curse', cost: 2, description: 'æ¶ˆè€—2èƒ½é‡ï¼Œä»€ä¹ˆéƒ½ä¸åš', art: 'fatigue', unremovable: true, rarity: 'curse', character: 'curse' },
            'ç—›è‹¦': { type: 'curse', cost: 0, self_damage: 4, description: 'å¯¹è‡ªå·±é€ æˆ4ç‚¹ä¼¤å®³', art: 'pain', unremovable: true, rarity: 'curse', character: 'curse' },
            'æ··ä¹±': { type: 'curse', cost: 1, random_cost: true, description: 'éšæœºæ¶ˆè€—1-3ç‚¹èƒ½é‡', art: 'pain', unremovable: true, rarity: 'curse', character: 'curse' },
            'ææƒ§': { type: 'curse', cost: 0, fear: true, description: 'æœ¬å›åˆæ— æ³•æ‰“å‡ºæ”»å‡»ç‰Œ', art: 'weakness-curse', unremovable: true, rarity: 'curse', character: 'curse' },
            'å„è¿': { type: 'curse', cost: 0, bad_luck: true, duration: 2, description: '2å›åˆå†…æ‰€æœ‰å¡ç‰Œæ•ˆæœå‡åŠ', art: 'bad-luck', unremovable: true, rarity: 'curse', character: 'curse' },
            
            // ä¼ å¥‡å¡ç‰Œï¼ˆBOSSå¥–åŠ±ï¼‰
            'æš—å½±æ”¯é…': { type: 'special', cost: 3, damage: 25, shadow_clone: true, description: 'é€ æˆ25ç‚¹ä¼¤å®³å¹¶å¬å”¤æš—å½±åˆ†èº«ååŠ©æˆ˜æ–—', art: 'shadow-domination', rarity: 'legendary', character: 'legendary' },
            'é¾™ç‹ä¹‹æ€’': { type: 'attack', cost: 4, damage: 35, dragon_breath: true, description: 'é€ æˆ35ç‚¹ä¼¤å®³ï¼Œå¯¹æ‰€æœ‰æ•Œäººç”Ÿæ•ˆ', art: 'dragon-fury', rarity: 'legendary', character: 'legendary' },
            'æ—¶ç©ºæ‰­æ›²': { type: 'special', cost: 2, time_warp: true, extra_turn: true, description: 'è·å¾—é¢å¤–å›åˆå¹¶é‡ç½®æ‰€æœ‰å†·å´', art: 'time-warp', rarity: 'legendary', character: 'legendary' },
            
            'å…ƒç´ æŒæ§': { type: 'magic', cost: 3, elemental_mastery: true, description: 'æ ¹æ®åœºä¸Šå…ƒç´ ç±»å‹é€ æˆä¸åŒæ•ˆæœ', art: 'elemental-control', rarity: 'legendary', character: 'legendary' },
            'é£æš´ä¹‹å¿ƒ': { type: 'magic', cost: 2, storm_core: true, description: 'æ¯æ‰“å‡ºä¸€å¼ ç‰Œè·å¾—1ç‚¹èƒ½é‡ï¼Œæœ¬å›åˆæœ€å¤š5ç‚¹', art: 'storm-heart', rarity: 'legendary', character: 'legendary' },
            'æ°¸æ’å†°æ™¶': { type: 'defense', cost: 1, eternal_ice: true, description: 'è·å¾—æ°¸ä¹…æŠ¤ç›¾ï¼Œæ¯å›åˆ+3æŠ¤ç›¾å€¼', art: 'eternal-ice', rarity: 'legendary', character: 'legendary' },
            
            'è™šç©ºæŒæ¡': { type: 'special', cost: 4, void_mastery: true, description: 'ç§»é™¤æ•Œäººæ‰€æœ‰æ­£é¢æ•ˆæœå¹¶é€ æˆç­‰é‡ä¼¤å®³', art: 'void-mastery', rarity: 'legendary', character: 'legendary' },
            'ç°å®é‡æ„': { type: 'special', cost: 3, reality_rewrite: true, description: 'é‡æ–°æ´—ç‰Œå¹¶æŠ½5å¼ ç‰Œï¼Œæœ¬å›åˆç‰Œè´¹ç”¨-1', art: 'reality-rewrite', rarity: 'legendary', character: 'legendary' },
            'å­˜åœ¨æ¹®ç­': { type: 'attack', cost: 5, existence_erase: true, description: 'é€ æˆæ•Œäººå½“å‰ç”Ÿå‘½å€¼50%çš„ä¼¤å®³', art: 'existence-erasure', rarity: 'legendary', character: 'legendary' },
            
            'åˆ›ä¸–ä¹‹åŠ›': { type: 'special', cost: 4, genesis_power: true, description: 'æ¢å¤æ‰€æœ‰ç”Ÿå‘½å€¼å¹¶è·å¾—æ‰€æœ‰æ­£é¢æ•ˆæœ', art: 'genesis-power', rarity: 'legendary', character: 'legendary' },
            'ç¥åœ£å®¡åˆ¤': { type: 'attack', cost: 3, divine_judgment: true, description: 'é€ æˆä¼¤å®³ç­‰äºæ•Œäººå·²æŸå¤±ç”Ÿå‘½å€¼', art: 'divine-judgment', rarity: 'legendary', character: 'legendary' },
            'æ°¸æ’è½®å›': { type: 'special', cost: 0, eternal_cycle: true, exhaust: true, description: 'æ­»äº¡æ—¶å¤æ´»å¹¶æ¢å¤æ»¡è¡€ï¼Œè·å¾—æ‰€æœ‰ä¼ å¥‡å¡ç‰Œ', art: 'eternal-cycle', rarity: 'legendary', character: 'legendary' },
            
            // æ–°ä¼ å¥‡å¡ç‰Œ
            'è‡ªç„¶ä¹‹åŠ›': { type: 'magic', cost: 3, nature_power: true, base_damage: 10, dot_multiplier: 2, description: 'æ¯æœ‰1å±‚è‡ªç„¶æ•ˆæœï¼ˆæµè¡€/æ¯’ç´ ï¼‰é€ æˆé¢å¤–ä¼¤å®³', art: 'nature-force', rarity: 'legendary', character: 'legendary' },
            'æˆ˜äº‰ä¹‹ç¥': { type: 'attack', cost: 4, war_god: true, base_damage: 15, strength_multiplier: 3, description: 'æ¯æœ‰1å±‚åŠ›é‡è·å¾—é¢å¤–ä¼¤å®³ï¼Œæ¶ˆè€—æ‰€æœ‰åŠ›é‡å±‚æ•°', art: 'war-god', rarity: 'legendary', character: 'legendary' }
        };

        // æ•Œäººæ•°æ®
        const enemies = [
            { name: 'å“¥å¸ƒæ—', icon: 'ğŸ‘¹', hp: 28, attack: 6, pattern: 'simple', abilities: [], intent: 'attack', description: 'æœ€åŸºç¡€çš„æ•Œäººï¼Œæ”»å‡»ç®€å•ç›´æ¥' },
            { name: 'å“¥å¸ƒæ—å¼“æ‰‹', icon: 'ğŸ¹', hp: 22, attack: 8, pattern: 'ranged', abilities: ['precise_shot'], intent: 'attack', description: 'è¿œç¨‹æ”»å‡»ï¼Œæœ‰å‡ ç‡é€ æˆé¢å¤–ä¼¤å®³' },
            { name: 'å…½äººæˆ˜å£«', icon: 'ğŸ§Œ', hp: 42, attack: 10, pattern: 'aggressive', abilities: ['rage'], intent: 'buff', description: 'è¡€é‡ä½æ—¶ä¼šè¿›å…¥ç‹‚æ€’çŠ¶æ€' },
            { name: 'æš—å½±åˆºå®¢', icon: 'ğŸ¥·', hp: 30, attack: 12, pattern: 'burst', abilities: ['stealth', 'poison'], intent: 'stealth', description: 'æ“…é•¿æ½œè¡Œå’Œæ¯’ç´ æ”»å‡»' },
            { name: 'çŸ³å¤´å·¨äºº', icon: 'ğŸ—¿', hp: 65, attack: 8, pattern: 'tank', abilities: ['armor', 'thorns'], intent: 'defend', description: 'é«˜è¡€é‡é«˜é˜²å¾¡ï¼Œæ”»å‡»è€…ä¼šå—åˆ°åä¼¤' },
            { name: 'ç«ç„°æ¶é­”', icon: 'ğŸ‘º', hp: 48, attack: 14, pattern: 'magic', abilities: ['burn', 'fire_shield'], intent: 'attack', description: 'ç«ç„°æ”»å‡»ä¼šé€ æˆæŒç»­ç‡ƒçƒ§ä¼¤å®³' },
            { name: 'å†°éœœæ³•å¸ˆ', icon: 'ğŸ§™â€â™‚ï¸', hp: 38, attack: 10, pattern: 'magic', abilities: ['freeze', 'ice_armor'], intent: 'debuff', description: 'å†°éœœé­”æ³•ä¼šå†°å†»æ•Œäºº' },
            { name: 'æ¯’è›‡', icon: 'ğŸ', hp: 25, attack: 5, pattern: 'poison', abilities: ['poison', 'dodge'], intent: 'debuff', description: 'é€Ÿåº¦å¿«ï¼Œæ”»å‡»å¸¦æ¯’ï¼Œéš¾ä»¥å‘½ä¸­' },
            { name: 'éª·é«…æˆ˜å£«', icon: 'ğŸ’€', hp: 35, attack: 9, pattern: 'undead', abilities: ['revive', 'bone_armor'], intent: 'attack', description: 'ä¸æ­»ç”Ÿç‰©ï¼Œæœ‰å‡ ç‡å¤æ´»' },
            { name: 'é›·ç”µå…ƒç´ ', icon: 'âš¡', hp: 32, attack: 13, pattern: 'elemental', abilities: ['chain_lightning', 'energy_drain'], intent: 'special', description: 'é›·ç”µæ”»å‡»ä¼šè¿é”ä¼ å¯¼' },
            { name: 'è¡€é­”', icon: 'ğŸ©¸', hp: 45, attack: 11, pattern: 'vampire', abilities: ['lifesteal', 'blood_curse'], intent: 'attack', description: 'å¸è¡€æ”»å‡»ï¼Œä¼šè¯…å’’æ•Œäºº' },
            { name: 'æœºæ¢°å®ˆå«', icon: 'ğŸ¤–', hp: 58, attack: 12, pattern: 'construct', abilities: ['repair', 'overload'], intent: 'defend', description: 'æœºæ¢°æ„é€ ä½“ï¼Œå¯ä»¥è‡ªæˆ‘ä¿®å¤' },
            { name: 'æš—å½±é¢†ä¸»', icon: 'ğŸ‘¤', hp: 72, attack: 16, pattern: 'shadow', abilities: ['shadow_clone', 'darkness'], intent: 'special', description: 'æš—å½±é­”æ³•å¤§å¸ˆï¼Œå¯ä»¥åˆ†èº«' },
            { name: 'å‡¤å‡°', icon: 'ğŸ”¥', hp: 55, attack: 18, pattern: 'phoenix', abilities: ['rebirth', 'fire_aura'], intent: 'attack', description: 'æ­»äº¡æ—¶ä¼šé‡ç”Ÿï¼Œç«ç„°å…‰ç¯' },
            { name: 'æ—¶é—´å®ˆæŠ¤è€…', icon: 'â°', hp: 62, attack: 14, pattern: 'time', abilities: ['time_stop', 'rewind'], intent: 'special', description: 'æŒæ§æ—¶é—´çš„å¼ºå¤§å­˜åœ¨' },
            { name: 'è™šç©ºè¡Œè€…', icon: 'ğŸŒŒ', hp: 68, attack: 20, pattern: 'void', abilities: ['void_strike', 'reality_tear'], intent: 'attack', description: 'æ¥è‡ªè™šç©ºçš„ææ€–ç”Ÿç‰©' },
            { name: 'å¤é¾™', icon: 'ğŸ‰', hp: 120, attack: 25, pattern: 'dragon', abilities: ['dragon_breath', 'ancient_magic', 'flight'], intent: 'special', description: 'å¤è€è€Œå¼ºå¤§çš„é¾™æ—' },
            { name: 'æ··æ²Œä¹‹ä¸»', icon: 'ğŸ‘ï¸', hp: 150, attack: 28, pattern: 'chaos', abilities: ['chaos_bolt', 'reality_warp', 'summon_minions'], intent: 'special', description: 'æ··æ²Œçš„åŒ–èº«ï¼Œä¸å¯é¢„æµ‹' }
        ];

        // äº‹ä»¶ç³»ç»Ÿ
        const randomEvents = [
            {
                name: 'ç¥ç§˜å•†äºº',
                description: 'ä½ é‡åˆ°äº†ä¸€ä¸ªç¥ç§˜å•†äººï¼Œä»–æ„¿æ„ç”¨ç‰¹æ®Šä»·æ ¼äº¤æ˜“...',
                choices: [
                    { text: 'è´­ä¹°ç¨€æœ‰å¡ç‰Œ (30é‡‘å¸)', cost: 30, effect: 'rare_card' },
                    { text: 'è´­ä¹°ç¥å™¨ (50é‡‘å¸)', cost: 50, effect: 'relic' },
                    { text: 'ç¦»å¼€', cost: 0, effect: 'nothing' }
                ]
            },
            {
                name: 'å¤è€ç¥­å›',
                description: 'ä½ å‘ç°äº†ä¸€ä¸ªå¤è€çš„ç¥­å›ï¼Œæ•£å‘ç€ç¥ç§˜çš„åŠ›é‡...',
                choices: [
                    { text: 'çŒ®ç¥­ç”Ÿå‘½å€¼æ¢å–åŠ›é‡ (-20HP, +3åŠ›é‡)', cost: 20, effect: 'sacrifice_hp' },
                    { text: 'å‡€åŒ–è¯…å’’ (ç§»é™¤æ‰€æœ‰è¯…å’’å¡)', cost: 0, effect: 'purify' },
                    { text: 'ç¦»å¼€', cost: 0, effect: 'nothing' }
                ]
            },
            {
                name: 'é­”æ³•æ³‰æ°´',
                description: 'ä½ æ‰¾åˆ°äº†ä¸€å¤„é­”æ³•æ³‰æ°´ï¼Œæ³‰æ°´é—ªé—ªå‘å…‰...',
                choices: [
                    { text: 'é¥®ç”¨æ³‰æ°´ (å®Œå…¨æ¢å¤)', cost: 0, effect: 'full_heal' },
                    { text: 'ç”¨ç©ºç“¶æ”¶é›† (è·å¾—æ²»ç–—è¯æ°´å¡)', cost: 0, effect: 'heal_potion' },
                    { text: 'ç¦»å¼€', cost: 0, effect: 'nothing' }
                ]
            },
            {
                name: 'æµæµªæ³•å¸ˆ',
                description: 'ä¸€ä½æµæµªæ³•å¸ˆæ„¿æ„ä¼ æˆä½ é­”æ³•çŸ¥è¯†...',
                choices: [
                    { text: 'å­¦ä¹ æ³•æœ¯ (è·å¾—éšæœºæ³•æœ¯å¡)', cost: 0, effect: 'magic_card' },
                    { text: 'è¯·æ±‚å¼ºåŒ– (éšæœºå¼ºåŒ–ä¸€å¼ å¡)', cost: 15, effect: 'upgrade_card' },
                    { text: 'ç¦»å¼€', cost: 0, effect: 'nothing' }
                ]
            },
            {
                name: 'è¯…å’’å®ç®±',
                description: 'ä½ å‘ç°äº†ä¸€ä¸ªæ•£å‘ä¸ç¥¥æ°”æ¯çš„å®ç®±...',
                choices: [
                    { text: 'æ‰“å¼€å®ç®± (è·å¾—ç¨€æœ‰å¡ç‰Œ+è¯…å’’å¡)', cost: 0, effect: 'cursed_treasure' },
                    { text: 'å‡€åŒ–åæ‰“å¼€ (20é‡‘å¸ï¼Œåªè·å¾—ç¨€æœ‰å¡ç‰Œ)', cost: 20, effect: 'purified_treasure' },
                    { text: 'ç¦»å¼€', cost: 0, effect: 'nothing' }
                ]
            }
        ];

        // æˆå°±ç³»ç»Ÿ
        const achievements = {
            'first_victory': { name: 'åˆæ¬¡èƒœåˆ©', description: 'èµ¢å¾—ç¬¬ä¸€åœºæˆ˜æ–—', unlocked: false },
            'boss_slayer': { name: 'BOSSæ€æ‰‹', description: 'å‡»è´¥ç¬¬ä¸€ä¸ªå®ˆå…³BOSS', unlocked: false },
            'legendary_collector': { name: 'ä¼ å¥‡æ”¶è—å®¶', description: 'è·å¾—ç¬¬ä¸€å¼ ä¼ å¥‡å¡ç‰Œ', unlocked: false },
            'combo_master': { name: 'è¿å‡»å¤§å¸ˆ', description: 'å•å›åˆæ‰“å‡º5å¼ ç‰Œ', unlocked: false },
            'survivor': { name: 'å¹¸å­˜è€…', description: 'åœ¨ç”Ÿå‘½å€¼ä½äº10æ—¶è·èƒœ', unlocked: false },
            'perfectionist': { name: 'å®Œç¾ä¸»ä¹‰è€…', description: 'ä¸å—ä¼¤å®³å®Œæˆä¸€åœºæˆ˜æ–—', unlocked: false },
            'hoarder': { name: 'å›¤ç§¯è€…', description: 'æ‹¥æœ‰è¶…è¿‡100é‡‘å¸', unlocked: false },
            'ascension': { name: 'é£å‡è€…', description: 'å®Œæˆä¸€æ¬¡éš¾åº¦æå‡æŒ‘æˆ˜', unlocked: false }
        };

        // å¡ç‰Œå¼ºåŒ–ç³»ç»Ÿ
        const cardUpgrades = {
            // é€šç”¨å¡ç‰Œ
            'é‡å‡»': { name: 'é‡å‡»+', damage: 14, description: 'é€ æˆ14ç‚¹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å¿«åˆ€': { name: 'å¿«åˆ€+', damage: 7, description: 'é€ æˆ7ç‚¹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'é­”æ³•é£å¼¹': { name: 'é­”æ³•é£å¼¹+', damage: 6, hits: 2, description: 'å‘å°„2æšé£å¼¹ï¼Œæ¯æšé€ æˆ6ç‚¹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'é“å£é˜²å¾¡': { name: 'é“å£é˜²å¾¡+', block: 9, description: 'è·å¾—9ç‚¹æŠ¤ç›¾ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'é—ªé¿': { name: 'é—ªé¿+', block: 8, description: 'è·å¾—8ç‚¹æŠ¤ç›¾ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æ³•å¸ˆæŠ¤ç”²': { name: 'æ³•å¸ˆæŠ¤ç”²+', block: 8, description: 'è·å¾—8ç‚¹æŠ¤ç›¾ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // éª‘å£«å¡ç‰Œ
            'æ­£ä¹‰æ‰“å‡»': { name: 'æ­£ä¹‰æ‰“å‡»+', damage: 10, description: 'é€ æˆ10ç‚¹ç¥åœ£ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'åå­—å†›æ‰“å‡»': { name: 'åå­—å†›æ‰“å‡»+', damage: 12, description: 'é€ æˆ12ç‚¹ç¥åœ£ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç¥åœ£æ„¤æ€’': { name: 'ç¥åœ£æ„¤æ€’+', damage: 11, splash: 6, description: 'é€ æˆ11ç‚¹ç¥åœ£ä¼¤å®³ï¼Œå¯¹å…¶ä»–æ•Œäººé€ æˆ6ç‚¹æº…å°„ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å…‰æ˜å®¡åˆ¤': { name: 'å…‰æ˜å®¡åˆ¤+', damage: 13, heal: 4, description: 'é€ æˆ13ç‚¹ç¥åœ£ä¼¤å®³å¹¶æ¢å¤4ç‚¹ç”Ÿå‘½å€¼ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å¤ä»‡æ‰“å‡»': { name: 'å¤ä»‡æ‰“å‡»+', damage: 15, maxHealthBonus: 0.08, description: 'é€ æˆ15ç‚¹ç¥åœ£ä¼¤å®³ï¼Œå¹¶é™„åŠ ç›®æ ‡æœ€å¤§ç”Ÿå‘½å€¼8%çš„é¢å¤–ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'åœ£ç›¾æœ¯': { name: 'åœ£ç›¾æœ¯+', block: 11, description: 'è·å¾—11ç‚¹æŠ¤ç›¾ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'è™”è¯š': { name: 'è™”è¯š+', buff: 'holy_strength', stacks: 2, description: 'è·å¾—2å±‚ç¥åœ£ä¹‹åŠ›ï¼ˆæ¯å±‚ä¸‹æ¬¡ç¥åœ£æ”»å‡»+4ä¼¤å®³ï¼‰ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å…‰æ˜ç¥ç¦': { name: 'å…‰æ˜ç¥ç¦+', buff: 'holy_armor', stacks: 3, description: 'è·å¾—3å±‚ç¥åœ£æŠ¤ç”²ï¼ˆæ¯å±‚+2æŠ¤ç›¾æ•ˆæœï¼‰ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // æ³•å¸ˆå¡ç‰Œ
            'ç«çƒæœ¯': { name: 'ç«çƒæœ¯+', damage: 15, burn: 2, description: 'é€ æˆ15ç‚¹ä¼¤å®³å¹¶æ–½åŠ 2å±‚ç‡ƒçƒ§ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'é—ªç”µé“¾': { name: 'é—ªç”µé“¾+', damage: 10, chain: true, description: 'é€ æˆ10ç‚¹ä¼¤å®³ï¼Œæ¯æœ‰1å¼ æ³•æœ¯ç‰Œåœ¨æ‰‹ä¸­+2ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å†°éœœæ–°æ˜Ÿ': { name: 'å†°éœœæ–°æ˜Ÿ+', damage: 8, freeze: 1, description: 'é€ æˆ8ç‚¹ä¼¤å®³å¹¶å†°å†»æ•Œäºº1å›åˆï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å¥¥æ•°å¼ºåŒ–': { name: 'å¥¥æ•°å¼ºåŒ–+', buff: 'spellpower', stacks: 3, description: 'è·å¾—3å±‚æ³•æœ¯å¼ºåº¦ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å¥¥æœ¯æ´å¯Ÿ': { name: 'å¥¥æœ¯æ´å¯Ÿ+', draw: 3, energy_gain: 1, description: 'æŠ½3å¼ ç‰Œå¹¶è·å¾—1ç‚¹èƒ½é‡ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'é­”åŠ›æ¶Œæµ': { name: 'é­”åŠ›æ¶Œæµ+', energy_gain: 3, exhaust: true, description: 'è·å¾—3ç‚¹èƒ½é‡ï¼Œä½¿ç”¨åç§»é™¤ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // çŒäººå¡ç‰Œ
            'ç²¾å‡†å°„å‡»': { name: 'ç²¾å‡†å°„å‡»+', damage: 8, range: true, description: 'é€ æˆ8ç‚¹è¿œç¨‹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç®­é›¨': { name: 'ç®­é›¨+', damage: 6, hits: 3, range: true, description: 'å‘å°„3æ”¯ç®­ï¼Œæ¯æ”¯é€ æˆ6ç‚¹è¿œç¨‹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç©¿é€å°„å‡»': { name: 'ç©¿é€å°„å‡»+', damage: 13, pierce: true, range: true, description: 'é€ æˆ13ç‚¹è¿œç¨‹ä¼¤å®³ï¼Œæ— è§†æŠ¤ç›¾ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç„å‡†å°„å‡»': { name: 'ç„å‡†å°„å‡»+', damage: 15, precision: true, range: true, description: 'é€ æˆ15ç‚¹è¿œç¨‹ä¼¤å®³ï¼Œå¯¹æ ‡è®°çš„æ•Œäººä¼¤å®³ç¿»å€ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æ€¥é€Ÿå°„å‡»': { name: 'æ€¥é€Ÿå°„å‡»+', damage: 9, range: true, draw: 1, description: 'é€ æˆ9ç‚¹è¿œç¨‹ä¼¤å®³å¹¶æŠ½1å¼ ç‰Œï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç¨³å›ºå°„å‡»': { name: 'ç¨³å›ºå°„å‡»+', damage: 18, range: true, exhaust: true, description: 'é€ æˆ18ç‚¹è¿œç¨‹ä¼¤å®³ï¼Œä½¿ç”¨åç§»é™¤ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // æˆ˜å£«å¡ç‰Œ
            'æˆ˜å¼': { name: 'æˆ˜å¼+', damage: 8, buff: 'strength', stacks: 2, description: 'é€ æˆ8ç‚¹ä¼¤å®³ï¼Œè·å¾—2å±‚åŠ›é‡ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å—œè¡€': { name: 'å—œè¡€+', damage: 10, lifesteal: true, description: 'é€ æˆ10ç‚¹ä¼¤å®³å¹¶æ¢å¤ç­‰é‡ç”Ÿå‘½å€¼ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç‹‚æš´æ”»å‡»': { name: 'ç‹‚æš´æ”»å‡»+', damage: 20, exhaust: true, description: 'é€ æˆ20ç‚¹ä¼¤å®³ï¼Œä½¿ç”¨åç§»é™¤ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æ¨ªæ‰«åƒå†›': { name: 'æ¨ªæ‰«åƒå†›+', damage: 10, splash: 8, description: 'é€ æˆ10ç‚¹ä¼¤å®³ï¼Œå¯¹å…¶ä»–æ•Œäººé€ æˆ8ç‚¹æº…å°„ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æ–©é¦–': { name: 'æ–©é¦–+', damage: 15, execute: 0.35, description: 'é€ æˆ15ç‚¹ä¼¤å®³ï¼Œæ•Œäººè¡€é‡ä½äº35%æ—¶ç§’æ€ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç›¾ç‰ŒçŒ›å‡»': { name: 'ç›¾ç‰ŒçŒ›å‡»+', block: 10, damage: 8, description: 'è·å¾—10æŠ¤ç›¾å¹¶é€ æˆ8ç‚¹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // ç›—è´¼å¡ç‰Œ
            'å½±è¢­': { name: 'å½±è¢­+', damage: 10, combo: true, description: 'é€ æˆ10ç‚¹ä¼¤å®³ï¼Œè¿å‡»ï¼š+4ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æ¯’åˆƒ': { name: 'æ¯’åˆƒ+', damage: 8, poison: 3, description: 'é€ æˆ8ç‚¹ä¼¤å®³å¹¶æ–½åŠ 3å±‚æ¯’ç´ ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å‰²è£‚': { name: 'å‰²è£‚+', damage: 8, bleed: 5, description: 'é€ æˆ8ç‚¹ä¼¤å®³å¹¶æ–½åŠ 5å±‚æµè¡€ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'è‡´å‘½ä¸€å‡»': { name: 'è‡´å‘½ä¸€å‡»+', damage: 15, crit_bonus: 0.4, description: 'é€ æˆ15ç‚¹ä¼¤å®³ï¼Œ40%å‡ ç‡é€ æˆåŒå€ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç©¿åˆº': { name: 'ç©¿åˆº+', damage: 13, pierce: true, description: 'é€ æˆ13ç‚¹ä¼¤å®³ï¼Œæ— è§†æŠ¤ç›¾ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æš—æ€': { name: 'æš—æ€+', damage: 25, stealth_bonus: true, description: 'é€ æˆ25ç‚¹ä¼¤å®³ï¼Œæ½œè¡Œæ—¶ä¼¤å®³ç¿»å€ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // ç‰§å¸ˆå¡ç‰Œ
            'å¿ƒçµä¹‹ç«': { name: 'å¿ƒçµä¹‹ç«+', damage: 8, holy: true, description: 'é€ æˆ8ç‚¹ç¥åœ£ä¼¤å®³ï¼Œæ ¹æ®å·²æ¢å¤çš„ç”Ÿå‘½å€¼é¢å¤–+1ä¼¤å®³/æ¯8ç‚¹ç”Ÿå‘½æ¢å¤ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç¥åœ£ä¹‹å…‰': { name: 'ç¥åœ£ä¹‹å…‰+', cost: 1, heal: 7, damage: 3, holy: true, description: 'æ¢å¤7ç‚¹ç”Ÿå‘½å€¼å¹¶é€ æˆ3ç‚¹ç¥åœ£ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'æ²»ç–—æœ¯': { name: 'æ²»ç–—æœ¯+', cost: 2, heal: 11, damage: 4, holy: true, description: 'æ¢å¤11ç‚¹ç”Ÿå‘½å€¼å¹¶é€ æˆ4ç‚¹ç¥åœ£ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å‡€åŒ–': { name: 'å‡€åŒ–+', cost: 1, cleanse: true, damage: 3, holy: true, description: 'ç§»é™¤è‡ªèº«æ‰€æœ‰è´Ÿé¢æ•ˆæœå¹¶é€ æˆ3ç‚¹ç¥åœ£ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ä¿¡ä»°ä¹‹åŠ›': { name: 'ä¿¡ä»°ä¹‹åŠ›+', cost: 2, buff: 'faith', stacks: 3, damage: 4, holy: true, description: 'è·å¾—3å±‚ä¿¡ä»°ï¼ˆæ¯å±‚+1æ²»ç–—æ•ˆæœï¼‰å¹¶é€ æˆ4ç‚¹ç¥åœ£ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'ç¥åœ£æ–°æ˜Ÿ': { name: 'ç¥åœ£æ–°æ˜Ÿ+', cost: 3, aoe: true, damage: 9, holy: true, heal: 7, description: 'å¯¹æ‰€æœ‰æ•Œäººé€ æˆ9ç‚¹ç¥åœ£ä¼¤å®³å¹¶æ¢å¤7ç‚¹ç”Ÿå‘½å€¼ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            
            // æœ¯å£«å¡ç‰Œ
            'æš—å½±ç®­': { name: 'æš—å½±ç®­+', damage: 10, shadow: true, description: 'é€ æˆ10ç‚¹æš—å½±ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'è…èš€æœ¯': { name: 'è…èš€æœ¯+', damage: 6, dot: 4, shadow: true, description: 'é€ æˆ6ç‚¹æš—å½±ä¼¤å®³å¹¶æ¯å›åˆé€ æˆ4ç‚¹ä¼¤å®³ï¼ŒæŒç»­3å›åˆï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'å¸å–çµé­‚': { name: 'å¸å–çµé­‚+', damage: 10, lifesteal: true, shadow: true, description: 'é€ æˆ10ç‚¹æš—å½±ä¼¤å®³å¹¶æ¢å¤8ç‚¹ç”Ÿå‘½å€¼ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'çŒ®ç¥­': { name: 'çŒ®ç¥­+', damage: 13, fire: true, description: 'é€ æˆ13ç‚¹ç«ç„°ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'åœ°ç‹±ç«': { name: 'åœ°ç‹±ç«+', damage: 18, fire: true, aoe: true, self_damage: 8, description: 'å¯¹æ‰€æœ‰æ•Œäººé€ æˆ18ç‚¹ç«ç„°ä¼¤å®³ï¼Œå¯¹è‡ªå·±é€ æˆ8ç‚¹ä¼¤å®³ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' },
            'çµé­‚æ”¶å‰²': { name: 'çµé­‚æ”¶å‰²+', damage: 15, execute: 0.3, shadow: true, description: 'é€ æˆ15ç‚¹æš—å½±ä¼¤å®³ï¼Œæ•Œäººè¡€é‡ä½äº30%æ—¶ä¼¤å®³ç¿»å€ï¼ˆå¼ºåŒ–ç‰ˆï¼‰' }
        };

        // å®ˆå…³BOSSæ•°æ®
        const bosses = {
            5: {
                name: 'æš—å½±é¾™ç‹',
                icon: 'ğŸ²',
                maxHp: 200,
                attack: 18,
                phases: [
                    {
                        name: 'è§‰é†’é˜¶æ®µ',
                        hpThreshold: 1.0,
                        abilities: ['shadow_breath', 'wing_attack'],
                        description: 'æš—å½±é¾™ç‹è‹é†’ï¼Œä½¿ç”¨åŸºç¡€æ”»å‡»'
                    },
                    {
                        name: 'æ„¤æ€’é˜¶æ®µ',
                        hpThreshold: 0.7,
                        abilities: ['shadow_breath', 'wing_attack', 'shadow_clone', 'curse_aura'],
                        description: 'æš—å½±é¾™ç‹æ„¤æ€’ï¼Œå¬å”¤æš—å½±åˆ†èº«å¹¶é‡Šæ”¾è¯…å’’å…‰ç¯'
                    },
                    {
                        name: 'ç»æœ›é˜¶æ®µ',
                        hpThreshold: 0.3,
                        abilities: ['shadow_breath', 'reality_tear', 'time_distortion', 'final_judgment'],
                        description: 'æš—å½±é¾™ç‹æ¿’æ­»ï¼Œæ‰­æ›²ç°å®å¹¶å‡†å¤‡æœ€ç»ˆå®¡åˆ¤'
                    }
                ],
                rewards: ['æš—å½±æ”¯é…', 'é¾™ç‹ä¹‹æ€’', 'æ—¶ç©ºæ‰­æ›²']
            },
            10: {
                name: 'å…ƒç´ é¢†ä¸»',
                icon: 'ğŸŒŸ',
                maxHp: 300,
                attack: 22,
                phases: [
                    {
                        name: 'ç«ç„°å½¢æ€',
                        hpThreshold: 1.0,
                        abilities: ['meteor_strike', 'fire_aura', 'burn_field'],
                        description: 'å…ƒç´ é¢†ä¸»ä»¥ç«ç„°å½¢æ€å‡ºç°ï¼Œç‡ƒçƒ§ä¸€åˆ‡'
                    },
                    {
                        name: 'å†°éœœå½¢æ€',
                        hpThreshold: 0.6,
                        abilities: ['blizzard', 'ice_prison', 'freeze_time'],
                        description: 'å…ƒç´ é¢†ä¸»è½¬æ¢ä¸ºå†°éœœå½¢æ€ï¼Œå†°å†»æˆ˜åœº'
                    },
                    {
                        name: 'é›·ç”µå½¢æ€',
                        hpThreshold: 0.3,
                        abilities: ['chain_lightning', 'thunder_storm', 'energy_overload'],
                        description: 'å…ƒç´ é¢†ä¸»æœ€ç»ˆå½¢æ€ï¼Œé›·ç”µæ¯ç­ä¸€åˆ‡'
                    }
                ],
                rewards: ['å…ƒç´ æŒæ§', 'é£æš´ä¹‹å¿ƒ', 'æ°¸æ’å†°æ™¶']
            },
            15: {
                name: 'è™šç©ºå›ä¸»',
                icon: 'ğŸŒŒ',
                maxHp: 400,
                attack: 28,
                phases: [
                    {
                        name: 'ç‰©è´¨å½¢æ€',
                        hpThreshold: 1.0,
                        abilities: ['void_strike', 'reality_crack', 'dimension_shift'],
                        description: 'è™šç©ºå›ä¸»ä»¥ç‰©è´¨å½¢æ€é™ä¸´'
                    },
                    {
                        name: 'èƒ½é‡å½¢æ€',
                        hpThreshold: 0.5,
                        abilities: ['energy_drain', 'void_storm', 'mind_control'],
                        description: 'è™šç©ºå›ä¸»è½¬ä¸ºçº¯èƒ½é‡ä½“ï¼Œæ“æ§å¿ƒæ™º'
                    },
                    {
                        name: 'ç»ˆæå½¢æ€',
                        hpThreshold: 0.2,
                        abilities: ['reality_collapse', 'void_singularity', 'existence_erasure'],
                        description: 'è™šç©ºå›ä¸»å±•ç°çœŸæ­£åŠ›é‡ï¼Œå¨èƒç°å®æœ¬èº«'
                    }
                ],
                rewards: ['è™šç©ºæŒæ¡', 'ç°å®é‡æ„', 'å­˜åœ¨æ¹®ç­']
            },
            20: {
                name: 'åˆ›ä¸–ç¥',
                icon: 'âœ¨',
                maxHp: 500,
                attack: 35,
                phases: [
                    {
                        name: 'å®¡åˆ¤é˜¶æ®µ',
                        hpThreshold: 1.0,
                        abilities: ['divine_judgment', 'holy_light', 'blessing_curse'],
                        description: 'åˆ›ä¸–ç¥å®¡åˆ¤æŒ‘æˆ˜è€…çš„èµ„æ ¼'
                    },
                    {
                        name: 'è¯•ç‚¼é˜¶æ®µ',
                        hpThreshold: 0.6,
                        abilities: ['creation_wave', 'destruction_beam', 'time_loop'],
                        description: 'åˆ›ä¸–ç¥å±•ç°åˆ›é€ ä¸æ¯ç­çš„åŠ›é‡'
                    },
                    {
                        name: 'ç»ˆæè¯•ç‚¼',
                        hpThreshold: 0.3,
                        abilities: ['genesis_storm', 'apocalypse', 'rebirth_cycle'],
                        description: 'åˆ›ä¸–ç¥çš„æœ€ç»ˆè€ƒéªŒï¼Œç”Ÿæ­»è½®å›'
                    }
                ],
                rewards: ['åˆ›ä¸–ä¹‹åŠ›', 'ç¥åœ£å®¡åˆ¤', 'æ°¸æ’è½®å›']
            },
            25: {
                name: 'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹',
                icon: 'âš¡ğŸ‰',
                maxHp: 650,
                attack: 42,
                phases: [
                    {
                        name: 'è¿œå¤è‹é†’',
                        hpThreshold: 1.0,
                        abilities: ['primal_flame_breath', 'dragon_roar', 'scale_armor'],
                        description: 'æºåˆé­”é¾™ä»è¿œå¤æ²‰ç¡ä¸­è‹é†’ï¼Œå±•ç°å…¶å¤è€çš„åŠ›é‡'
                    },
                    {
                        name: 'å…ƒç´ èåˆ',
                        hpThreshold: 0.7,
                        abilities: ['elemental_chaos', 'reality_fracture', 'time_eclipse'],
                        description: 'æºåˆé­”é¾™èåˆå››å¤§å…ƒç´ ä¹‹åŠ›ï¼Œå¼€å§‹æ‰­æ›²ç°å®æ³•åˆ™'
                    },
                    {
                        name: 'ä¸–ç•Œæœ«æ—¥',
                        hpThreshold: 0.4,
                        abilities: ['cataclysm', 'void_absorption', 'dragon_madness'],
                        description: 'æºåˆé­”é¾™é™·å…¥ç–¯ç‹‚ï¼Œé‡Šæ”¾è¶³ä»¥æ¯ç­ä¸–ç•Œçš„åŠ›é‡'
                    },
                    {
                        name: 'æ­»äº¡è½®å›',
                        hpThreshold: 0.0,
                        abilities: ['resurrection_flame', 'eternal_agony', 'life_drain'],
                        description: 'æºåˆé­”é¾™æ­»äº¡åå¤æ´»ï¼Œè¿›å…¥ä¸æ­»çŠ¶æ€ï¼Œæ±²å–ç”Ÿå‘½èƒ½é‡'
                    },
                    {
                        name: 'ç»ˆç„‰æ—¶åˆ»',
                        hpThreshold: 0.0,
                        abilities: ['apocalypse_beam', 'primal_annihilation', 'dragon_god_form'],
                        description: 'æºåˆé­”é¾™å®Œå…¨è§‰é†’ä¸ºé¾™ç¥å½¢æ€ï¼Œå¸¦æ¥ç»ˆç„‰å®¡åˆ¤'
                    }
                ],
                rewards: ['æºåˆé¾™ç„°', 'å…ƒç´ æŒæ§è€…', 'é¾™ç¥ä¹‹æ¯']
            }
        };

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            showScreen('homeScreen');
            setupEventListeners();
        }

        // æ·»åŠ è§¦æ‘¸å’Œç‚¹å‡»äº‹ä»¶çš„è¾…åŠ©å‡½æ•°
        function addTouchAndClickEvent(element, callback) {
            if (element) {
                // ç”¨äºé˜²æ­¢åŒå‡»å’Œè§¦æ‘¸ä¸ç‚¹å‡»äº‹ä»¶çš„é‡å¤è§¦å‘
                let lastClickTime = 0;
                const DOUBLE_CLICK_TIME = 500;
                
                // è§¦æ‘¸å¼€å§‹äº‹ä»¶
                element.addEventListener('touchstart', function(e) {
                    // åªæœ‰åœ¨iOSä¸Šæ‰é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œé¿å…åœ¨å…¶ä»–è®¾å¤‡ä¸Šå‡ºç°é—®é¢˜
                    const isIOS = /iPad|iPhone|iPod/.test(navigator.platform) || 
                                 (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
                    if (isIOS) {
                        e.preventDefault();
                    }
                    
                    // è®°å½•è§¦æ‘¸å¼€å§‹ä½ç½®ï¼Œç”¨äºæ£€æµ‹æ˜¯å¦æ˜¯çœŸæ­£çš„ç‚¹å‡»
                    this.startX = e.touches[0].clientX;
                    this.startY = e.touches[0].clientY;
                });
                
                // è§¦æ‘¸ç»“æŸäº‹ä»¶ï¼ˆæ›´é€‚åˆiOSçš„ç‚¹å‡»æ£€æµ‹ï¼‰
                element.addEventListener('touchend', function(e) {
                    // åªæœ‰åœ¨iOSä¸Šæ‰é˜»æ­¢é»˜è®¤è¡Œä¸º
                    const isIOS = /iPad|iPhone|iPod/.test(navigator.platform) || 
                                 (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
                    if (isIOS) {
                        e.preventDefault();
                    }
                    
                    // æ£€æŸ¥æ˜¯å¦æ˜¯çŸ­ç‚¹å‡»ï¼ˆç§»åŠ¨è·ç¦»å¾ˆå°ï¼‰
                    const endX = e.changedTouches[0].clientX;
                    const endY = e.changedTouches[0].clientY;
                    const distance = Math.sqrt(
                        Math.pow(endX - this.startX, 2) + Math.pow(endY - this.startY, 2)
                    );
                    
                    // å¦‚æœç§»åŠ¨è·ç¦»å¾ˆå°ï¼Œè§†ä¸ºç‚¹å‡»
                    if (distance < 10) {
                        // é˜²æ­¢é‡å¤è§¦å‘
                        const now = Date.now();
                        if (now - lastClickTime > DOUBLE_CLICK_TIME) {
                            lastClickTime = now;
                            callback.call(this, e);
                        }
                    }
                });
                
                // ä¿ç•™ç‚¹å‡»äº‹ä»¶ä»¥å…¼å®¹æ¡Œé¢è®¾å¤‡
                element.addEventListener('click', function(e) {
                    // é˜²æ­¢é‡å¤è§¦å‘
                    const now = Date.now();
                    if (now - lastClickTime > DOUBLE_CLICK_TIME) {
                        lastClickTime = now;
                        callback.call(this, e);
                    }
                });
            }
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // è§’è‰²é€‰æ‹©
            // é¦–é¡µèœå•æŒ‰é’®
            addTouchAndClickEvent(document.getElementById('startButton'), () => showScreen('characterScreen'));
            addTouchAndClickEvent(document.getElementById('exitButton'), () => {
                if (confirm('ç¡®å®šè¦é€€å‡ºæ¸¸æˆå—ï¼Ÿ')) {
                    window.close();
                }
            });
            
            // è§’è‰²é€‰æ‹©
            document.querySelectorAll('.character-card').forEach(card => {
                addTouchAndClickEvent(card, () => selectCharacter(card.dataset.character));
            });

            addTouchAndClickEvent(document.getElementById('startGame'), startGame);
            addTouchAndClickEvent(document.getElementById('enterBattle'), enterBattle);
            addTouchAndClickEvent(document.getElementById('shopBtn'), openShop);
            addTouchAndClickEvent(document.getElementById('randomEventBtn'), triggerRandomEvent);
            addTouchAndClickEvent(document.getElementById('upgradeBtn'), openUpgradeScreen);
            addTouchAndClickEvent(document.getElementById('endTurn'), endTurn);
            addTouchAndClickEvent(document.getElementById('retreatBtn'), retreat);
            addTouchAndClickEvent(document.getElementById('nextLevel'), nextLevel);
            addTouchAndClickEvent(document.getElementById('continueAdventure'), continueAdventure);
            addTouchAndClickEvent(document.getElementById('backToMenu'), backToMenu);
            addTouchAndClickEvent(document.getElementById('restartGame'), restartGame);
            addTouchAndClickEvent(document.getElementById('viewAchievements'), () => showScreen('achievementScreen'));
            addTouchAndClickEvent(document.getElementById('closeAchievements'), () => showScreen('gameOverScreen'));
            addTouchAndClickEvent(document.getElementById('skipUpgrade'), () => showScreen('deckScreen'));
        }

        // é€‰æ‹©è§’è‰²
        function selectCharacter(characterType) {
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-character="${characterType}"]`).classList.add('selected');
            
            gameState.selectedCharacter = characterType;
            document.getElementById('startGame').disabled = false;
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            const character = characters[gameState.selectedCharacter];
            gameState.playerMaxHp = character.maxHp;
            gameState.playerHp = character.maxHp;
            gameState.maxEnergy = character.maxEnergy;
            gameState.energy = character.maxEnergy;
            
            // æ·»åŠ è§’è‰²è¢«åŠ¨æŠ€èƒ½
            gameState.passiveAbility = character.passive;
            gameState.spellsPlayedThisTurn = 0;
            gameState.firstCardThisTurn = true;
            gameState.demonicEnergy = 0;
            
            // æ·»åŠ åˆå§‹å¡ç‰Œ
            gameState.playerDeck = [...character.startingCards];
            
            updateUI();
            showScreen('deckScreen');
            updateDeckDisplay();
        }

        // æ›´æ–°UI
        function updateUI() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('gold').textContent = gameState.gold;
            document.getElementById('deckCount').textContent = gameState.playerDeck.length;
            
            // æ›´æ–°buffæ˜¾ç¤º
            const buffsContainer = document.getElementById('buffs');
            buffsContainer.innerHTML = '';
            gameState.buffs.forEach(buff => {
                const buffElement = document.createElement('div');
                buffElement.className = 'buff';
                buffElement.textContent = buff.name + (buff.stacks ? ` (${buff.stacks})` : '');
                buffsContainer.appendChild(buffElement);
            });
        }

        // æ›´æ–°ç‰Œç»„æ˜¾ç¤º
        function updateDeckDisplay() {
            const availableCards = document.getElementById('availableCards');
            const playerDeck = document.getElementById('playerDeck');
            
            // æ¸…ç©ºç°æœ‰å†…å®¹
            availableCards.innerHTML = '';
            playerDeck.innerHTML = '';
            
            // è·å–å½“å‰é€‰ä¸­è§’è‰²
            const currentCharacter = gameState.selectedCharacter;
            
            // ç­›é€‰å¯é€‰å¡ç‰Œ
            const availableCardNames = Object.keys(cardDatabase).filter(name => 
                (!gameState.playerDeck.includes(name) || gameState.playerDeck.filter(card => card === name).length < 3) && 
                cardDatabase[name].rarity !== 'legendary'
            );
            
            // å¯¹å¯ç”¨å¡ç‰Œè¿›è¡Œåˆ†ç±»
            const categorizedCards = {
                currentCharacter: [],
                neutral: [],
                otherClasses: {}
            };
            
            // åˆå§‹åŒ–å…¶ä»–èŒä¸šåˆ†ç±»
            const allCharacters = ['knight', 'priest', 'warlock', 'hunter', 'warrior', 'rogue', 'mage'];
            allCharacters.forEach(char => {
                categorizedCards.otherClasses[char] = [];
            });
            
            // æŒ‰è§’è‰²åˆ†ç±»å¡ç‰Œ
            availableCardNames.forEach(cardName => {
                const card = cardDatabase[cardName];
                if (card.character === currentCharacter) {
                    categorizedCards.currentCharacter.push(cardName);
                } else if (card.character === 'neutral') {
                    categorizedCards.neutral.push(cardName);
                } else if (allCharacters.includes(card.character)) {
                    categorizedCards.otherClasses[card.character].push(cardName);
                }
            });
            
            // åˆ›å»ºè§’è‰²åç§°æ˜ å°„
            const characterNames = {
                'knight': 'éª‘å£«',
                'priest': 'ç‰§å¸ˆ',
                'warlock': 'æœ¯å£«',
                'hunter': 'çŒäºº',
                'warrior': 'æˆ˜å£«',
                'rogue': 'ç›—è´¼',
                'mage': 'æ³•å¸ˆ'
            };
            
            // ä¼˜å…ˆæ˜¾ç¤ºå½“å‰è§’è‰²çš„å¡ç‰Œ
            if (categorizedCards.currentCharacter.length > 0) {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'card-category';
                
                const header = document.createElement('div');
                header.className = 'category-header current-character';
                header.textContent = `${characterNames[currentCharacter] || 'å½“å‰è§’è‰²'}`;
                categoryDiv.appendChild(header);
                
                const cardsGrid = document.createElement('div');
                cardsGrid.className = 'cards-grid';
                
                categorizedCards.currentCharacter.forEach(cardName => {
                    const cardElement = createCardElement(cardName, () => addCardToDeck(cardName));
                    cardsGrid.appendChild(cardElement);
                });
                
                categoryDiv.appendChild(cardsGrid);
                availableCards.appendChild(categoryDiv);
            }
            
            // æ˜¾ç¤ºé€šç”¨å¡ç‰Œ
            if (categorizedCards.neutral.length > 0) {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'card-category';
                
                const header = document.createElement('div');
                header.className = 'category-header';
                header.textContent = 'é€šç”¨å¡ç‰Œ';
                categoryDiv.appendChild(header);
                
                const cardsGrid = document.createElement('div');
                cardsGrid.className = 'cards-grid';
                
                categorizedCards.neutral.forEach(cardName => {
                    const cardElement = createCardElement(cardName, () => addCardToDeck(cardName));
                    cardsGrid.appendChild(cardElement);
                });
                
                categoryDiv.appendChild(cardsGrid);
                availableCards.appendChild(categoryDiv);
            }
            
            // æ˜¾ç¤ºå…¶ä»–è§’è‰²çš„å¡ç‰Œ
            allCharacters.forEach(char => {
                if (char !== currentCharacter && categorizedCards.otherClasses[char].length > 0) {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'card-category';
                    
                    const header = document.createElement('div');
                    header.className = 'category-header';
                    header.textContent = `${characterNames[char] || char}`;
                    categoryDiv.appendChild(header);
                    
                    const cardsGrid = document.createElement('div');
                    cardsGrid.className = 'cards-grid';
                    
                    categorizedCards.otherClasses[char].forEach(cardName => {
                        const cardElement = createCardElement(cardName, () => addCardToDeck(cardName));
                        cardsGrid.appendChild(cardElement);
                    });
                    
                    categoryDiv.appendChild(cardsGrid);
                    availableCards.appendChild(categoryDiv);
                }
            });
            
            // æ˜¾ç¤ºç©å®¶ç‰Œç»„
            playerDeck.innerHTML = '';
            gameState.playerDeck.forEach((cardName, index) => {
                const cardElement = createCardElement(cardName, () => removeCardFromDeck(index));
                playerDeck.appendChild(cardElement);
            });
        }

        // åˆ›å»ºå¡ç‰Œå…ƒç´ 
        function createCardElement(cardName, onClick) {
            const card = cardDatabase[cardName];
            // æ·»åŠ å®‰å…¨æ£€æŸ¥ï¼Œå¦‚æœå¡ç‰Œä¸å­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œä½¿ç”¨é»˜è®¤å€¼
            if (!card) {
                const cardElement = document.createElement('div');
                cardElement.className = 'card unknown';
                cardElement.innerHTML = `
                    <div class="card-art"></div>
                    <div class="card-name">â“ ${cardName}</div>
                    <div class="card-cost">ğŸ’ 0</div>
                    <div class="card-description">æœªçŸ¥å¡ç‰Œ</div>
                `;
                addTouchAndClickEvent(cardElement, onClick);
                return cardElement;
            }
            
            const cardElement = document.createElement('div');
            cardElement.className = `card ${card.type} rarity-${card.rarity}`;
            
            // æ·»åŠ ç¨€æœ‰åº¦æ ‡è¯†
            let rarityIcon = '';
            switch(card.rarity) {
                case 'common': rarityIcon = 'âšª'; break;
                case 'uncommon': rarityIcon = 'ğŸŸ¢'; break;
                case 'rare': rarityIcon = 'ğŸ”µ'; break;
                case 'legendary': rarityIcon = 'ğŸŒŸ'; break;
                case 'curse': rarityIcon = 'ğŸ”´'; break;
            }
            
            // æ·»åŠ è§’è‰²å›¾æ ‡
            let characterIcon = '';
            if (card.character) {
                let iconText = '';
                switch(card.character) {
                    case 'knight': iconText = 'éª‘'; break;
                    case 'priest': iconText = 'ç‰§'; break;
                    case 'warlock': iconText = 'æœ¯'; break;
                    case 'hunter': iconText = 'çŒ'; break;
                    case 'warrior': iconText = 'æˆ˜'; break;
                    case 'rogue': iconText = 'è´¼'; break;
                    case 'mage': iconText = 'æ³•'; break;
                    case 'neutral': iconText = 'é€š'; break;
                    case 'curse': iconText = 'è¯…'; break;
                    case 'legendary': iconText = 'ä¼ '; break;
                }
                characterIcon = `<div class="character-icon character-${card.character}">${iconText}</div>`;
            }
            
            cardElement.innerHTML = `
                <div class="card-art">
                    ${createStickmanArt(card.art)}
                </div>
                ${characterIcon}
                <div class="card-name">${rarityIcon} ${cardName}</div>
                <div class="card-cost">ğŸ’ ${card.cost}</div>
                <div class="card-description">${card.description}</div>
            `;
            addTouchAndClickEvent(cardElement, onClick);
            return cardElement;
        }
        
        // åˆ›å»ºç²¾ç¾æ•ŒäººåŸç”»
        function createEnemyArt(enemyName) {
            const enemyArtMap = {
                'å“¥å¸ƒæ—': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="goblinAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#8B4513;stop-opacity:0.6" />
                            <stop offset="100%" style="stop-color:#654321;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <!-- é‚ªæ¶å…‰ç¯ -->
                    <circle cx="40" cy="40" r="35" fill="url(#goblinAura)" opacity="0.7"/>
                    <!-- å“¥å¸ƒæ—å¤´éƒ¨ -->
                    <circle cx="40" cy="18" r="12" fill="#8B4513" stroke="#654321" stroke-width="2"/>
                    <!-- é‚ªæ¶çœ¼ç› -->
                    <circle cx="36" cy="15" r="2" fill="#ff0000"/>
                    <circle cx="44" cy="15" r="2" fill="#ff0000"/>
                    <circle cx="36" cy="14" r="0.8" fill="#ffffff"/>
                    <circle cx="44" cy="14" r="0.8" fill="#ffffff"/>
                    <!-- é‚ªæ¶ç¬‘å®¹ -->
                    <path d="M32 22 Q40 28 48 22" stroke="#654321" stroke-width="2" fill="none"/>
                    <polygon points="35,24 37,26 39,24" fill="#ffffff"/>
                    <polygon points="41,24 43,26 45,24" fill="#ffffff"/>
                    <!-- å°–è€³æœµ -->
                    <polygon points="28,8 32,2 36,10" fill="#654321" stroke="#4a2c17" stroke-width="1"/>
                    <polygon points="44,10 48,2 52,8" fill="#654321" stroke="#4a2c17" stroke-width="1"/>
                    <!-- èº«ä½“ -->
                    <rect x="35" y="30" width="10" height="25" fill="#8B4513" rx="3"/>
                    <!-- ç ´çƒ‚è¡£æœ -->
                    <rect x="34" y="32" width="12" height="8" fill="#654321" rx="2"/>
                    <path d="M34 40 Q40 42 46 40" stroke="#4a2c17" stroke-width="1" fill="none"/>
                    <!-- æ‰‹è‡‚ -->
                    <line x1="40" y1="35" x2="25" y2="42" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <line x1="40" y1="35" x2="55" y2="42" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <!-- æ­¦å™¨ - ç²—ç³™çš„æ£æ£’ -->
                    <rect x="20" y="38" width="8" height="2" fill="#654321" rx="1"/>
                    <circle cx="18" cy="39" r="2" fill="#4a2c17"/>
                    <circle cx="16" cy="37" r="1" fill="#654321"/>
                    <circle cx="17" cy="41" r="0.8" fill="#654321"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="40" y1="55" x2="32" y2="72" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <line x1="40" y1="55" x2="48" y2="72" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <!-- ç ´çƒ‚é´å­ -->
                    <ellipse cx="32" cy="72" rx="3" ry="2" fill="#4a2c17"/>
                    <ellipse cx="48" cy="72" rx="3" ry="2" fill="#4a2c17"/>
                </svg>`,
                'å…½äººæˆ˜å£«': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="orcAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#2F4F2F;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#1C3A1C;stop-opacity:0.2" />
                        </radialGradient>
                    </defs>
                    <!-- æˆ˜å£«å…‰ç¯ -->
                    <circle cx="40" cy="40" r="35" fill="url(#orcAura)" opacity="0.8"/>
                    <!-- å…½äººå¤´éƒ¨ -->
                    <circle cx="40" cy="18" r="14" fill="#2F4F2F" stroke="#1C3A1C" stroke-width="2"/>
                    <!-- æ„¤æ€’çœ¼ç› -->
                    <circle cx="35" cy="15" r="2.5" fill="#ff0000"/>
                    <circle cx="45" cy="15" r="2.5" fill="#ff0000"/>
                    <circle cx="35" cy="14" r="1" fill="#ffffff"/>
                    <circle cx="45" cy="14" r="1" fill="#ffffff"/>
                    <!-- ç ç‰™ -->
                    <polygon points="36,22 38,28 40,22" fill="#ffffff"/>
                    <polygon points="40,22 42,28 44,22" fill="#ffffff"/>
                    <!-- æ„¤æ€’è¡¨æƒ… -->
                    <path d="M32 24 Q40 30 48 24" stroke="#1C3A1C" stroke-width="3" fill="none"/>
                    <!-- æˆ˜äº‰æ¶‚æ–™ -->
                    <path d="M30 12 Q35 8 40 12" stroke="#8B0000" stroke-width="2" fill="none"/>
                    <path d="M40 12 Q45 8 50 12" stroke="#8B0000" stroke-width="2" fill="none"/>
                    <!-- è‚Œè‚‰èº«ä½“ -->
                    <rect x="34" y="32" width="12" height="28" fill="#2F4F2F" rx="4"/>
                    <!-- æŠ¤ç”² -->
                    <rect x="32" y="34" width="16" height="8" fill="#654321" rx="2"/>
                    <circle cx="40" cy="38" r="2" fill="#8B4513"/>
                    <!-- å¼ºå£®æ‰‹è‡‚ -->
                    <line x1="40" y1="38" x2="20" y2="45" stroke="#2F4F2F" stroke-width="5" stroke-linecap="round"/>
                    <line x1="40" y1="38" x2="60" y2="45" stroke="#2F4F2F" stroke-width="5" stroke-linecap="round"/>
                    <!-- å·¨æ–§ -->
                    <rect x="15" y="42" width="12" height="3" fill="#8B4513" rx="1"/>
                    <polygon points="12,38 18,42 18,47 12,47" fill="#C0C0C0" stroke="#999" stroke-width="1"/>
                    <polygon points="12,38 8,42 12,47" fill="#999"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="40" y1="60" x2="32" y2="75" stroke="#2F4F2F" stroke-width="5" stroke-linecap="round"/>
                    <line x1="40" y1="60" x2="48" y2="75" stroke="#2F4F2F" stroke-width="5" stroke-linecap="round"/>
                    <!-- æˆ˜é´ -->
                    <ellipse cx="32" cy="75" rx="4" ry="3" fill="#654321"/>
                    <ellipse cx="48" cy="75" rx="4" ry="3" fill="#654321"/>
                </svg>`,
                'æš—å½±åˆºå®¢': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="shadowAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#800080;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#2C2C2C;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <!-- æš—å½±é¢†åŸŸ -->
                    <circle cx="40" cy="40" r="35" fill="url(#shadowAura)" opacity="0.9"/>
                    <!-- åŠé€æ˜åˆºå®¢å¤´éƒ¨ -->
                    <circle cx="40" cy="18" r="10" fill="#2C2C2C" stroke="#800080" stroke-width="2" opacity="0.7"/>
                    <!-- å‘å…‰çœ¼ç› -->
                    <circle cx="36" cy="16" r="1.5" fill="#ff0000" opacity="1"/>
                    <circle cx="44" cy="16" r="1.5" fill="#ff0000" opacity="1"/>
                    <circle cx="36" cy="15" r="0.5" fill="#ffffff"/>
                    <circle cx="44" cy="15" r="0.5" fill="#ffffff"/>
                    <!-- é¢ç½© -->
                    <path d="M32 20 Q40 18 48 20 Q44 24 40 24 Q36 24 32 20" fill="#1a1a1a" opacity="0.8"/>
                    <!-- æš—å½±èº«ä½“ -->
                    <rect x="36" y="28" width="8" height="25" fill="#2C2C2C" rx="3" opacity="0.6"/>
                    <!-- æš—å½±è½®å»“ -->
                    <rect x="34" y="26" width="12" height="29" fill="none" stroke="#800080" stroke-width="2" stroke-dasharray="3,3" rx="4" opacity="0.8"/>
                    <!-- æš—å½±æ‰‹è‡‚ -->
                    <line x1="40" y1="35" x2="22" y2="42" stroke="#800080" stroke-width="3" stroke-linecap="round" opacity="0.8" stroke-dasharray="4,2"/>
                    <line x1="40" y1="35" x2="58" y2="42" stroke="#800080" stroke-width="3" stroke-linecap="round" opacity="0.8" stroke-dasharray="4,2"/>
                    <!-- æš—å½±åŒ•é¦– -->
                    <rect x="18" y="40" width="8" height="1.5" fill="#C0C0C0" opacity="0.9"/>
                    <polygon points="18,39 16,41 18,42" fill="#800080" opacity="0.8"/>
                    <rect x="54" y="40" width="8" height="1.5" fill="#C0C0C0" opacity="0.9"/>
                    <polygon points="62,39 64,41 62,42" fill="#800080" opacity="0.8"/>
                    <!-- æš—å½±ç²’å­ -->
                    <circle cx="25" cy="30" r="1.5" fill="#800080" opacity="0.9"/>
                    <circle cx="55" cy="35" r="1" fill="#4a0080" opacity="0.7"/>
                    <circle cx="30" cy="50" r="0.8" fill="#800080" opacity="0.8"/>
                    <circle cx="50" cy="45" r="1.2" fill="#4a0080" opacity="0.6"/>
                    <!-- æš—å½±è…¿éƒ¨ -->
                    <line x1="40" y1="53" x2="34" y2="70" stroke="#800080" stroke-width="3" stroke-linecap="round" opacity="0.6" stroke-dasharray="3,3"/>
                    <line x1="40" y1="53" x2="46" y2="70" stroke="#800080" stroke-width="3" stroke-linecap="round" opacity="0.6" stroke-dasharray="3,3"/>
                </svg>`,
                'çŸ³å¤´å·¨äºº': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <linearGradient id="stoneGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#999999" />
                            <stop offset="50%" style="stop-color:#696969" />
                            <stop offset="100%" style="stop-color:#2F4F4F" />
                        </linearGradient>
                    </defs>
                    <!-- çŸ³å¤´å…‰ç¯ -->
                    <circle cx="40" cy="40" r="35" fill="#696969" opacity="0.3"/>
                    <!-- å·¨å¤§å¤´éƒ¨ -->
                    <rect x="28" y="8" width="24" height="20" fill="url(#stoneGrad)" stroke="#2F4F4F" stroke-width="2" rx="4"/>
                    <!-- å‘å…‰çœ¼ç› -->
                    <circle cx="34" cy="16" r="3" fill="#FF4500"/>
                    <circle cx="46" cy="16" r="3" fill="#FF4500"/>
                    <circle cx="34" cy="15" r="1" fill="#ffff00"/>
                    <circle cx="46" cy="15" r="1" fill="#ffff00"/>
                    <!-- çŸ³å¤´çº¹ç† -->
                    <rect x="30" y="22" width="20" height="3" fill="#2F4F4F" rx="1"/>
                    <circle cx="32" cy="12" r="1" fill="#8B4513"/>
                    <circle cx="48" cy="20" r="1.5" fill="#8B4513"/>
                    <circle cx="40" cy="25" r="1" fill="#8B4513"/>
                    <!-- å·¨å¤§èº«ä½“ -->
                    <rect x="25" y="28" width="30" height="28" fill="url(#stoneGrad)" stroke="#2F4F4F" stroke-width="2" rx="3"/>
                    <!-- èƒ¸ç”²ç»†èŠ‚ -->
                    <rect x="27" y="32" width="26" height="6" fill="#2F4F4F" rx="2"/>
                    <circle cx="40" cy="35" r="2" fill="#8B4513"/>
                    <!-- å·¨å¤§æ‰‹è‡‚ -->
                    <rect x="12" y="32" width="13" height="20" fill="url(#stoneGrad)" stroke="#2F4F4F" stroke-width="2" rx="3"/>
                    <rect x="55" y="32" width="13" height="20" fill="url(#stoneGrad)" stroke="#2F4F4F" stroke-width="2" rx="3"/>
                    <!-- æ‰‹éƒ¨ -->
                    <circle cx="18" cy="52" r="4" fill="#696969" stroke="#2F4F4F" stroke-width="1"/>
                    <circle cx="61" cy="52" r="4" fill="#696969" stroke="#2F4F4F" stroke-width="1"/>
                    <!-- å·¨å¤§è…¿éƒ¨ -->
                    <rect x="30" y="56" width="8" height="18" fill="url(#stoneGrad)" stroke="#2F4F4F" stroke-width="2"/>
                    <rect x="42" y="56" width="8" height="18" fill="url(#stoneGrad)" stroke="#2F4F4F" stroke-width="2"/>
                    <!-- çŸ³å¤´é´ -->
                    <ellipse cx="34" cy="74" rx="5" ry="3" fill="#2F4F4F"/>
                    <ellipse cx="46" cy="74" rx="5" ry="3" fill="#2F4F4F"/>
                </svg>`,
                'ç«ç„°æ¶é­”': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="fireAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#ff6600;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#ff0000;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#8B0000;stop-opacity:0.2" />
                        </radialGradient>
                    </defs>
                    <!-- ç«ç„°å…‰ç¯ -->
                    <circle cx="40" cy="40" r="35" fill="url(#fireAura)" opacity="0.9"/>
                    <!-- æ¶é­”å¤´éƒ¨ -->
                    <circle cx="40" cy="18" r="13" fill="#8B0000" stroke="#FF0000" stroke-width="2"/>
                    <!-- ç«ç„°çœ¼ç› -->
                    <circle cx="35" cy="15" r="2.5" fill="#FF4500"/>
                    <circle cx="45" cy="15" r="2.5" fill="#FF4500"/>
                    <circle cx="35" cy="14" r="1" fill="#ffff00"/>
                    <circle cx="45" cy="14" r="1" fill="#ffff00"/>
                    <!-- æ¶é­”è§’ -->
                    <polygon points="30,5 34,0 38,8" fill="#FF4500" stroke="#ff0000" stroke-width="1"/>
                    <polygon points="42,8 46,0 50,5" fill="#FF4500" stroke="#ff0000" stroke-width="1"/>
                    <!-- é‚ªæ¶ç¬‘å®¹ -->
                    <path d="M30 24 Q40 30 50 24" stroke="#FF0000" stroke-width="3" fill="none"/>
                    <polygon points="33,26 35,29 37,26" fill="#ffffff"/>
                    <polygon points="43,26 45,29 47,26" fill="#ffffff"/>
                    <!-- ç«ç„°èº«ä½“ -->
                    <rect x="33" y="31" width="14" height="25" fill="#8B0000" rx="4"/>
                    <!-- ç«ç„°çº¹ç† -->
                    <path d="M35 33 Q40 30 45 33 Q40 36 35 33" fill="#FF4500" opacity="0.8"/>
                    <path d="M36 40 Q40 37 44 40 Q40 43 36 40" fill="#ff6600" opacity="0.7"/>
                    <!-- ç«ç„°æ‰‹è‡‚ -->
                    <line x1="40" y1="38" x2="20" y2="48" stroke="#8B0000" stroke-width="4" stroke-linecap="round"/>
                    <line x1="40" y1="38" x2="60" y2="48" stroke="#8B0000" stroke-width="4" stroke-linecap="round"/>
                    <!-- ç«ç„°æ•ˆæœ -->
                    <circle cx="25" cy="35" r="3" fill="#FF4500" opacity="0.9"/>
                    <circle cx="23" cy="32" r="2" fill="#ff6600" opacity="0.8"/>
                    <circle cx="27" cy="38" r="1.5" fill="#ffff00" opacity="0.7"/>
                    <circle cx="55" cy="38" r="3" fill="#FF4500" opacity="0.9"/>
                    <circle cx="57" cy="35" r="2" fill="#ff6600" opacity="0.8"/>
                    <circle cx="53" cy="41" r="1.5" fill="#ffff00" opacity="0.7"/>
                    <!-- ç«ç„°è…¿éƒ¨ -->
                    <line x1="40" y1="56" x2="32" y2="72" stroke="#8B0000" stroke-width="4" stroke-linecap="round"/>
                    <line x1="40" y1="56" x2="48" y2="72" stroke="#8B0000" stroke-width="4" stroke-linecap="round"/>
                    <!-- ç«ç„°è¶³è¿¹ -->
                    <ellipse cx="32" cy="72" rx="4" ry="2" fill="#FF4500" opacity="0.8"/>
                    <ellipse cx="48" cy="72" rx="4" ry="2" fill="#FF4500" opacity="0.8"/>
                </svg>`
            };
            
            // æ·»åŠ BOSSåŸç”»
            const bossArtMap = {
                'æš—å½±é¾™ç‹': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="dragonAura" cx="50%" cy="50%" r="70%">
                            <stop offset="0%" style="stop-color:#800080;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#4a0080;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#2c2c2c;stop-opacity:0.3" />
                        </radialGradient>
                        <linearGradient id="dragonScale" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#4a0080" />
                            <stop offset="50%" style="stop-color:#800080" />
                            <stop offset="100%" style="stop-color:#2c2c2c" />
                        </linearGradient>
                    </defs>
                    <!-- æš—å½±é¢†åŸŸ -->
                    <circle cx="40" cy="40" r="38" fill="url(#dragonAura)" opacity="0.9"/>
                    <!-- é¾™å¤´ -->
                    <ellipse cx="40" cy="20" rx="18" ry="12" fill="url(#dragonScale)" stroke="#800080" stroke-width="2"/>
                    <!-- é¾™çœ¼ -->
                    <circle cx="32" cy="18" r="3" fill="#ff0000"/>
                    <circle cx="48" cy="18" r="3" fill="#ff0000"/>
                    <circle cx="32" cy="17" r="1" fill="#ffffff"/>
                    <circle cx="48" cy="17" r="1" fill="#ffffff"/>
                    <!-- é¾™è§’ -->
                    <polygon points="25,8 30,2 35,12" fill="#4a0080" stroke="#800080" stroke-width="1"/>
                    <polygon points="45,12 50,2 55,8" fill="#4a0080" stroke="#800080" stroke-width="1"/>
                    <!-- é¾™å˜´ -->
                    <path d="M22 25 Q40 35 58 25" stroke="#800080" stroke-width="3" fill="none"/>
                    <polygon points="35,28 40,32 45,28" fill="#ff0000"/>
                    <!-- é¾™èº« -->
                    <ellipse cx="40" cy="45" rx="20" ry="15" fill="url(#dragonScale)" stroke="#800080" stroke-width="2"/>
                    <!-- é¾™é³çº¹ç† -->
                    <circle cx="30" cy="40" r="2" fill="#800080" opacity="0.7"/>
                    <circle cx="50" cy="42" r="2" fill="#800080" opacity="0.7"/>
                    <circle cx="40" cy="48" r="2" fill="#800080" opacity="0.7"/>
                    <circle cx="35" cy="52" r="1.5" fill="#4a0080" opacity="0.8"/>
                    <circle cx="45" cy="50" r="1.5" fill="#4a0080" opacity="0.8"/>
                    <!-- é¾™ç¿¼ -->
                    <path d="M15 35 Q5 25 15 15 Q25 25 20 40" fill="#2c2c2c" stroke="#800080" stroke-width="2" opacity="0.8"/>
                    <path d="M65 35 Q75 25 65 15 Q55 25 60 40" fill="#2c2c2c" stroke="#800080" stroke-width="2" opacity="0.8"/>
                    <!-- æš—å½±æ•ˆæœ -->
                    <circle cx="20" cy="30" r="3" fill="#800080" opacity="0.6"/>
                    <circle cx="60" cy="35" r="2.5" fill="#4a0080" opacity="0.7"/>
                    <circle cx="40" cy="65" r="4" fill="#2c2c2c" opacity="0.5"/>
                    <!-- é¾™å°¾ -->
                    <path d="M40 60 Q30 70 40 75 Q50 70 40 60" fill="url(#dragonScale)" stroke="#800080" stroke-width="1"/>
                </svg>`,
                'å…ƒç´ é¢†ä¸»': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="elementalAura" cx="50%" cy="50%" r="70%">
                            <stop offset="0%" style="stop-color:#ffff00;stop-opacity:1" />
                            <stop offset="30%" style="stop-color:#ff6600;stop-opacity:0.8" />
                            <stop offset="60%" style="stop-color:#0066ff;stop-opacity:0.6" />
                            <stop offset="100%" style="stop-color:#00ff00;stop-opacity:0.3" />
                        </radialGradient>
                    </defs>
                    <!-- å…ƒç´ å…‰ç¯ -->
                    <circle cx="40" cy="40" r="38" fill="url(#elementalAura)" opacity="0.9"/>
                    <!-- å…ƒç´ æ ¸å¿ƒ -->
                    <circle cx="40" cy="40" r="15" fill="#ffffff" stroke="#ffff00" stroke-width="3"/>
                    <circle cx="40" cy="40" r="10" fill="#ffff00" opacity="0.8"/>
                    <circle cx="40" cy="40" r="5" fill="#ffffff"/>
                    <!-- ç«ç„°å…ƒç´  -->
                    <circle cx="25" cy="25" r="6" fill="#ff6600" opacity="0.9"/>
                    <circle cx="23" cy="23" r="3" fill="#ffff00" opacity="0.8"/>
                    <path d="M20 20 Q25 15 30 20 Q25 25 20 20" fill="#ff0000" opacity="0.7"/>
                    <!-- å†°éœœå…ƒç´  -->
                    <polygon points="55,20 60,25 55,30 50,25" fill="#00bfff" opacity="0.9"/>
                    <polygon points="53,22 57,25 53,28 49,25" fill="#ffffff" opacity="0.8"/>
                    <circle cx="55" cy="25" r="2" fill="#87ceeb" opacity="0.7"/>
                    <!-- é›·ç”µå…ƒç´  -->
                    <path d="M20 55 L25 65 L23 65 L28 75 L25 70 L22 70 L20 55" fill="#ffff00" opacity="0.9"/>
                    <path d="M18 57 Q22 52 26 57" stroke="#ffffff" stroke-width="2" fill="none" opacity="0.8"/>
                    <!-- è‡ªç„¶å…ƒç´  -->
                    <circle cx="60" cy="60" r="5" fill="#00ff00" opacity="0.9"/>
                    <circle cx="58" cy="58" r="2" fill="#90ee90" opacity="0.8"/>
                    <circle cx="62" cy="62" r="1.5" fill="#32cd32" opacity="0.7"/>
                    <!-- å…ƒç´ çœ¼ç› -->
                    <circle cx="35" cy="35" r="2" fill="#ffffff"/>
                    <circle cx="45" cy="35" r="2" fill="#ffffff"/>
                    <circle cx="35" cy="34" r="1" fill="#ffff00"/>
                    <circle cx="45" cy="34" r="1" fill="#ffff00"/>
                    <!-- å…ƒç´ è½¨é“ -->
                    <circle cx="40" cy="40" r="25" fill="none" stroke="#ffff00" stroke-width="2" opacity="0.6" stroke-dasharray="5,5"/>
                    <circle cx="40" cy="40" r="30" fill="none" stroke="#ff6600" stroke-width="1.5" opacity="0.5" stroke-dasharray="3,3"/>
                    <circle cx="40" cy="40" r="35" fill="none" stroke="#0066ff" stroke-width="1" opacity="0.4" stroke-dasharray="2,2"/>
                </svg>`,
                'è™šç©ºå›ä¸»': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="voidAura" cx="50%" cy="50%" r="70%">
                            <stop offset="0%" style="stop-color:#000000;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#4a0080;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#800080;stop-opacity:0.3" />
                        </radialGradient>
                    </defs>
                    <!-- è™šç©ºé¢†åŸŸ -->
                    <circle cx="40" cy="40" r="38" fill="url(#voidAura)" opacity="0.95"/>
                    <!-- è™šç©ºè£‚ç¼ -->
                    <path d="M10 10 Q40 20 70 10 Q40 30 10 10" fill="none" stroke="#800080" stroke-width="3" opacity="0.8"/>
                    <path d="M10 70 Q40 60 70 70 Q40 50 10 70" fill="none" stroke="#800080" stroke-width="3" opacity="0.8"/>
                    <path d="M10 40 Q20 20 40 40 Q60 20 70 40" fill="none" stroke="#4a0080" stroke-width="2" opacity="0.7"/>
                    <!-- è™šç©ºæ ¸å¿ƒ -->
                    <circle cx="40" cy="40" r="12" fill="#000000" stroke="#800080" stroke-width="3"/>
                    <circle cx="40" cy="40" r="8" fill="#4a0080" opacity="0.8"/>
                    <circle cx="40" cy="40" r="4" fill="#800080" opacity="0.6"/>
                    <circle cx="40" cy="40" r="2" fill="#ffffff"/>
                    <!-- è™šç©ºçœ¼ç› -->
                    <circle cx="35" cy="35" r="3" fill="#800080"/>
                    <circle cx="45" cy="35" r="3" fill="#800080"/>
                    <circle cx="35" cy="34" r="1.5" fill="#ffffff"/>
                    <circle cx="45" cy="34" r="1.5" fill="#ffffff"/>
                    <!-- è™šç©ºè§¦æ‰‹ -->
                    <path d="M25 50 Q15 60 25 70 Q35 60 25 50" fill="#4a0080" opacity="0.7"/>
                    <path d="M55 50 Q65 60 55 70 Q45 60 55 50" fill="#4a0080" opacity="0.7"/>
                    <path d="M40 55 Q30 65 40 75 Q50 65 40 55" fill="#4a0080" opacity="0.7"/>
                    <!-- è™šç©ºç²’å­ -->
                    <circle cx="20" cy="20" r="1.5" fill="#800080" opacity="0.9"/>
                    <circle cx="60" cy="25" r="1" fill="#4a0080" opacity="0.8"/>
                    <circle cx="15" cy="60" r="1.2" fill="#800080" opacity="0.7"/>
                    <circle cx="65" cy="55" r="0.8" fill="#4a0080" opacity="0.9"/>
                    <circle cx="25" cy="35" r="1" fill="#800080" opacity="0.6"/>
                    <circle cx="55" cy="45" r="1.3" fill="#4a0080" opacity="0.8"/>
                    <!-- ç°å®æ‰­æ›²æ•ˆæœ -->
                    <path d="M5 40 Q20 30 35 40 Q50 50 65 40 Q50 30 35 40 Q20 50 5 40" fill="none" stroke="#800080" stroke-width="1.5" opacity="0.5" stroke-dasharray="4,4"/>
                </svg>`,
                'åˆ›ä¸–ç¥': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <radialGradient id="divineAura" cx="50%" cy="50%" r="70%">
                            <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
                            <stop offset="30%" style="stop-color:#ffd700;stop-opacity:0.9" />
                            <stop offset="60%" style="stop-color:#ffb347;stop-opacity:0.7" />
                            <stop offset="100%" style="stop-color:#ff8c00;stop-opacity:0.3" />
                        </radialGradient>
                    </defs>
                    <!-- ç¥åœ£å…‰ç¯ -->
                    <circle cx="40" cy="40" r="38" fill="url(#divineAura)" opacity="0.95"/>
                    <!-- ç¥åœ£å…‰èŠ’ -->
                    <line x1="40" y1="5" x2="40" y2="15" stroke="#ffffff" stroke-width="3" opacity="0.9"/>
                    <line x1="40" y1="65" x2="40" y2="75" stroke="#ffffff" stroke-width="3" opacity="0.9"/>
                    <line x1="5" y1="40" x2="15" y2="40" stroke="#ffffff" stroke-width="3" opacity="0.9"/>
                    <line x1="65" y1="40" x2="75" y2="40" stroke="#ffffff" stroke-width="3" opacity="0.9"/>
                    <line x1="15" y1="15" x2="22" y2="22" stroke="#ffd700" stroke-width="2" opacity="0.8"/>
                    <line x1="58" y1="22" x2="65" y2="15" stroke="#ffd700" stroke-width="2" opacity="0.8"/>
                    <line x1="15" y1="65" x2="22" y2="58" stroke="#ffd700" stroke-width="2" opacity="0.8"/>
                    <line x1="58" y1="58" x2="65" y2="65" stroke="#ffd700" stroke-width="2" opacity="0.8"/>
                    <!-- ç¥åœ£å¤´éƒ¨ -->
                    <circle cx="40" cy="25" r="12" fill="#ffffff" stroke="#ffd700" stroke-width="2"/>
                    <!-- ç¥åœ£çœ¼ç› -->
                    <circle cx="35" cy="22" r="2.5" fill="#ffd700"/>
                    <circle cx="45" cy="22" r="2.5" fill="#ffd700"/>
                    <circle cx="35" cy="21" r="1" fill="#ffffff"/>
                    <circle cx="45" cy="21" r="1" fill="#ffffff"/>
                    <!-- ç¥åœ£å…‰ç¯å¤´é¥° -->
                    <circle cx="40" cy="25" r="18" fill="none" stroke="#ffd700" stroke-width="2" opacity="0.7"/>
                    <circle cx="40" cy="25" r="15" fill="none" stroke="#ffb347" stroke-width="1.5" opacity="0.6"/>
                    <!-- ç¥åœ£èº«ä½“ -->
                    <rect x="32" y="37" width="16" height="25" fill="#ffffff" stroke="#ffd700" stroke-width="2" rx="5"/>
                    <!-- ç¥åœ£çº¹é¥° -->
                    <circle cx="40" cy="45" r="4" fill="#ffd700" opacity="0.8"/>
                    <circle cx="40" cy="45" r="2" fill="#ffffff"/>
                    <path d="M35 50 Q40 47 45 50" stroke="#ffd700" stroke-width="2" fill="none"/>
                    <path d="M35 55 Q40 52 45 55" stroke="#ffb347" stroke-width="1.5" fill="none"/>
                    <!-- ç¥åœ£ç¿…è†€ -->
                    <path d="M20 40 Q10 30 20 20 Q30 30 25 45" fill="#ffffff" stroke="#ffd700" stroke-width="1.5" opacity="0.9"/>
                    <path d="M60 40 Q70 30 60 20 Q50 30 55 45" fill="#ffffff" stroke="#ffd700" stroke-width="1.5" opacity="0.9"/>
                    <!-- ç¿…è†€ç¾½æ¯›ç»†èŠ‚ -->
                    <path d="M22 25 Q18 22 22 20" stroke="#ffd700" stroke-width="1" fill="none"/>
                    <path d="M24 30 Q20 27 24 25" stroke="#ffd700" stroke-width="1" fill="none"/>
                    <path d="M58 25 Q62 22 58 20" stroke="#ffd700" stroke-width="1" fill="none"/>
                    <path d="M56 30 Q60 27 56 25" stroke="#ffd700" stroke-width="1" fill="none"/>
                    <!-- ç¥åœ£èƒ½é‡ -->
                    <circle cx="25" cy="35" r="2" fill="#ffd700" opacity="0.8"/>
                    <circle cx="55" cy="35" r="2" fill="#ffd700" opacity="0.8"/>
                    <circle cx="30" cy="60" r="1.5" fill="#ffb347" opacity="0.7"/>
                    <circle cx="50" cy="60" r="1.5" fill="#ffb347" opacity="0.7"/>
                </svg>`,
                'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹': `<svg class="enemy-art" viewBox="0 0 80 80">
                    <defs>
                        <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#1a1a2e" />
                            <stop offset="100%" stop-color="#16213e" />
                        </linearGradient>
                        <radialGradient id="glowGradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                            <stop offset="0%" stop-color="#ff5252" stop-opacity="0.8" />
                            <stop offset="100%" stop-color="#ff5252" stop-opacity="0" />
                        </radialGradient>
                    </defs>
                    <!-- å‘å…‰æ•ˆæœ -->
                    <circle cx="40" cy="40" r="38" fill="url(#glowGradient)" opacity="0.7" />
                    
                    <!-- é¾™çš„èº«ä½“ -->
                    <g>
                        <!-- é¾™çš„ä¸»ä½“ -->
                        <path d="M40,30 C35,25 30,28 25,26 C20,24 18,20 18,16 C18,12 22,10 26,12 C30,14 32,18 35,17 C38,16 40,14 42,13 C44,12 46,13 48,15 C50,17 52,20 54,23 C56,26 58,30 60,34 C62,38 64,43 62,47 C60,51 55,54 50,55 C45,56 40,55 35,53 C30,51 27,47 25,43 C23,39 22,34 24,30 C26,26 30,24 35,25 C40,26 45,28 40,30 Z" 
                              fill="#2c3e50" stroke="#e74c3c" stroke-width="2" />
                        
                        <!-- é¾™çš„è„–å­å’Œå¤´éƒ¨ -->
                        <path d="M40,30 C42,29 45,28 48,27 C51,26 54,25 57,24 C60,23 63,23 65,24 C67,25 68,27 67,29 C66,31 64,33 62,34" 
                              fill="#2c3e50" stroke="#e74c3c" stroke-width="2" />
                        
                        <!-- å¤´éƒ¨ç»†èŠ‚ -->
                        <path d="M67,29 C68,30 69,31 69,32 C69,33 68,34 67,34 C66,34 65,33 65,32 C65,31 66,30 67,29 Z" 
                              fill="#34495e" stroke="#e74c3c" stroke-width="1" />
                        
                        <!-- çœ¼ç› - çº¢è‰²å‘å…‰çœ¼ç› -->
                        <circle cx="65" cy="28" r="1.5" fill="#2c3e50" />
                        <circle cx="65" cy="28" r="0.8" fill="#e74c3c" />
                        <circle cx="65" cy="28" r="0.3" fill="white" />
                        <circle cx="65" cy="28" r="2.5" fill="none" stroke="#e74c3c" stroke-width="0.5" opacity="0.5" />
                        
                        <!-- é¾™è§’ -->
                        <path d="M66,24 C67,21 69,19 68,17" stroke="#e74c3c" stroke-width="0.8" fill="none" />
                        <path d="M64,24 C63,21 61,19 62,17" stroke="#e74c3c" stroke-width="0.8" fill="none" />
                        
                        <!-- é¾™çš„ç¿…è†€ -->
                        <path d="M40,30 C38,28 35,26 32,24 C29,22 26,23 24,25 C22,27 21,29 22,31 C23,33 25,35 28,36" 
                              fill="#1a1a2e" stroke="#e74c3c" stroke-width="0.8" />
                        
                        <!-- ç¿…è†€ç»†èŠ‚ -->
                        <path d="M32,24 C30,27 27,30 25,33" stroke="#e74c3c" stroke-width="0.5" fill="none" />
                        <path d="M29,22 C27,25 25,28 23,31" stroke="#e74c3c" stroke-width="0.5" fill="none" />
                        
                        <!-- é¾™çš„å°¾å·´ -->
                        <path d="M25,43 C23,45 22,47 21,49 C20,51 19,53 20,55 C21,57 23,58 25,57" 
                              stroke="#e74c3c" stroke-width="0.8" fill="none" />
                        
                        <!-- çˆªå­ -->
                        <path d="M40,30 C41,32 42,34 41,36" stroke="#e74c3c" stroke-width="0.8" fill="none" />
                        <path d="M41,36 C40.5,37 40,37 39.5,36" stroke="#e74c3c" stroke-width="0.5" fill="none" />
                        
                        <path d="M45,35 C46,37 47,39 46,41" stroke="#e74c3c" stroke-width="0.8" fill="none" />
                        <path d="M46,41 C45.5,42 45,42 44.5,41" stroke="#e74c3c" stroke-width="0.5" fill="none" />
                        
                        <!-- è…¹éƒ¨ -->
                        <path d="M35,30 C36,31 38,31 40,30 C42,29 44,29 45,30 C46,31 48,31 50,30 C52,29 54,29 56,30 C58,31 60,32 62,34" 
                              stroke="#e74c3c" stroke-width="0.5" fill="none" opacity="0.5" />
                        
                        <!-- èƒ½é‡æ•ˆæœ -->
                        <path d="M67,29 C69,32 71,36 69,40 C67,44 63,48 62,47" 
                              stroke="#e74c3c" stroke-width="0.5" stroke-dasharray="1,1" fill="none" opacity="0.7" />
                    </g>
                </svg>`
            };
            
            // åˆå¹¶æ‰€æœ‰æ•ŒäººåŸç”»
            const allEnemyArt = { ...enemyArtMap, ...bossArtMap };
            
            return allEnemyArt[enemyName] || allEnemyArt['å“¥å¸ƒæ—'];
        }
        
        // åˆ›å»ºç²¾ç¾å¡ç‰ŒåŸç”»
        function createStickmanArt(artType) {
            const artMap = {
                'sword-strike': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="swordGlow" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" style="stop-color:#ffff00;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#ff6600;stop-opacity:0.2" />
                        </radialGradient>
                        <linearGradient id="swordBlade" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#e6e6e6" />
                            <stop offset="50%" style="stop-color:#ffffff" />
                            <stop offset="100%" style="stop-color:#cccccc" />
                        </linearGradient>
                    </defs>
                    <!-- èƒŒæ™¯å…‰æ•ˆ -->
                    <circle cx="30" cy="30" r="25" fill="url(#swordGlow)" opacity="0.6"/>
                    <!-- æˆ˜å£«èº«ä½“ -->
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <rect x="27" y="17" width="6" height="18" fill="#8B4513" rx="2"/>
                    <!-- æŠ¤ç”²ç»†èŠ‚ -->
                    <rect x="26" y="18" width="8" height="4" fill="#C0C0C0" rx="1"/>
                    <circle cx="30" cy="20" r="1" fill="#FFD700"/>
                    <!-- æ‰‹è‡‚ -->
                    <line x1="30" y1="22" x2="18" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="42" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <!-- å‰‘æŸ„ -->
                    <rect x="15" y="26" width="2" height="8" fill="#8B4513" rx="1"/>
                    <!-- å‰‘åˆƒ -->
                    <polygon points="16,18 18,20 18,26 16,26" fill="url(#swordBlade)" stroke="#999" stroke-width="0.5"/>
                    <!-- å‰‘å…‰æ•ˆæœ -->
                    <line x1="17" y1="18" x2="17" y2="26" stroke="#ffffff" stroke-width="0.5" opacity="0.8"/>
                    <!-- æ”»å‡»è½¨è¿¹ -->
                    <path d="M 10 15 Q 20 10 25 20" stroke="#ffff00" stroke-width="2" fill="none" opacity="0.7"/>
                    <path d="M 8 17 Q 18 12 23 22" stroke="#ff6600" stroke-width="1" fill="none" opacity="0.5"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="30" y1="35" x2="25" y2="50" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="35" y2="50" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <!-- é´å­ -->
                    <ellipse cx="25" cy="50" rx="2" ry="1" fill="#654321"/>
                    <ellipse cx="35" cy="50" rx="2" ry="1" fill="#654321"/>
                </svg>`,
                'charge': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="chargeAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#ff4444;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#ffaa00;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <!-- å†²é”‹å…‰ç¯ -->
                    <circle cx="30" cy="30" r="28" fill="url(#chargeAura)" opacity="0.7"/>
                    <!-- æˆ˜å£«å¤´éƒ¨ -->
                    <circle cx="25" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <!-- æ„¤æ€’è¡¨æƒ… -->
                    <circle cx="23" cy="10" r="0.5" fill="#ff0000"/>
                    <circle cx="27" cy="10" r="0.5" fill="#ff0000"/>
                    <path d="M 22 14 Q 25 16 28 14" stroke="#8B0000" stroke-width="1" fill="none"/>
                    <!-- å†²é”‹å§¿æ€èº«ä½“ -->
                    <rect x="22" y="17" width="6" height="16" fill="#8B4513" rx="2" transform="rotate(15 25 25)"/>
                    <!-- ç›¾ç‰Œ -->
                    <ellipse cx="15" cy="20" rx="4" ry="6" fill="#C0C0C0" stroke="#999" stroke-width="1"/>
                    <circle cx="15" cy="20" r="2" fill="#FFD700"/>
                    <!-- å†²é”‹æ‰‹è‡‚ -->
                    <line x1="25" y1="20" x2="15" y2="18" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="25" y1="20" x2="40" y2="25" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <!-- æ­¦å™¨ -->
                    <rect x="38" y="22" width="8" height="2" fill="#8B4513" rx="1"/>
                    <polygon points="46,20 50,24 46,26" fill="#C0C0C0" stroke="#999" stroke-width="0.5"/>
                    <!-- é€Ÿåº¦çº¿ -->
                    <line x1="5" y1="15" x2="15" y2="17" stroke="#ffff00" stroke-width="2" opacity="0.8"/>
                    <line x1="3" y1="20" x2="13" y2="22" stroke="#ffaa00" stroke-width="1.5" opacity="0.6"/>
                    <line x1="7" y1="25" x2="17" y2="27" stroke="#ff6600" stroke-width="1" opacity="0.4"/>
                    <!-- è…¿éƒ¨å†²é”‹å§¿æ€ -->
                    <line x1="25" y1="33" x2="20" y2="48" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <line x1="25" y1="33" x2="35" y2="50" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'dagger': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <linearGradient id="rogueCloak" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#2c2c2c" />
                            <stop offset="100%" style="stop-color:#1a1a1a" />
                        </linearGradient>
                    </defs>
                    <!-- æš—å½±èƒŒæ™¯ -->
                    <circle cx="30" cy="30" r="25" fill="#000000" opacity="0.3"/>
                    <!-- ç›—è´¼å¤´éƒ¨ -->
                    <circle cx="30" cy="12" r="4" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <!-- é¢ç½© -->
                    <path d="M 26 10 Q 30 8 34 10 Q 32 14 30 14 Q 28 14 26 10" fill="#2c2c2c"/>
                    <circle cx="28" cy="11" r="0.5" fill="#ff0000"/>
                    <circle cx="32" cy="11" r="0.5" fill="#ff0000"/>
                    <!-- æ–—ç¯·èº«ä½“ -->
                    <rect x="27" y="16" width="6" height="18" fill="url(#rogueCloak)" rx="2"/>
                    <!-- åŒåŒ•é¦– -->
                    <rect x="20" y="20" width="1" height="6" fill="#8B4513"/>
                    <polygon points="20,18 22,20 22,22 20,20" fill="#C0C0C0" stroke="#999" stroke-width="0.3"/>
                    <rect x="39" y="22" width="1" height="6" fill="#8B4513"/>
                    <polygon points="39,20 41,22 41,24 39,22" fill="#C0C0C0" stroke="#999" stroke-width="0.3"/>
                    <!-- æ‰‹è‡‚ -->
                    <line x1="30" y1="20" x2="21" y2="24" stroke="#ffd4a3" stroke-width="2" stroke-linecap="round"/>
                    <line x1="30" y1="20" x2="40" y2="26" stroke="#ffd4a3" stroke-width="2" stroke-linecap="round"/>
                    <!-- æš—å½±è½¨è¿¹ -->
                    <path d="M 15 18 Q 25 15 35 25" stroke="#800080" stroke-width="1.5" fill="none" opacity="0.7" stroke-dasharray="2,2"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="30" y1="34" x2="26" y2="48" stroke="#2c2c2c" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="34" x2="34" y2="48" stroke="#2c2c2c" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'shield': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="shieldGlow" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" style="stop-color:#4ecdc4;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#44a08d;stop-opacity:0.2" />
                        </radialGradient>
                        <linearGradient id="shieldMetal" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#e6e6e6" />
                            <stop offset="50%" style="stop-color:#ffffff" />
                            <stop offset="100%" style="stop-color:#b3b3b3" />
                        </linearGradient>
                    </defs>
                    <!-- é˜²æŠ¤å…‰ç¯ -->
                    <circle cx="30" cy="30" r="28" fill="url(#shieldGlow)" opacity="0.6"/>
                    <!-- å®ˆæŠ¤è€…å¤´éƒ¨ -->
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <!-- åšæ¯…è¡¨æƒ… -->
                    <circle cx="28" cy="10" r="0.5" fill="#0066cc"/>
                    <circle cx="32" cy="10" r="0.5" fill="#0066cc"/>
                    <path d="M 27 14 Q 30 13 33 14" stroke="#654321" stroke-width="1" fill="none"/>
                    <!-- é‡ç”²èº«ä½“ -->
                    <rect x="26" y="17" width="8" height="18" fill="#C0C0C0" rx="2"/>
                    <rect x="27" y="18" width="6" height="3" fill="#FFD700" rx="1"/>
                    <!-- å¤§ç›¾ç‰Œ -->
                    <path d="M 12 15 Q 8 25 12 40 Q 18 35 22 25 Q 18 15 12 15" fill="url(#shieldMetal)" stroke="#999" stroke-width="1"/>
                    <circle cx="17" cy="27" r="3" fill="#FFD700"/>
                    <path d="M 15 25 L 19 25 L 17 29 Z" fill="#ff6600"/>
                    <!-- ç›¾ç‰Œå…‰æ•ˆ -->
                    <circle cx="17" cy="27" r="8" fill="none" stroke="#4ecdc4" stroke-width="1" opacity="0.6" stroke-dasharray="3,3"/>
                    <!-- æ‰‹è‡‚ -->
                    <line x1="30" y1="22" x2="22" y2="25" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="38" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#C0C0C0" stroke-width="4" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#C0C0C0" stroke-width="4" stroke-linecap="round"/>
                </svg>`,
                'fireball': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="fireCore" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" style="stop-color:#ffff00" />
                            <stop offset="30%" style="stop-color:#ff6600" />
                            <stop offset="100%" style="stop-color:#cc0000" />
                        </radialGradient>
                    </defs>
                    <!-- ç«ç„°èƒŒæ™¯ -->
                    <circle cx="30" cy="30" r="28" fill="#ff4400" opacity="0.3"/>
                    <!-- æ³•å¸ˆå¤´éƒ¨ -->
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <!-- æ³•å¸ˆå¸½ -->
                    <polygon points="25,7 35,7 32,2 28,2" fill="#4a0080" stroke="#330055" stroke-width="1"/>
                    <circle cx="30" cy="2" r="1" fill="#ffff00"/>
                    <!-- ä¸“æ³¨è¡¨æƒ… -->
                    <circle cx="28" cy="10" r="0.5" fill="#ff6600"/>
                    <circle cx="32" cy="10" r="0.5" fill="#ff6600"/>
                    <!-- æ³•è¢ -->
                    <rect x="26" y="17" width="8" height="18" fill="#4a0080" rx="3"/>
                    <rect x="27" y="19" width="6" height="2" fill="#ffff00" rx="1"/>
                    <!-- ç«çƒ -->
                    <circle cx="15" cy="22" r="6" fill="url(#fireCore)"/>
                    <circle cx="13" cy="20" r="3" fill="#ffff00" opacity="0.8"/>
                    <circle cx="17" cy="24" r="2" fill="#ffffff" opacity="0.6"/>
                    <!-- ç«ç„°è½¨è¿¹ -->
                    <path d="M 8 18 Q 5 22 8 26 Q 12 24 15 28 Q 18 22 22 26" stroke="#ff6600" stroke-width="2" fill="none" opacity="0.8"/>
                    <path d="M 6 20 Q 10 16 14 20 Q 18 24 22 20" stroke="#ffff00" stroke-width="1" fill="none" opacity="0.6"/>
                    <!-- æ‰‹è‡‚æ–½æ³•å§¿æ€ -->
                    <line x1="30" y1="22" x2="21" y2="20" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="38" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#4a0080" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#4a0080" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'lightning': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <linearGradient id="lightningGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#ffffff" />
                            <stop offset="50%" style="stop-color:#ffff00" />
                            <stop offset="100%" style="stop-color:#0066ff" />
                        </linearGradient>
                    </defs>
                    <!-- é›·ç”µåœº -->
                    <circle cx="30" cy="30" r="28" fill="#0066ff" opacity="0.2"/>
                    <!-- æ³•å¸ˆå¤´éƒ¨ -->
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <!-- é›·ç”µçœ¼ç› -->
                    <circle cx="28" cy="10" r="0.5" fill="#00ffff"/>
                    <circle cx="32" cy="10" r="0.5" fill="#00ffff"/>
                    <!-- æ³•è¢ -->
                    <rect x="26" y="17" width="8" height="18" fill="#000080" rx="3"/>
                    <!-- é—ªç”µ -->
                    <path d="M 8 12 L 15 22 L 12 22 L 18 32 L 15 28 L 10 28 L 8 12 Z" fill="url(#lightningGrad)" stroke="#ffffff" stroke-width="0.5"/>
                    <!-- ç”µå¼§æ•ˆæœ -->
                    <path d="M 5 15 Q 12 10 20 18 Q 15 25 8 20" stroke="#00ffff" stroke-width="1.5" fill="none" opacity="0.8"/>
                    <path d="M 10 8 Q 18 12 25 8 Q 20 15 12 12" stroke="#ffff00" stroke-width="1" fill="none" opacity="0.6"/>
                    <!-- æ‰‹è‡‚ -->
                    <line x1="30" y1="22" x2="18" y2="18" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="38" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#000080" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#000080" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'stealth': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="shadowAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#800080;stop-opacity:0.6" />
                            <stop offset="100%" style="stop-color:#000000;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <!-- æš—å½±é¢†åŸŸ -->
                    <circle cx="30" cy="30" r="28" fill="url(#shadowAura)"/>
                    <!-- åŠé€æ˜åˆºå®¢ -->
                    <circle cx="30" cy="12" r="4" fill="#ffd4a3" stroke="#d4a574" stroke-width="1" opacity="0.4"/>
                    <rect x="27" y="16" width="6" height="18" fill="#2c2c2c" rx="2" opacity="0.4"/>
                    <!-- æš—å½±è½®å»“ -->
                    <circle cx="32" cy="14" r="5" fill="none" stroke="#800080" stroke-width="2" stroke-dasharray="3,3" opacity="0.8"/>
                    <rect x="29" y="18" width="6" height="18" fill="none" stroke="#800080" stroke-width="1.5" stroke-dasharray="2,2" rx="2" opacity="0.6"/>
                    <!-- æš—å½±æ‰‹è‡‚ -->
                    <line x1="30" y1="20" x2="20" y2="25" stroke="#800080" stroke-width="2" stroke-linecap="round" opacity="0.7" stroke-dasharray="4,2"/>
                    <line x1="30" y1="20" x2="40" y2="25" stroke="#800080" stroke-width="2" stroke-linecap="round" opacity="0.7" stroke-dasharray="4,2"/>
                    <!-- æš—å½±ç²’å­ -->
                    <circle cx="15" cy="20" r="1" fill="#800080" opacity="0.8"/>
                    <circle cx="45" cy="25" r="1.5" fill="#4a0080" opacity="0.6"/>
                    <circle cx="20" cy="35" r="0.8" fill="#800080" opacity="0.9"/>
                    <circle cx="40" cy="40" r="1.2" fill="#4a0080" opacity="0.7"/>
                    <!-- æš—å½±è…¿éƒ¨ -->
                    <line x1="30" y1="34" x2="26" y2="48" stroke="#800080" stroke-width="2" stroke-linecap="round" opacity="0.5" stroke-dasharray="3,3"/>
                    <line x1="30" y1="34" x2="34" y2="48" stroke="#800080" stroke-width="2" stroke-linecap="round" opacity="0.5" stroke-dasharray="3,3"/>
                </svg>`,
                'heal': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="healAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#00ff00;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#44ff44;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <!-- æ²»ç–—å…‰ç¯ -->
                    <circle cx="30" cy="30" r="28" fill="url(#healAura)" opacity="0.7"/>
                    <!-- ç‰§å¸ˆå¤´éƒ¨ -->
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <!-- æ…ˆç¥¥è¡¨æƒ… -->
                    <circle cx="28" cy="10" r="0.5" fill="#00aa00"/>
                    <circle cx="32" cy="10" r="0.5" fill="#00aa00"/>
                    <path d="M 27 14 Q 30 15 33 14" stroke="#654321" stroke-width="1" fill="none"/>
                    <!-- ç™½è¢ -->
                    <rect x="26" y="17" width="8" height="18" fill="#ffffff" rx="3" stroke="#e6e6e6" stroke-width="1"/>
                    <rect x="28" y="19" width="4" height="2" fill="#00ff00" rx="1"/>
                    <!-- æ²»ç–—åå­— -->
                    <line x1="15" y1="20" x2="25" y2="20" stroke="#00ff00" stroke-width="3" stroke-linecap="round"/>
                    <line x1="20" y1="15" x2="20" y2="25" stroke="#00ff00" stroke-width="3" stroke-linecap="round"/>
                    <!-- æ²»ç–—å…‰ç¯æ•ˆæœ -->
                    <circle cx="20" cy="20" r="8" fill="none" stroke="#44ff44" stroke-width="1.5" opacity="0.8"/>
                    <circle cx="20" cy="20" r="12" fill="none" stroke="#88ff88" stroke-width="1" opacity="0.5"/>
                    <!-- æ²»ç–—ç²’å­ -->
                    <circle cx="12" cy="15" r="1" fill="#00ff00" opacity="0.9"/>
                    <circle cx="28" cy="12" r="0.8" fill="#44ff44" opacity="0.7"/>
                    <circle cx="18" cy="28" r="1.2" fill="#00ff00" opacity="0.8"/>
                    <circle cx="25" cy="25" r="0.6" fill="#88ff88" opacity="0.6"/>
                    <!-- æ‰‹è‡‚ -->
                    <line x1="30" y1="22" x2="20" y2="18" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="38" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <!-- è…¿éƒ¨ -->
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#ffffff" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#ffffff" stroke-width="3" stroke-linecap="round"/>
                </svg>`
            };
            
            // æ·»åŠ æ›´å¤šå¡ç‰ŒåŸç”»ç±»å‹
            const additionalArt = {
                'berserker': artMap['charge'],
                'dual-slash': artMap['sword-strike'],
                'execute': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="executeAura" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" style="stop-color:#ff0000;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#8b0000;stop-opacity:0.3" />
                        </radialGradient>
                    </defs>
                    <circle cx="30" cy="30" r="28" fill="url(#executeAura)" opacity="0.8"/>
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <circle cx="28" cy="10" r="0.5" fill="#8b0000"/>
                    <circle cx="32" cy="10" r="0.5" fill="#8b0000"/>
                    <rect x="26" y="17" width="8" height="18" fill="#8B4513" rx="2"/>
                    <rect x="12" y="15" width="3" height="15" fill="#8B4513"/>
                    <polygon points="12,10 18,15 18,18 12,15" fill="#ff0000" stroke="#8b0000" stroke-width="1"/>
                    <line x1="30" y1="22" x2="15" y2="18" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="38" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <path d="M 8 12 Q 15 8 22 15" stroke="#ff0000" stroke-width="3" fill="none" opacity="0.8"/>
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'combo': artMap['dagger'],
                'poison-blade': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <circle cx="30" cy="30" r="25" fill="#9b59b6" opacity="0.3"/>
                    <circle cx="30" cy="12" r="4" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <rect x="27" y="16" width="6" height="18" fill="#2c2c2c" rx="2"/>
                    <rect x="18" y="20" width="1" height="8" fill="#8B4513"/>
                    <polygon points="18,18 20,20 20,22 18,20" fill="#9b59b6" stroke="#8e44ad" stroke-width="0.5"/>
                    <line x1="30" y1="20" x2="19" y2="22" stroke="#ffd4a3" stroke-width="2" stroke-linecap="round"/>
                    <line x1="30" y1="20" x2="38" y2="26" stroke="#ffd4a3" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="15" cy="18" r="1" fill="#9b59b6" opacity="0.8"/>
                    <circle cx="12" cy="22" r="0.8" fill="#8e44ad" opacity="0.6"/>
                    <circle cx="20" cy="15" r="1.2" fill="#9b59b6" opacity="0.7"/>
                    <line x1="30" y1="34" x2="26" y2="48" stroke="#2c2c2c" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="34" x2="34" y2="48" stroke="#2c2c2c" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'critical': artMap['execute'],
                'pierce': artMap['dagger'],
                'toughness': artMap['shield'],
                'parry': artMap['shield'],
                'counter': artMap['shield'],
                'iron-will': artMap['shield'],
                'perfect-defense': artMap['shield'],
                'dodge': artMap['stealth'],
                'clone': artMap['stealth'],
                'magic-missile': artMap['lightning'],
                'magic-shield': artMap['shield'],
                'focus': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="focusAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#00bcd4;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#0097a7;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <circle cx="30" cy="30" r="28" fill="url(#focusAura)" opacity="0.7"/>
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <circle cx="28" cy="10" r="0.5" fill="#00bcd4"/>
                    <circle cx="32" cy="10" r="0.5" fill="#00bcd4"/>
                    <rect x="26" y="17" width="8" height="18" fill="#4a0080" rx="3"/>
                    <circle cx="30" cy="25" r="6" fill="none" stroke="#00bcd4" stroke-width="2"/>
                    <circle cx="30" cy="25" r="3" fill="#00bcd4" opacity="0.6"/>
                    <circle cx="30" cy="25" r="1" fill="#ffffff"/>
                    <line x1="30" y1="22" x2="20" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="40" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#4a0080" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#4a0080" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'freeze-ray': artMap['lightning'],
                'mana-drain': artMap['focus'],
                'teleport': artMap['stealth'],
                'elemental-burst': artMap['fireball'],
                'time-warp': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="timeAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#9c27b0;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#673ab7;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <circle cx="30" cy="30" r="28" fill="url(#timeAura)" opacity="0.7"/>
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <circle cx="28" cy="10" r="0.5" fill="#9c27b0"/>
                    <circle cx="32" cy="10" r="0.5" fill="#9c27b0"/>
                    <rect x="26" y="17" width="8" height="18" fill="#4a0080" rx="3"/>
                    <circle cx="20" cy="25" r="8" fill="none" stroke="#9c27b0" stroke-width="2"/>
                    <line x1="20" y1="17" x2="20" y2="21" stroke="#9c27b0" stroke-width="2"/>
                    <line x1="28" y1="25" x2="24" y2="25" stroke="#9c27b0" stroke-width="2"/>
                    <line x1="20" y1="29" x2="20" y2="33" stroke="#9c27b0" stroke-width="2"/>
                    <line x1="12" y1="25" x2="16" y2="25" stroke="#9c27b0" stroke-width="2"/>
                    <path d="M 15 20 Q 25 15 35 25" stroke="#9c27b0" stroke-width="1.5" fill="none" opacity="0.7" stroke-dasharray="3,3"/>
                    <line x1="30" y1="22" x2="20" y2="20" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="22" x2="38" y2="28" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#4a0080" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#4a0080" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'vampiric': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <circle cx="30" cy="30" r="25" fill="#8b0000" opacity="0.4"/>
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <circle cx="28" cy="10" r="0.5" fill="#ff0000"/>
                    <circle cx="32" cy="10" r="0.5" fill="#ff0000"/>
                    <rect x="26" y="17" width="8" height="18" fill="#2c2c2c" rx="2"/>
                    <rect x="18" y="20" width="2" height="8" fill="#8B4513"/>
                    <polygon points="18,18 22,20 22,22 18,20" fill="#8b0000" stroke="#660000" stroke-width="0.5"/>
                    <path d="M 10 15 Q 20 10 30 20" stroke="#ff0000" stroke-width="2" fill="none" opacity="0.8"/>
                    <circle cx="15" cy="18" r="1.5" fill="#ff0000" opacity="0.9"/>
                    <circle cx="25" cy="15" r="1" fill="#cc0000" opacity="0.7"/>
                    <line x1="30" y1="20" x2="20" y2="22" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="20" x2="38" y2="26" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="34" x2="26" y2="48" stroke="#2c2c2c" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="34" x2="34" y2="48" stroke="#2c2c2c" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'rage': artMap['berserker'],
                'purify': artMap['heal'],
                'lucky-coin': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <defs>
                        <radialGradient id="luckAura" cx="50%" cy="50%" r="60%">
                            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#ffb347;stop-opacity:0.1" />
                        </radialGradient>
                    </defs>
                    <circle cx="30" cy="30" r="28" fill="url(#luckAura)" opacity="0.7"/>
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1"/>
                    <circle cx="28" cy="10" r="0.5" fill="#ffd700"/>
                    <circle cx="32" cy="10" r="0.5" fill="#ffd700"/>
                    <rect x="26" y="17" width="8" height="18" fill="#8B4513" rx="2"/>
                    <circle cx="18" cy="22" r="5" fill="#ffd700" stroke="#ffb347" stroke-width="1"/>
                    <text x="18" y="25" text-anchor="middle" font-size="6" fill="#8B4513">$</text>
                    <path d="M 12 18 Q 18 12 24 18" stroke="#ffd700" stroke-width="1.5" fill="none" opacity="0.8"/>
                    <circle cx="10" cy="15" r="0.8" fill="#ffd700" opacity="0.9"/>
                    <circle cx="26" cy="15" r="1" fill="#ffb347" opacity="0.7"/>
                    <circle cx="15" cy="28" r="0.6" fill="#ffd700" opacity="0.8"/>
                    <line x1="30" y1="20" x2="23" y2="20" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="20" x2="38" y2="26" stroke="#ffd4a3" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="34" x2="26" y2="48" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                    <line x1="30" y1="34" x2="34" y2="48" stroke="#8B4513" stroke-width="3" stroke-linecap="round"/>
                </svg>`,
                'rebirth': artMap['heal'],
                'weakness-curse': `<svg class="stickman-art" viewBox="0 0 60 60">
                    <circle cx="30" cy="30" r="28" fill="#8b0000" opacity="0.5"/>
                    <circle cx="30" cy="12" r="5" fill="#ffd4a3" stroke="#d4a574" stroke-width="1" opacity="0.7"/>
                    <circle cx="28" cy="10" r="0.5" fill="#8b0000"/>
                    <circle cx="32" cy="10" r="0.5" fill="#8b0000"/>
                    <path d="M 27 14 Q 30 16 33 14" stroke="#8b0000" stroke-width="1" fill="none"/>
                    <rect x="26" y="17" width="8" height="18" fill="#654321" rx="2" opacity="0.8"/>
                    <path d="M 15 15 Q 30 10 45 15 Q 30 20 15 15" stroke="#ff0000" stroke-width="2" fill="none" opacity="0.8"/>
                    <circle cx="20" cy="20" r="2" fill="#8b0000" opacity="0.6"/>
                    <circle cx="40" cy="25" r="1.5" fill="#660000" opacity="0.7"/>
                    <circle cx="25" cy="30" r="1" fill="#8b0000" opacity="0.8"/>
                    <line x1="30" y1="22" x2="20" y2="28" stroke="#ffd4a3" stroke-width="2" stroke-linecap="round" opacity="0.7"/>
                    <line x1="30" y1="22" x2="40" y2="28" stroke="#ffd4a3" stroke-width="2" stroke-linecap="round" opacity="0.7"/>
                    <line x1="30" y1="35" x2="26" y2="50" stroke="#654321" stroke-width="3" stroke-linecap="round" opacity="0.8"/>
                    <line x1="30" y1="35" x2="34" y2="50" stroke="#654321" stroke-width="3" stroke-linecap="round" opacity="0.8"/>
                </svg>`,
                'fatigue': artMap['weakness-curse'],
                'pain': artMap['weakness-curse']
            };
            
            // åˆå¹¶æ‰€æœ‰åŸç”»
            const allArt = { ...artMap, ...additionalArt };
            
            return allArt[artType] || allArt['sword-strike'];
        }

        // æ·»åŠ å¡ç‰Œåˆ°ç‰Œç»„
        function addCardToDeck(cardName) {
            // æ£€æŸ¥ç‰Œç»„æ˜¯å¦å·²æ»¡
            if (gameState.playerDeck.length >= 20) {
                return;
            }
            
            // è·å–å¡ç‰Œä¿¡æ¯
            const card = cardDatabase[cardName];
            if (!card) return;
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯éæœ¬è§’è‰²æˆ–éé€šç”¨çš„å…¶ä»–èŒä¸šå¡ç‰Œ
            const isOtherClassCard = card.character !== gameState.selectedCharacter && 
                                     card.character !== 'neutral';
            
            if (isOtherClassCard) {
                // è®¡ç®—å½“å‰ç‰Œåº“ä¸­å…¶ä»–èŒä¸šå¡ç‰Œçš„æ•°é‡
                const otherClassCardsCount = gameState.playerDeck.filter(cardNameInDeck => {
                    const cardInDeck = cardDatabase[cardNameInDeck];
                    return cardInDeck && 
                           cardInDeck.character !== gameState.selectedCharacter && 
                           cardInDeck.character !== 'neutral';
                }).length;
                
                // å¦‚æœå·²ç»æœ‰3å¼ æˆ–æ›´å¤šå…¶ä»–èŒä¸šå¡ç‰Œï¼Œåˆ™ä¸æ·»åŠ 
                if (otherClassCardsCount >= 3) {
                    alert('æœ€å¤šåªèƒ½é€‰æ‹©3å¼ éæœ¬è§’è‰²æˆ–éé€šç”¨çš„å…¶ä»–èŒä¸šå¡ç‰ŒåŠ å…¥ç‰Œåº“ï¼');
                    return;
                }
            }
            
            // æ·»åŠ å¡ç‰Œ
            gameState.playerDeck.push(cardName);
            updateDeckDisplay();
            updateUI();
        }

        // ä»ç‰Œç»„ç§»é™¤å¡ç‰Œ
        function removeCardFromDeck(index) {
            // ç¡®ä¿ç§»é™¤å¡ç‰Œåç‰Œç»„æ•°é‡ä¸ä¼šå°‘äº8å¼ 
            if (gameState.playerDeck.length <= 8) {
                alert('ç‰Œç»„ä¸èƒ½å°‘äº8å¼ å¡ç‰Œï¼');
                return;
            }
            
            gameState.playerDeck.splice(index, 1);
            updateDeckDisplay();
            updateUI();
        }

        // è§¦å‘éšæœºäº‹ä»¶
        function triggerRandomEvent() {
            if (Math.random() < 0.7) { // 70%å‡ ç‡è§¦å‘äº‹ä»¶
                const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
                showRandomEvent(event);
            } else {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push('ä½ æ¢ç´¢äº†ä¸€ç•ªï¼Œä½†ä»€ä¹ˆä¹Ÿæ²¡å‘ç°...');
            }
        }

        // æ˜¾ç¤ºéšæœºäº‹ä»¶
        function showRandomEvent(event) {
            document.getElementById('eventTitle').textContent = event.name;
            document.getElementById('eventDescription').textContent = event.description;
            
            const choicesContainer = document.getElementById('eventChoices');
            choicesContainer.innerHTML = '';
            
            event.choices.forEach(choice => {
                const choiceBtn = document.createElement('button');
                choiceBtn.className = 'btn';
                choiceBtn.textContent = choice.text;
                choiceBtn.style.margin = '10px';
                choiceBtn.style.display = 'block';
                choiceBtn.style.width = '300px';
                choiceBtn.style.marginLeft = 'auto';
                choiceBtn.style.marginRight = 'auto';
                
                if (choice.cost > 0 && gameState.gold < choice.cost) {
                    choiceBtn.disabled = true;
                    choiceBtn.style.opacity = '0.5';
                }
                
                choiceBtn.addEventListener('click', () => {
                    executeEventChoice(choice);
                    showScreen('deckScreen');
                });
                
                choicesContainer.appendChild(choiceBtn);
            });
            
            showScreen('eventScreen');
        }

        // æ‰§è¡Œäº‹ä»¶é€‰æ‹©
        function executeEventChoice(choice) {
            if (choice.cost > 0) {
                gameState.gold -= choice.cost;
            }
            
            switch(choice.effect) {
                case 'rare_card':
                    const rareCards = Object.keys(cardDatabase).filter(name => 
                        cardDatabase[name].rarity === 'rare' && cardDatabase[name].type !== 'curse' && cardDatabase[name].rarity !== 'legendary'
                    );
                    const randomRare = rareCards[Math.floor(Math.random() * rareCards.length)];
                    gameState.playerDeck.push(randomRare);
                    gameState.battleLog = gameState.battleLog || [];
                    gameState.battleLog.push(`è·å¾—äº†ç¨€æœ‰å¡ç‰Œ: ${randomRare}ï¼`);
                    break;
                    
                case 'relic':
                    const availableRelics = [
                        'å¸è¡€é¬¼ä¹‹ç‰™', 'è†æ£˜æŠ¤ç¬¦', 'å¹¸è¿ç¡¬å¸', 'æˆ˜å£«ä¹‹é­‚',
                        'æ³•å¸ˆä¹‹æˆ’', 'ç›—è´¼é¢å…·', 'é¾™é³æŠ¤ç”²', 'æ—¶é—´æ²™æ¼'
                    ];
                    const randomRelic = availableRelics[Math.floor(Math.random() * availableRelics.length)];
                    gameState.relics = gameState.relics || [];
                    if (!gameState.relics.includes(randomRelic)) {
                        gameState.relics.push(randomRelic);
                        gameState.battleLog.push(`è·å¾—äº†ç¥å™¨: ${randomRelic}ï¼`);
                    } else {
                        gameState.gold += 25; // å¦‚æœå·²æœ‰è¯¥ç¥å™¨ï¼Œç»™äºˆé‡‘å¸è¡¥å¿
                        gameState.battleLog.push('å·²æ‹¥æœ‰è¯¥ç¥å™¨ï¼Œè·å¾—25é‡‘å¸è¡¥å¿ï¼');
                    }
                    break;
                    
                case 'sacrifice_hp':
                    gameState.playerHp -= choice.cost;
                    let strengthBuff = gameState.buffs.find(b => b.name === 'åŠ›é‡');
                    if (strengthBuff) strengthBuff.stacks += 3;
                    else gameState.buffs.push({ name: 'åŠ›é‡', stacks: 3, type: 'power' });
                    gameState.battleLog.push('çŒ®ç¥­ç”Ÿå‘½å€¼ï¼Œè·å¾—äº†å¼ºå¤§çš„åŠ›é‡ï¼');
                    break;
                    
                case 'purify':
                    const curseCards = gameState.playerDeck.filter(card => cardDatabase[card].type === 'curse');
                    curseCards.forEach(curse => {
                        const index = gameState.playerDeck.indexOf(curse);
                        gameState.playerDeck.splice(index, 1);
                    });
                    gameState.battleLog.push(`å‡€åŒ–äº† ${curseCards.length} å¼ è¯…å’’å¡ç‰Œï¼`);
                    break;
                    
                case 'full_heal':
                    gameState.playerHp = gameState.playerMaxHp;
                    gameState.battleLog.push('å®Œå…¨æ¢å¤äº†ç”Ÿå‘½å€¼ï¼');
                    break;
                    
                case 'heal_potion':
                    gameState.playerDeck.push('æ²»ç–—è¯æ°´');
                    gameState.battleLog.push('è·å¾—äº†æ²»ç–—è¯æ°´å¡ç‰Œï¼');
                    break;
                    
                case 'magic_card':
                    const magicCards = Object.keys(cardDatabase).filter(name => 
                        cardDatabase[name].type === 'magic' && cardDatabase[name].rarity !== 'curse'
                    );
                    const randomMagic = magicCards[Math.floor(Math.random() * magicCards.length)];
                    gameState.playerDeck.push(randomMagic);
                    gameState.battleLog.push(`å­¦ä¼šäº†æ³•æœ¯: ${randomMagic}ï¼`);
                    break;
                    
                case 'upgrade_card':
                    // éšæœºå¼ºåŒ–ä¸€å¼ å¯å¼ºåŒ–çš„å¡ç‰Œ
                    const upgradableCards = gameState.playerDeck.filter(card => cardUpgrades[card]);
                    if (upgradableCards.length > 0) {
                        const cardToUpgrade = upgradableCards[Math.floor(Math.random() * upgradableCards.length)];
                        const index = gameState.playerDeck.indexOf(cardToUpgrade);
                        gameState.playerDeck[index] = cardUpgrades[cardToUpgrade].name;
                        gameState.battleLog.push(`${cardToUpgrade} è¢«å¼ºåŒ–ä¸º ${cardUpgrades[cardToUpgrade].name}ï¼`);
                    } else {
                        gameState.gold += 15; // é€€è¿˜é‡‘å¸
                        gameState.battleLog.push('æ²¡æœ‰å¯å¼ºåŒ–çš„å¡ç‰Œï¼Œé€€è¿˜é‡‘å¸ï¼');
                    }
                    break;
                    
                case 'cursed_treasure':
                    const treasureRares = Object.keys(cardDatabase).filter(name => 
                        cardDatabase[name].rarity === 'rare' && cardDatabase[name].type !== 'curse' && cardDatabase[name].rarity !== 'legendary'
                    );
                    const curses = Object.keys(cardDatabase).filter(name => 
                        cardDatabase[name].type === 'curse'
                    );
                    const treasureCard = treasureRares[Math.floor(Math.random() * treasureRares.length)];
                    const curseCard = curses[Math.floor(Math.random() * curses.length)];
                    gameState.playerDeck.push(treasureCard);
                    gameState.playerDeck.push(curseCard);
                    gameState.battleLog.push(`è·å¾—äº†ç¨€æœ‰å¡ç‰Œ ${treasureCard}ï¼Œä½†ä¹Ÿè¢«è¯…å’’äº† ${curseCard}ï¼`);
                    break;
                    
                case 'purified_treasure':
                    const purifiedRares = Object.keys(cardDatabase).filter(name => 
                        cardDatabase[name].rarity === 'rare' && cardDatabase[name].type !== 'curse' && cardDatabase[name].rarity !== 'legendary'
                    );
                    const purifiedCard = purifiedRares[Math.floor(Math.random() * purifiedRares.length)];
                    gameState.playerDeck.push(purifiedCard);
                    gameState.battleLog.push(`å‡€åŒ–å®ç®±åè·å¾—äº†ç¨€æœ‰å¡ç‰Œ: ${purifiedCard}ï¼`);
                    break;
                    
                case 'nothing':
                    gameState.battleLog.push('ä½ é€‰æ‹©äº†ç¦»å¼€...');
                    break;
            }
            
            updateDeckDisplay();
            updateUI();
        }

        // æ‰“å¼€å¼ºåŒ–ç•Œé¢
        function openUpgradeScreen() {
            if (gameState.gold < 25) {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push('é‡‘å¸ä¸è¶³ï¼éœ€è¦25é‡‘å¸è¿›è¡Œå¼ºåŒ–ã€‚');
                return;
            }
            
            const upgradableCards = gameState.playerDeck.filter(card => cardUpgrades[card]);
            if (upgradableCards.length === 0) {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push('æ²¡æœ‰å¯å¼ºåŒ–çš„å¡ç‰Œï¼');
                return;
            }
            
            const upgradeContainer = document.getElementById('upgradeCards');
            upgradeContainer.innerHTML = '';
            
            // å»é‡å¹¶æ˜¾ç¤ºå¯å¼ºåŒ–çš„å¡ç‰Œ
            const uniqueCards = [...new Set(upgradableCards)];
            uniqueCards.forEach(cardName => {
                const cardElement = createCardElement(cardName, () => {
                    upgradeCard(cardName);
                });
                upgradeContainer.appendChild(cardElement);
            });
            
            showScreen('upgradeScreen');
        }

        // å¼ºåŒ–å¡ç‰Œ
        function upgradeCard(cardName) {
            if (gameState.gold < 25) {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push('é‡‘å¸ä¸è¶³ï¼');
                return;
            }
            
            const upgrade = cardUpgrades[cardName];
            if (!upgrade) {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push('è¯¥å¡ç‰Œæ— æ³•å¼ºåŒ–ï¼');
                return;
            }
            
            gameState.gold -= 25;
            const index = gameState.playerDeck.indexOf(cardName);
            if (index !== -1) {
                gameState.playerDeck[index] = upgrade.name;
                
                // æ›´æ–°å¡ç‰Œæ•°æ®åº“ä»¥åŒ…å«å¼ºåŒ–ç‰ˆæœ¬
                cardDatabase[upgrade.name] = {
                    ...cardDatabase[cardName],
                    ...upgrade,
                    rarity: cardDatabase[cardName].rarity
                };
                
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push(`${cardName} å¼ºåŒ–ä¸º ${upgrade.name}ï¼`);
                updateDeckDisplay();
                updateUI();
                showScreen('deckScreen');
            }
        }

        // å•†åº—
        function openShop() {
            // æ ¹æ®ç¨€æœ‰åº¦ç”Ÿæˆå¡ç‰Œå’Œå®šä»·ï¼ˆæ’é™¤ä¼ å¥‡å¡ç‰Œï¼‰
            const rarityWeights = {
                'common': 60,
                'uncommon': 25,
                'rare': 10,
                'curse': 5
            };
            
            const rarityPrices = {
                'common': 8,
                'uncommon': 15,
                'rare': 25,
                'curse': 3  // è¯…å’’å¡ä¾¿å®œä½†æœ‰è´Ÿé¢æ•ˆæœ
            };
            
            // éšæœºé€‰æ‹©ç¨€æœ‰åº¦
            const totalWeight = Object.values(rarityWeights).reduce((a, b) => a + b, 0);
            let random = Math.random() * totalWeight;
            let selectedRarity = 'common';
            
            for (const [rarity, weight] of Object.entries(rarityWeights)) {
                random -= weight;
                if (random <= 0) {
                    selectedRarity = rarity;
                    break;
                }
            }
            
            // è·å–è¯¥ç¨€æœ‰åº¦çš„å¡ç‰Œï¼ˆæ’é™¤ä¼ å¥‡å¡ç‰Œï¼‰
            const availableCards = Object.keys(cardDatabase).filter(name => 
                cardDatabase[name].rarity === selectedRarity && cardDatabase[name].rarity !== 'legendary'
            );
            
            if (availableCards.length === 0) {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push('å•†åº—æš‚æ—¶æ²¡æœ‰å•†å“ï¼');
                return;
            }
            
            const randomCard = availableCards[Math.floor(Math.random() * availableCards.length)];
            const price = rarityPrices[selectedRarity];
            
            if (gameState.gold >= price) {
                gameState.gold -= price;
                gameState.playerDeck.push(randomCard);
                const rarityText = {
                    'common': 'æ™®é€š',
                    'uncommon': 'ç½•è§', 
                    'rare': 'ç¨€æœ‰',
                    'curse': 'è¯…å’’'
                };
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push(`èŠ±è´¹${price}é‡‘å¸è·å¾—äº†${rarityText[selectedRarity]}å¡ç‰Œ: ${randomCard}ï¼`);
                updateDeckDisplay();
                updateUI();
            } else {
                gameState.battleLog = gameState.battleLog || [];
                gameState.battleLog.push(`é‡‘å¸ä¸è¶³ï¼éœ€è¦${price}é‡‘å¸ã€‚`);
            }
        }

        // è¿›å…¥æˆ˜æ–—
        function enterBattle() {
            if (gameState.playerDeck.length < 8) {
                alert('ç‰Œç»„è‡³å°‘éœ€è¦8å¼ å¡ç‰Œï¼');
                return;
            }
            
            // è®°å½•æˆ˜æ–—å¼€å§‹æ—¶çš„ç”Ÿå‘½å€¼ç”¨äºæˆå°±æ£€æŸ¥
            gameState.battleStartHp = gameState.playerHp;
            gameState.cardsPlayedThisTurn = 0;
            
            // æ£€æŸ¥æ˜¯å¦ä¸ºBOSSå…³å¡
            const isBossLevel = bosses[gameState.level];
            
            if (isBossLevel) {
                // ç”ŸæˆBOSSï¼Œæ ¹æ®éš¾åº¦å€æ•°è°ƒæ•´å±æ€§
                const boss = bosses[gameState.level];
                const difficultyMultiplier = gameState.difficultyMultiplier || 1;
                gameState.currentEnemy = {
                    ...boss,
                    maxHp: Math.floor(boss.maxHp * difficultyMultiplier),
                    hp: Math.floor(boss.maxHp * difficultyMultiplier),
                    attack: Math.floor(boss.attack * difficultyMultiplier),
                    currentPhase: 0,
                    currentIntent: 'special',
                    turnCount: 0,
                    isBoss: true,
                    phaseTransitioned: false
                };
                addLog(`âš ï¸ å®ˆå…³BOSSå‡ºç°ï¼š${boss.name}ï¼`);
                addLog(`å½“å‰é˜¶æ®µï¼š${boss.phases[0].name} - ${boss.phases[0].description}`);
            } else {
                // ç”Ÿæˆæ™®é€šæ•Œäºº
                const enemyIndex = Math.min(gameState.level - 1, enemies.length - 1);
                const baseEnemy = enemies[enemyIndex];
                
                // æ ¹æ®å…³å¡å’Œéš¾åº¦è°ƒæ•´æ•Œäººå±æ€§ï¼ˆä½¿ç”¨éçº¿æ€§å¢é•¿ä»¥å¢åŠ åæœŸéš¾åº¦ï¼‰
                const difficultyMultiplier = gameState.difficultyMultiplier || 1;
                // ä½¿ç”¨äºŒæ¬¡å‡½æ•°å¢é•¿ï¼Œä½¿åæœŸå…³å¡éš¾åº¦æ˜¾è‘—æé«˜
                const hpScaling = Math.floor((gameState.level - 1) * (3 + (gameState.level - 1) * 0.2) * difficultyMultiplier);
                const attackScaling = Math.floor((gameState.level - 1) * (1.2 + (gameState.level - 1) * 0.1) * difficultyMultiplier);
                
                gameState.currentEnemy = {
                    ...baseEnemy,
                    maxHp: Math.floor((baseEnemy.hp + hpScaling) * difficultyMultiplier),
                    hp: Math.floor((baseEnemy.hp + hpScaling) * difficultyMultiplier),
                    attack: Math.floor((baseEnemy.attack + attackScaling) * difficultyMultiplier),
                    currentIntent: baseEnemy.intent,
                    turnCount: 0,
                    isBoss: false
                };
            }
            
            // åˆå§‹åŒ–ç‰Œåº“ç³»ç»Ÿ
            gameState.drawPile = [...gameState.playerDeck];
            gameState.discardPile = [];
            gameState.exhaustedCards = []; // è®°å½•è¢«ç§»é™¤çš„å¡ç‰Œ
            
            // æ´—ç‰Œ
            for (let i = gameState.drawPile.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameState.drawPile[i], gameState.drawPile[j]] = [gameState.drawPile[j], gameState.drawPile[i]];
            }
            
            // é‡ç½®æˆ˜æ–—çŠ¶æ€
            gameState.energy = gameState.maxEnergy;
            gameState.hand = [];
            gameState.battleLog = [];
            gameState.playerBlock = 0;
            gameState.enemyPoison = 0;
            gameState.stealthTurns = 0;
            gameState.cardsPlayedThisTurn = 0;
            gameState.enemyMarked = false; // é‡ç½®çŒäººæ ‡è®°çŠ¶æ€
            gameState.precisionStacks = 0; // é‡ç½®ç²¾å‡†å±‚æ•°ï¼ˆé¹°çœ¼æ•ˆæœï¼‰
            
            // æŠ½åˆå§‹æ‰‹ç‰Œ
            drawCards(5 + (gameState.selectedCharacter === 'rogue' ? 1 : 0));
            
            showScreen('battleScreen');
            updateBattleUI();
        }

        // æŠ½å¡
        function drawCards(count) {
            // å¦‚æœæ˜¯å›åˆå¼€å§‹æ—¶çš„æŠ½ç‰Œï¼Œæ·»åŠ ç‰Œåº“ä¿¡æ¯åˆ°UI
            if (!document.getElementById('drawPileInfo')) {
                const battleArea = document.querySelector('.battle-area');
                const playerStatus = document.querySelector('.player-status');
                const drawPileInfo = document.createElement('div');
                drawPileInfo.id = 'drawPileInfo';
                drawPileInfo.style.position = 'absolute';
                drawPileInfo.style.top = '20px';
                drawPileInfo.style.left = '20px';
                drawPileInfo.style.background = 'rgba(0,0,0,0.7)';
                drawPileInfo.style.padding = '8px 12px';
                drawPileInfo.style.borderRadius = '8px';
                drawPileInfo.style.color = 'white';
                drawPileInfo.style.fontSize = '0.8rem';
                drawPileInfo.style.zIndex = '100';
                battleArea.insertBefore(drawPileInfo, battleArea.firstChild);
            }
            
            // ç«‹å³æ›´æ–°ç‰Œåº“ä¿¡æ¯
            document.getElementById('drawPileInfo').textContent = `ğŸƒ ç‰Œåº“: ${gameState.drawPile.length}å¼  | å¼ƒç‰Œå †: ${gameState.discardPile.length}å¼ `;
            
            // ä½¿ç”¨å®šæ—¶å™¨åˆ›å»ºå¡ç‰Œé€ä¸€å‡ºç°çš„æ•ˆæœ
            let delay = 0;
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    // å¦‚æœç‰Œåº“ä¸ºç©ºï¼Œé‡ç½®ç‰Œåº“
                    if (gameState.drawPile.length === 0) {
                        if (gameState.discardPile.length > 0) {
                            // å°†å¼ƒç‰Œå †æ´—å…¥ç‰Œåº“
                            gameState.drawPile = [...gameState.discardPile];
                            gameState.discardPile = [];
                            // æ´—ç‰Œ
                            for (let j = gameState.drawPile.length - 1; j > 0; j--) {
                                const k = Math.floor(Math.random() * (j + 1));
                                [gameState.drawPile[j], gameState.drawPile[k]] = [gameState.drawPile[k], gameState.drawPile[j]];
                            }
                            addLog('ç‰Œåº“å·²é‡ç½®å¹¶æ´—ç‰Œï¼');
                        } else {
                            // å¦‚æœå¼ƒç‰Œå †ä¹Ÿä¸ºç©ºï¼Œè¯´æ˜æ‰€æœ‰å¡ç‰Œéƒ½åœ¨æ‰‹ä¸­æˆ–è¢«ç§»é™¤ï¼Œåœæ­¢æŠ½ç‰Œ
                            addLog('æ²¡æœ‰æ›´å¤šå¡ç‰Œå¯æŠ½ï¼');
                            return;
                        }
                    }
                    
                    if (gameState.drawPile.length > 0) {
                        const cardName = gameState.drawPile.shift(); // ä»ç‰Œåº“é¡¶éƒ¨æŠ½ç‰Œ
                        gameState.hand.push(cardName);
                        
                        // åˆ›å»ºæŠ½ç‰ŒåŠ¨ç”»æ•ˆæœ
                        const handContainer = document.getElementById('hand');
                        handContainer.innerHTML = '';
                        
                        gameState.hand.forEach((cardName, index) => {
                            const cardElement = createCardElement(cardName, () => playCard(index));
                            const card = cardDatabase[cardName];
                            if (gameState.energy < card.cost) {
                                cardElement.style.opacity = '0.5';
                                cardElement.style.cursor = 'not-allowed';
                            }
                            
                            // ä¸ºæ–°æŠ½åˆ°çš„å¡ç‰Œæ·»åŠ åŠ¨ç”»
                            if (index === gameState.hand.length - 1) {
                                cardElement.style.animation = 'fadeIn 0.5s ease-out forwards';
                                cardElement.style.opacity = '0';
                                cardElement.style.transform = 'translateY(20px)';
                            }
                            
                            handContainer.appendChild(cardElement);
                        });
                        
                        // æ›´æ–°ç‰Œåº“ä¿¡æ¯
                        document.getElementById('drawPileInfo').textContent = `ğŸƒ ç‰Œåº“: ${gameState.drawPile.length}å¼  | å¼ƒç‰Œå †: ${gameState.discardPile.length}å¼ `;
                    }
                }, delay);
                
                // æ¯å¼ ç‰Œä¹‹é—´é—´éš”150æ¯«ç§’
                delay += 150;
            }
        }

        // æ›´æ–°æˆ˜æ–—UI
        function updateBattleUI() {
            const enemy = gameState.currentEnemy;
            const enemyElement = document.querySelector('.enemy');
            
            // æ·»åŠ BOSSæ ·å¼
            if (enemy.isBoss) {
                enemyElement.classList.add('boss');
            } else {
                enemyElement.classList.remove('boss');
            }
            
            document.getElementById('enemyArt').innerHTML = createEnemyArt(enemy.name);
            document.getElementById('enemyName').textContent = enemy.name;
            document.getElementById('enemyHp').textContent = enemy.hp;
            document.getElementById('enemyMaxHp').textContent = enemy.maxHp;
            document.getElementById('enemyHealth').style.width = `${(enemy.hp / enemy.maxHp) * 100}%`;
            
            // æ˜¾ç¤ºBOSSé˜¶æ®µä¿¡æ¯
            if (enemy.isBoss && enemy.phases) {
                const currentPhase = enemy.phases[enemy.currentPhase];
                let phaseDisplay = document.getElementById('bossPhaseDisplay');
                if (!phaseDisplay) {
                    phaseDisplay = document.createElement('div');
                    phaseDisplay.id = 'bossPhaseDisplay';
                    phaseDisplay.className = 'boss-phase';
                    document.querySelector('.enemy-display').appendChild(phaseDisplay);
                }
                phaseDisplay.textContent = `${currentPhase.name} (${enemy.currentPhase + 1}/${enemy.phases.length})`;
            } else {
                const phaseDisplay = document.getElementById('bossPhaseDisplay');
                if (phaseDisplay) {
                    phaseDisplay.remove();
                }
            }
            
            // æ›´æ–°æ•Œäººæ„å›¾æ˜¾ç¤º
            updateEnemyIntent(enemy);
            
            document.getElementById('playerHp').textContent = gameState.playerHp;
            document.getElementById('playerMaxHp').textContent = gameState.playerMaxHp;
            document.getElementById('playerHealth').style.width = `${(gameState.playerHp / gameState.playerMaxHp) * 100}%`;
            
            document.getElementById('energy').textContent = gameState.energy;
            
            updateHandDisplay();
            updateStatusEffectsDisplay();
            updateBattleLog();
        }
        
        // æ›´æ–°æ•Œäººæ„å›¾
        function updateEnemyIntent(enemy) {
            const intentIcon = document.getElementById('intentIcon');
            const intentText = document.getElementById('intentText');
            
            if (!enemy.currentIntent) {
                enemy.currentIntent = predictEnemyIntent(enemy);
            }
            
            const intentData = {
                'attack': { icon: 'âš”ï¸', color: '#ff4444' },
                'defend': { icon: 'ğŸ›¡ï¸', color: '#4444ff' },
                'buff': { icon: 'ğŸ’ª', color: '#44ff44' },
                'debuff': { icon: 'ğŸ’€', color: '#8844ff' },
                'heal': { icon: 'â¤ï¸', color: '#44ff44' },
                'special': { icon: 'âœ¨', color: '#ffaa44' },
                'stealth': { icon: 'ğŸ‘¤', color: '#666666' }
            };
            
            const intent = intentData[enemy.currentIntent] || intentData['attack'];
            intentIcon.textContent = intent.icon;
            intentIcon.style.color = intent.color;
            
            let intentDescription = '';
            switch(enemy.currentIntent) {
                case 'attack':
                    const damage = enemy.attack + Math.floor((gameState.level - 1) * 1.2);
                    intentDescription = `å‡†å¤‡æ”»å‡» (${damage}ä¼¤å®³)`;
                    break;
                case 'defend':
                    intentDescription = 'å‡†å¤‡é˜²å¾¡';
                    break;
                case 'buff':
                    intentDescription = 'å‡†å¤‡å¼ºåŒ–è‡ªèº«';
                    break;
                case 'debuff':
                    intentDescription = 'å‡†å¤‡æ–½åŠ è´Ÿé¢æ•ˆæœ';
                    break;
                case 'heal':
                    intentDescription = 'å‡†å¤‡æ²»ç–—';
                    break;
                case 'special':
                    intentDescription = 'å‡†å¤‡ä½¿ç”¨ç‰¹æ®Šèƒ½åŠ›';
                    break;
                case 'stealth':
                    intentDescription = 'å‡†å¤‡æ½œè¡Œ';
                    break;
            }
            
            intentText.textContent = intentDescription;
        }
        
        // é¢„æµ‹æ•Œäººæ„å›¾
        function predictEnemyIntent(enemy) {
            // æ ¹æ®æ•Œäººç±»å‹å’ŒçŠ¶æ€é¢„æµ‹ä¸‹å›åˆè¡ŒåŠ¨
            // æ·»åŠ å®‰å…¨æ£€æŸ¥ç¡®ä¿abilitieså­˜åœ¨
            const abilities = enemy.abilities || [];
            
            if (abilities.includes('stealth') && Math.random() < 0.3) {
                return 'stealth';
            }
            
            if (abilities.includes('heal') && enemy.hp < enemy.maxHp * 0.3 && Math.random() < 0.4) {
                return 'heal';
            }
            
            if (abilities.includes('rage') && enemy.hp < enemy.maxHp * 0.5 && Math.random() < 0.3) {
                return 'buff';
            }
            
            if (abilities.includes('poison') && Math.random() < 0.25) {
                return 'debuff';
            }
            
            if (abilities.includes('armor') && Math.random() < 0.2) {
                return 'defend';
            }
            
            if (abilities.includes('summon_minions') && Math.random() < 0.2) {
                return 'special';
            }
            
            // é»˜è®¤æ”»å‡»
            return 'attack';
        }
        
        // æ›´æ–°çŠ¶æ€æ•ˆæœæ˜¾ç¤º
        function updateStatusEffectsDisplay() {
            const playerEffectsContainer = document.getElementById('playerStatusEffects');
            const enemyEffectsContainer = document.getElementById('enemyStatusEffects');
            
            // æ¸…ç©ºç°æœ‰æ˜¾ç¤º
            playerEffectsContainer.innerHTML = '';
            enemyEffectsContainer.innerHTML = '';
            
            // ç©å®¶çŠ¶æ€æ•ˆæœ
            const playerEffects = [];
            
            if (gameState.playerBlock > 0) {
                playerEffects.push({ name: 'æŠ¤ç›¾', value: gameState.playerBlock, color: '#4ecdc4', icon: 'ğŸ›¡ï¸' });
            }
            
            if (gameState.stealthTurns > 0) {
                playerEffects.push({ name: 'æ½œè¡Œ', value: gameState.stealthTurns, color: '#666666', icon: 'ğŸ‘¤' });
            }
            
            if (gameState.playerThorns > 0) {
                playerEffects.push({ name: 'è†æ£˜', value: gameState.playerThorns, color: '#8B4513', icon: 'ğŸŒ¿' });
            }
            
            if (gameState.counterDamage > 0) {
                playerEffects.push({ name: 'åå‡»', value: gameState.counterDamage, color: '#ff6b6b', icon: 'âš”ï¸' });
            }
            
            // æ˜¾ç¤ºç©å®¶çŠ¶æ€æ•ˆæœ
            playerEffects.forEach(effect => {
                const effectElement = document.createElement('div');
                effectElement.style.cssText = `
                    background: ${effect.color}33;
                    border: 1px solid ${effect.color};
                    border-radius: 4px;
                    padding: 2px 6px;
                    color: white;
                    font-weight: bold;
                `;
                effectElement.textContent = `${effect.icon} ${effect.name} ${effect.value}`;
                playerEffectsContainer.appendChild(effectElement);
            });
            
            // æ•ŒäººçŠ¶æ€æ•ˆæœ
            const enemyEffects = [];
            
            if (gameState.enemyPoison > 0) {
                enemyEffects.push({ name: 'æ¯’ç´ ', value: gameState.enemyPoison, color: '#9b59b6', icon: 'â˜ ï¸' });
            }
            
            if (gameState.enemyBurn > 0) {
                enemyEffects.push({ name: 'ç‡ƒçƒ§', value: gameState.enemyBurn, color: '#e74c3c', icon: 'ğŸ”¥' });
            }
            
            if (gameState.enemyFrozen > 0) {
                enemyEffects.push({ name: 'å†°å†»', value: gameState.enemyFrozen, color: '#3498db', icon: 'â„ï¸' });
            }
            
            if (gameState.enemyCursed > 0) {
                enemyEffects.push({ name: 'è¯…å’’', value: gameState.enemyCursed, color: '#8e44ad', icon: 'ğŸ’€' });
            }
            
            if (gameState.enemyStealth > 0) {
                enemyEffects.push({ name: 'æ½œè¡Œ', value: gameState.enemyStealth, color: '#666666', icon: 'ğŸ‘¤' });
            }
            
            // æ˜¾ç¤ºæ•ŒäººçŠ¶æ€æ•ˆæœ
            enemyEffects.forEach(effect => {
                const effectElement = document.createElement('div');
                effectElement.style.cssText = `
                    background: ${effect.color}33;
                    border: 1px solid ${effect.color};
                    border-radius: 4px;
                    padding: 2px 6px;
                    color: white;
                    font-weight: bold;
                `;
                effectElement.textContent = `${effect.icon} ${effect.name} ${effect.value}`;
                enemyEffectsContainer.appendChild(effectElement);
            });
            
            // æ·»åŠ æ ‡ç­¾
            if (playerEffects.length > 0) {
                const label = document.createElement('div');
                label.textContent = 'ç©å®¶çŠ¶æ€:';
                label.style.cssText = 'width: 100%; color: #ffd700; font-weight: bold; margin-bottom: 4px;';
                playerEffectsContainer.insertBefore(label, playerEffectsContainer.firstChild);
            }
            
            if (enemyEffects.length > 0) {
                const label = document.createElement('div');
                label.textContent = 'æ•ŒäººçŠ¶æ€:';
                label.style.cssText = 'width: 100%; color: #ff6b6b; font-weight: bold; margin-bottom: 4px;';
                enemyEffectsContainer.insertBefore(label, enemyEffectsContainer.firstChild);
            }
        }

        // æ›´æ–°æ‰‹ç‰Œæ˜¾ç¤º
        function updateHandDisplay() {
            const handContainer = document.getElementById('hand');
            handContainer.innerHTML = '';
            
            // ç«‹å³æ›´æ–°ç‰Œåº“ä¿¡æ¯
            if (document.getElementById('drawPileInfo')) {
                document.getElementById('drawPileInfo').textContent = `ğŸƒ ç‰Œåº“: ${gameState.drawPile.length}å¼  | å¼ƒç‰Œå †: ${gameState.discardPile.length}å¼ `;
            }
            
            // ä½¿ç”¨å®šæ—¶å™¨åˆ›å»ºå¡ç‰Œé€ä¸€å‡ºç°çš„æ•ˆæœ
            let delay = 0;
            gameState.hand.forEach((cardName, index) => {
                setTimeout(() => {
                    const cardElement = createCardElement(cardName, () => playCard(index));
                    const card = cardDatabase[cardName];
                    if (gameState.energy < card.cost) {
                        // æ·»åŠ èƒ½é‡ä¸è¶³æ—¶çš„æ ·å¼æ•ˆæœ
                        cardElement.style.opacity = '0.5';
                        cardElement.style.cursor = 'not-allowed';
                        // ä½¿ç”¨CSSæ»¤é•œä½¿é¢œè‰²å˜æš—
                        cardElement.style.filter = 'brightness(0.7) grayscale(0.3)';
                    } else {
                        // ç¡®ä¿èƒ½é‡å……è¶³æ—¶æ¢å¤æ­£å¸¸æ ·å¼
                        cardElement.style.opacity = '1';
                        cardElement.style.cursor = 'pointer';
                        cardElement.style.filter = 'none';
                    }
                    
                    // ä¸ºæ¯å¼ å¡ç‰Œæ·»åŠ åŠ¨ç”»
                    cardElement.style.animation = 'fadeIn 0.3s ease-out forwards';
                    cardElement.style.opacity = '0';
                    cardElement.style.transform = 'translateY(20px)';
                    
                    handContainer.appendChild(cardElement);
                }, delay);
                
                // æ¯å¼ ç‰Œä¹‹é—´é—´éš”50æ¯«ç§’
                delay += 50;
            });
        }

        // æ‰“å‡ºå¡ç‰Œ
        function playCard(handIndex) {
            const cardName = gameState.hand[handIndex];
            const card = cardDatabase[cardName];
            
            let actualCost = card.cost;
            
            // ç°å®é‡æ„æ•ˆæœï¼šæœ¬å›åˆæ‰€æœ‰ç‰Œè´¹ç”¨-1
            if (gameState.realityRewrite) {
                actualCost = Math.max(0, actualCost - 1);
            }
            
            if (gameState.energy < actualCost) {
                addLog('èƒ½é‡ä¸è¶³ï¼');
                return;
            }
            
            // æ£€æŸ¥ææƒ§çŠ¶æ€
            if (gameState.fearThisTurn && card.type === 'attack') {
                addLog('ææƒ§çŠ¶æ€ä¸‹æ— æ³•ä½¿ç”¨æ”»å‡»ç‰Œï¼');
                return;
            }
            
            gameState.energy -= actualCost;
            gameState.cardsPlayedThisTurn = (gameState.cardsPlayedThisTurn || 0) + 1;
            
            // é£æš´ä¹‹å¿ƒæ•ˆæœï¼šæ¯æ‰“å‡ºä¸€å¼ ç‰Œè·å¾—1ç‚¹èƒ½é‡
            if (gameState.stormCore > 0) {
                gameState.energy += 1;
                gameState.stormCore--;
                addLog('é£æš´ä¹‹å¿ƒï¼šè·å¾—1ç‚¹èƒ½é‡ï¼');
            }
            const playedCard = gameState.hand.splice(handIndex, 1)[0];
            
            // å°†æ‰“å‡ºçš„å¡ç‰Œæ”¾å…¥å¼ƒç‰Œå †ï¼ˆé™¤éæ˜¯æ¶ˆè€—å¡ç‰Œï¼‰
            if (card.exhaust) {
                // æ¶ˆè€—å¡ç‰Œè¢«æ°¸ä¹…ç§»é™¤ï¼Œè®°å½•åˆ°exhaustedCardsä¸­
                gameState.exhaustedCards = gameState.exhaustedCards || [];
                gameState.exhaustedCards.push(playedCard);
            } else {
                // æ™®é€šå¡ç‰Œæ”¾å…¥å¼ƒç‰Œå †
                gameState.discardPile.push(playedCard);
            }
            
            // æ‰§è¡Œå¡ç‰Œæ•ˆæœ
            executeCardEffect(cardName, card);
            
            updateBattleUI();
            
            // ä¼ å¥‡å¡ç‰Œç‰¹æ®Šæ•ˆæœ
            if (card.rarity === 'legendary') {
                executeLegendaryCardEffect(cardName, card);
            }
            
            // æ£€æŸ¥BOSSé˜¶æ®µè½¬æ¢
            checkBossPhaseTransition();
            
            // æ£€æŸ¥æ•Œäººæ˜¯å¦æ­»äº¡
            if (gameState.currentEnemy.hp <= 0) {
                // æºåˆé­”é¾™ç‰¹æ®Šå¤„ç†ï¼šç¬¬ä¸€æ¡å‘½ç»“æŸåå¤æ´»è¿›å…¥ç¬¬4é˜¶æ®µ
                if (gameState.currentEnemy.name === 'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹' && gameState.currentEnemy.currentPhase < 3) {
                    // ç¬¬ä¸€æ¡å‘½ç»“æŸï¼Œå¤æ´»è¿›å…¥ç¬¬4é˜¶æ®µï¼ˆæ­»äº¡è½®å›ï¼‰
                    gameState.currentEnemy.hp = Math.floor(gameState.currentEnemy.maxHp * 0.6);
                    gameState.currentEnemy.currentPhase = 3;
                    gameState.currentEnemy.phaseTransitioned = true;
                    gameState.currentEnemy.rebirthCount = 1;
                    gameState.currentEnemy.phase4Turns = 0;
                    addLog(`ğŸ’€ ${gameState.currentEnemy.name} æ­»äº¡åå¤æ´»ï¼è¿›å…¥æ­»äº¡è½®å›é˜¶æ®µï¼`);
                    addLog(`æºåˆé­”é¾™è·å¾—äº†æ–°çš„åŠ›é‡ï¼Œç”Ÿå‘½æ¢å¤è‡³60%ï¼`);
                    updateEnemyUI();
                } else if (gameState.currentEnemy.abilities && gameState.currentEnemy.abilities.includes('revive') && !gameState.currentEnemy.hasRevived) {
                    // éª·é«…æˆ˜å£«é‡ç”Ÿç‰¹æ€§ï¼šæ­»äº¡åä»¥20%ç”Ÿå‘½å€¼å¤æ´»ä¸€æ¬¡
                    gameState.currentEnemy.hp = Math.floor(gameState.currentEnemy.maxHp * 0.2);
                    gameState.currentEnemy.hasRevived = true;
                    addLog(`ğŸ’€ ${gameState.currentEnemy.name} è§¦å‘äº†é‡ç”Ÿï¼ä»¥20%ç”Ÿå‘½å€¼å¤æ´»ï¼`);
                    updateEnemyUI();
                } else {
                    victory();
                }
            }
        }

        // æ˜¾ç¤ºä¼¤å®³æ•°å­—
        function showDamageNumber(damage, isHeal = false, target = 'enemy') {
            const targetElement = target === 'enemy' ? 
                document.querySelector('.enemy-display') : 
                document.querySelector('.player-status');
            
            if (!targetElement) return;
            
            const damageElement = document.createElement('div');
            damageElement.className = isHeal ? 'heal-number' : 'damage-number';
            damageElement.textContent = isHeal ? `+${damage}` : `-${damage}`;
            
            const rect = targetElement.getBoundingClientRect();
            damageElement.style.left = `${rect.left + rect.width / 2 - 20}px`;
            damageElement.style.top = `${rect.top + rect.height / 2}px`;
            
            document.body.appendChild(damageElement);
            
            setTimeout(() => {
                if (damageElement.parentNode) {
                    damageElement.parentNode.removeChild(damageElement);
                }
            }, 1000);
        }
        
        // æ·»åŠ éœ‡åŠ¨æ•ˆæœ
        function addShakeEffect(target = 'enemy') {
            const targetElement = target === 'enemy' ? 
                document.querySelector('.enemy') : 
                document.querySelector('.player-status');
            
            if (targetElement) {
                targetElement.classList.add('shake-animation');
                setTimeout(() => {
                    targetElement.classList.remove('shake-animation');
                }, 500);
            }
        }
        
        // æ·»åŠ é—ªçº¢æ•ˆæœ
        function addFlashEffect(target = 'enemy') {
            const targetElement = target === 'enemy' ? 
                document.querySelector('.enemy') : 
                document.querySelector('.player-status');
            
            if (targetElement) {
                targetElement.classList.add('flash-red');
                setTimeout(() => {
                    targetElement.classList.remove('flash-red');
                }, 300);
            }
        }

        // æ£€æŸ¥BOSSé˜¶æ®µè½¬æ¢
        function checkBossPhaseTransition() {
            const enemy = gameState.currentEnemy;
            if (!enemy.isBoss || !enemy.phases) return;
            
            const currentHpRatio = enemy.hp / enemy.maxHp;
            const currentPhase = enemy.phases[enemy.currentPhase];
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
            for (let i = enemy.currentPhase + 1; i < enemy.phases.length; i++) {
                const nextPhase = enemy.phases[i];
                if (currentHpRatio <= nextPhase.hpThreshold) {
                    enemy.currentPhase = i;
                    enemy.phaseTransitioned = true;
                    addLog(`ğŸ”¥ ${enemy.name} è¿›å…¥ ${nextPhase.name}ï¼`);
                    addLog(`${nextPhase.description}`);
                    
                    // é˜¶æ®µè½¬æ¢ç‰¹æ®Šæ•ˆæœ
                    executeBossPhaseTransition(enemy, nextPhase);
                    break;
                }
            }
        }
        
        // æ‰§è¡ŒBOSSé˜¶æ®µè½¬æ¢æ•ˆæœ
        function executeBossPhaseTransition(enemy, phase) {
            // æ ¹æ®ä¸åŒBOSSå’Œé˜¶æ®µæ‰§è¡Œç‰¹æ®Šæ•ˆæœ
            if (enemy.name === 'æš—å½±é¾™ç‹') {
                if (phase.name === 'æ„¤æ€’é˜¶æ®µ') {
                    addLog('æš—å½±é¾™ç‹å¬å”¤äº†æš—å½±åˆ†èº«ï¼');
                    gameState.shadowClones = 2;
                } else if (phase.name === 'ç»æœ›é˜¶æ®µ') {
                    addLog('ç°å®å¼€å§‹æ‰­æ›²ï¼æ—¶é—´å˜å¾—ä¸ç¨³å®šï¼');
                    gameState.timeDistortion = true;
                }
            } else if (enemy.name === 'å…ƒç´ é¢†ä¸»') {
                if (phase.name === 'å†°éœœå½¢æ€') {
                    addLog('æˆ˜åœºè¢«å†°éœœè¦†ç›–ï¼');
                    gameState.frozenField = 3;
                } else if (phase.name === 'é›·ç”µå½¢æ€') {
                    addLog('é›·ç”µé£æš´é™ä¸´ï¼');
                    gameState.stormField = 3;
                }
            } else if (enemy.name === 'è™šç©ºå›ä¸»') {
                if (phase.name === 'èƒ½é‡å½¢æ€') {
                    addLog('è™šç©ºå›ä¸»å˜ä¸ºçº¯èƒ½é‡ä½“ï¼ç‰©ç†æ”»å‡»æ•ˆæœå‡åŠï¼');
                    gameState.energyForm = true;
                } else if (phase.name === 'ç»ˆæå½¢æ€') {
                    addLog('ç°å®å¼€å§‹å´©å¡Œï¼æ¯å›åˆå—åˆ°è™šç©ºä¼¤å®³ï¼');
                    gameState.realityCollapse = true;
                }
            } else if (enemy.name === 'åˆ›ä¸–ç¥') {
                if (phase.name === 'è¯•ç‚¼é˜¶æ®µ') {
                    addLog('åˆ›ä¸–ç¥å±•ç°åˆ›é€ ä¹‹åŠ›ï¼è·å¾—å¼ºå¤§æŠ¤ç›¾ï¼');
                    gameState.divineShield = 50;
                } else if (phase.name === 'ç»ˆæè¯•ç‚¼') {
                    addLog('ç”Ÿæ­»è½®å›å¼€å§‹ï¼æˆ˜æ–—è¿›å…¥æœ€ç»ˆé˜¶æ®µï¼');
                    gameState.rebirthCycle = true;
                }
            } else if (enemy.name === 'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹') {
                if (phase.name === 'å…ƒç´ èåˆ') {
                    addLog('å››å¤§å…ƒç´ ä¹‹åŠ›èåˆï¼æºåˆé­”é¾™è·å¾—å…ƒç´ å¼ºåŒ–ï¼');
                    enemy.attack = Math.floor(enemy.attack * 1.2); // æ”»å‡»åŠ›æå‡20%
                } else if (phase.name === 'ä¸–ç•Œæœ«æ—¥') {
                    addLog('ä¸–ç•Œæœ«æ—¥é™ä¸´ï¼æºåˆé­”é¾™è¿›å…¥å¤±æ§çŠ¶æ€ï¼');
                    gameState.apocalypseAura = true; // æ¯å›åˆç»“æŸæ—¶å¯¹ç©å®¶é€ æˆä¼¤å®³
                } else if (phase.name === 'æ­»äº¡è½®å›') {
                    addLog('æ­»äº¡è½®å›æ¿€æ´»ï¼æºåˆé­”é¾™è·å¾—æ­»äº¡ä¹‹åŠ›ï¼');
                    enemy.attack = Math.floor(enemy.attack * 1.5); // æ”»å‡»åŠ›æå‡50%
                    gameState.undeadDragon = true; // è·å¾—ä¸æ­»ç‰¹æ€§
                } else if (phase.name === 'ç»ˆç„‰æ—¶åˆ»') {
                    addLog('ç»ˆç„‰æ—¶åˆ»åˆ°æ¥ï¼æºåˆé­”é¾™æˆä¸ºæ— æ•Œçš„é¾™ç¥ï¼');
                    enemy.attack = Math.floor(enemy.attack * 2); // æ”»å‡»åŠ›ç¿»å€
                    gameState.dragonGodInvincible = 1; // ç¬¬ä¸€å›åˆæ— æ•Œ
                }
            }
        }

        // æ‰§è¡Œä¼ å¥‡å¡ç‰Œæ•ˆæœ
        function executeLegendaryCardEffect(cardName, card) {
            switch(cardName) {
                case 'æš—å½±æ”¯é…':
                    gameState.shadowClones = (gameState.shadowClones || 0) + 1;
                    addLog('å¬å”¤äº†æš—å½±åˆ†èº«ååŠ©æˆ˜æ–—ï¼');
                    break;
                case 'é¾™ç‹ä¹‹æ€’':
                    addLog('é¾™æ¯å¸­å·æˆ˜åœºï¼');
                    break;
                case 'æ—¶ç©ºæ‰­æ›²':
                    gameState.extraTurn = true;
                    addLog('æ—¶ç©ºæ‰­æ›²ï¼è·å¾—é¢å¤–å›åˆï¼');
                    break;
                case 'å…ƒç´ æŒæ§':
                    const elementalDamage = (gameState.enemyBurn || 0) * 5 + (gameState.enemyFrozen || 0) * 8 + (gameState.enemyPoison || 0) * 3;
                    if (elementalDamage > 0) {
                        gameState.currentEnemy.hp -= elementalDamage;
                        addLog(`å…ƒç´ æŒæ§é€ æˆäº† ${elementalDamage} ç‚¹é¢å¤–ä¼¤å®³ï¼`);
                    }
                    break;
                case 'é£æš´ä¹‹å¿ƒ':
                    gameState.stormCore = 5; // æœ¬å›åˆæœ€å¤šè·å¾—5ç‚¹é¢å¤–èƒ½é‡
                    addLog('é£æš´ä¹‹å¿ƒæ¿€æ´»ï¼æ¯æ‰“å‡ºä¸€å¼ ç‰Œè·å¾—1ç‚¹èƒ½é‡ï¼');
                    break;
                case 'æ°¸æ’å†°æ™¶':
                    gameState.eternalIce = true;
                    gameState.playerBlock = (gameState.playerBlock || 0) + 10;
                    addLog('æ°¸æ’å†°æ™¶æ¿€æ´»ï¼è·å¾—æ°¸ä¹…æŠ¤ç›¾æ•ˆæœï¼');
                    break;
                case 'è™šç©ºæŒæ¡':
                    const removedEffects = (gameState.enemyPoison || 0) + (gameState.enemyBurn || 0) + (gameState.enemyFrozen || 0);
                    gameState.enemyPoison = 0;
                    gameState.enemyBurn = 0;
                    gameState.enemyFrozen = 0;
                    gameState.currentEnemy.hp -= removedEffects * 3;
                    addLog(`è™šç©ºæŒæ¡ç§»é™¤äº†æ•Œäººæ‰€æœ‰æ•ˆæœå¹¶é€ æˆ ${removedEffects * 3} ç‚¹ä¼¤å®³ï¼`);
                    break;
                case 'ç°å®é‡æ„':
                    // é‡æ–°æ´—ç‰Œå¹¶æŠ½ç‰Œ
                    gameState.discardPile.push(...gameState.hand);
                    gameState.hand = [];
                    gameState.drawPile.push(...gameState.discardPile);
                    gameState.discardPile = [];
                    // æ´—ç‰Œ
                    for (let i = gameState.drawPile.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [gameState.drawPile[i], gameState.drawPile[j]] = [gameState.drawPile[j], gameState.drawPile[i]];
                    }
                    drawCards(5);
                    gameState.realityRewrite = true; // æœ¬å›åˆæ‰€æœ‰ç‰Œè´¹ç”¨-1
                    addLog('ç°å®é‡æ„ï¼é‡æ–°æ´—ç‰Œå¹¶æŠ½5å¼ ç‰Œï¼Œæœ¬å›åˆæ‰€æœ‰ç‰Œè´¹ç”¨-1ï¼');
                    break;
                case 'å­˜åœ¨æ¹®ç­':
                    const eraseDamage = Math.floor(gameState.currentEnemy.hp * 0.5);
                    gameState.currentEnemy.hp -= eraseDamage;
                    addLog(`å­˜åœ¨æ¹®ç­é€ æˆäº† ${eraseDamage} ç‚¹çœŸå®ä¼¤å®³ï¼`);
                    break;
                case 'åˆ›ä¸–ä¹‹åŠ›':
                    gameState.playerHp = gameState.playerMaxHp;
                    // è·å¾—æ‰€æœ‰æ­£é¢æ•ˆæœ
                    let strengthBuff = gameState.buffs.find(b => b.name === 'åŠ›é‡');
                    if (strengthBuff) strengthBuff.stacks += 3;
                    else gameState.buffs.push({ name: 'åŠ›é‡', stacks: 3, type: 'power' });
                    
                    let armorBuff = gameState.buffs.find(b => b.name === 'æŠ¤ç”²');
                    if (armorBuff) armorBuff.stacks += 2;
                    else gameState.buffs.push({ name: 'æŠ¤ç”²', stacks: 2, type: 'armor' });
                    
                    addLog('åˆ›ä¸–ä¹‹åŠ›ï¼å®Œå…¨æ¢å¤å¹¶è·å¾—å¼ºå¤§å¢ç›Šï¼');
                    break;
                case 'ç¥åœ£å®¡åˆ¤':
                    const judgmentDamage = gameState.currentEnemy.maxHp - gameState.currentEnemy.hp;
                    gameState.currentEnemy.hp -= judgmentDamage;
                    addLog(`ç¥åœ£å®¡åˆ¤é€ æˆäº† ${judgmentDamage} ç‚¹å®¡åˆ¤ä¼¤å®³ï¼`);
                    break;
                case 'æ°¸æ’è½®å›':
                    gameState.eternalCycle = true;
                    addLog('æ°¸æ’è½®å›æ¿€æ´»ï¼æ­»äº¡æ—¶å°†å¤æ´»å¹¶è·å¾—æ‰€æœ‰ä¼ å¥‡å¡ç‰Œï¼');
                    break;
                case 'è‡ªç„¶ä¹‹åŠ›':
                    // åŸºç¡€ä¼¤å®³
                    let natureDamage = card.base_damage || 10;
                    // è®¡ç®—è‡ªç„¶æ•ˆæœï¼ˆæµè¡€å’Œæ¯’ç´ ï¼‰çš„æ€»å±‚æ•°
                    const naturalEffects = (gameState.enemyBleed || 0) + (gameState.enemyPoison || 0);
                    // æ¯å±‚è‡ªç„¶æ•ˆæœé€ æˆé¢å¤–ä¼¤å®³
                    const bonusDamage = naturalEffects * (card.dot_multiplier || 2);
                    // æ€»ä¼¤å®³
                    const totalNatureDamage = natureDamage + bonusDamage;
                    
                    gameState.currentEnemy.hp -= totalNatureDamage;
                    addLog(`è‡ªç„¶ä¹‹åŠ›ï¼šé€ æˆ${natureDamage}ç‚¹åŸºç¡€ä¼¤å®³ï¼Œæ¯å±‚è‡ªç„¶æ•ˆæœ(${naturalEffectså±‚})é€ æˆ${bonusDamage}ç‚¹é¢å¤–ä¼¤å®³ï¼Œæ€»è®¡${totalNatureDamage}ç‚¹ä¼¤å®³ï¼`);
                    
                    // åŒæ—¶è·å¾—æŠ¤ç›¾å’Œæ³•æœ¯å¼ºåº¦åŠ æˆ
                    const shieldBonus = Math.floor(naturalEffects * 2);
                    gameState.playerBlock = (gameState.playerBlock || 0) + shieldBonus;
                    addLog(`è‡ªç„¶ä¹‹åŠ›ï¼šè·å¾—${shieldBonus}ç‚¹æŠ¤ç›¾ï¼`);
                    
                    const spellPowerBonus = Math.min(3, Math.floor(naturalEffects / 3));
                    if (spellPowerBonus > 0) {
                        gameState.buffs.push({ name: 'æ³•æœ¯å¼ºåº¦', stacks: spellPowerBonus, type: 'spellpower' });
                        addLog(`è‡ªç„¶ä¹‹åŠ›ï¼šè·å¾—${spellPowerBonus}å±‚æ³•æœ¯å¼ºåº¦ï¼`);
                    }
                    break;
                case 'æˆ˜äº‰ä¹‹ç¥':
                    // åŸºç¡€ä¼¤å®³
                    let warDamage = card.base_damage || 15;
                    // è·å–å½“å‰åŠ›é‡å±‚æ•°
                    const warStrengthBuff = gameState.buffs.find(b => b.name === 'åŠ›é‡' || b.type === 'strength');
                    const strengthStacks = warStrengthBuff ? warStrengthBuff.stacks : 0;
                    // æ¯å±‚åŠ›é‡é€ æˆé¢å¤–ä¼¤å®³
                    const strengthBonus = strengthStacks * (card.strength_multiplier || 3);
                    // æ€»ä¼¤å®³
                    const totalWarDamage = warDamage + strengthBonus;
                    
                    gameState.currentEnemy.hp -= totalWarDamage;
                    addLog(`æˆ˜äº‰ä¹‹ç¥ï¼šé€ æˆ${warDamage}ç‚¹åŸºç¡€ä¼¤å®³ï¼Œæ¯å±‚åŠ›é‡(${strengthStackså±‚})é€ æˆ${strengthBonus}ç‚¹é¢å¤–ä¼¤å®³ï¼Œæ€»è®¡${totalWarDamage}ç‚¹ä¼¤å®³ï¼`);
                    
                    // æ¶ˆè€—æ‰€æœ‰åŠ›é‡å±‚æ•°
                    if (warStrengthBuff) {
                        warStrengthBuff.stacks = 0;
                        // ä½†ä¿ç•™buffå¯¹è±¡ä»¥ä¾¿åç»­æ·»åŠ æ–°çš„åŠ›é‡åŠ æˆ
                    }
                    
                    // å¯¹æ‰€æœ‰å…¶ä»–æ•Œäººé€ æˆæº…å°„ä¼¤å®³
                    if (gameState.enemies && gameState.enemies.length > 1) {
                        const splashDamage = Math.floor(totalWarDamage / 3);
                        let splashTargets = 0;
                        for (let i = 0; i < gameState.enemies.length; i++) {
                            if (gameState.enemies[i].hp > 0 && gameState.enemies[i] !== gameState.currentEnemy) {
                                gameState.enemies[i].hp -= splashDamage;
                                splashTargets++;
                            }
                        }
                        if (splashTargets > 0) {
                            addLog(`æˆ˜äº‰ä¹‹ç¥ï¼šå¯¹å…¶ä»–${splashTargets}ä¸ªæ•Œäººé€ æˆ${splashDamage}ç‚¹æº…å°„ä¼¤å®³ï¼`);
                        }
                    }
                    break;
            }
        }

        // æ‰§è¡Œå¡ç‰Œæ•ˆæœ
        function executeCardEffect(cardName, card) {
            let damage = 0;
            
            // è¯…å’’å¡ç‰Œæ•ˆæœ
            if (card.type === 'curse') {
                if (card.self_damage) {
                    gameState.playerHp -= card.self_damage;
                    showDamageNumber(card.self_damage, false, 'player');
                    addShakeEffect('player');
                    addFlashEffect('player');
                    addLog(`${cardName} å¯¹è‡ªå·±é€ æˆäº† ${card.self_damage} ç‚¹ä¼¤å®³ï¼`);
                }
                if (card.weakness) {
                    let weaknessBuff = gameState.buffs.find(b => b.name === 'è™šå¼±');
                    if (weaknessBuff) {
                        weaknessBuff.stacks += card.weakness;
                    } else {
                        gameState.buffs.push({ name: 'è™šå¼±', stacks: card.weakness, type: 'debuff' });
                    }
                    addLog(`${cardName} ä½¿ä½ è™šå¼±äº† ${card.weakness} ç‚¹ï¼`);
                }
                if (card.random_cost) {
                    const extraCost = Math.floor(Math.random() * 3) + 1;
                    gameState.energy = Math.max(0, gameState.energy - extraCost);
                    addLog(`${cardName} é¢å¤–æ¶ˆè€—äº† ${extraCost} ç‚¹èƒ½é‡ï¼`);
                }
                if (card.fear) {
                    gameState.fearThisTurn = true;
                    addLog(`${cardName} è®©ä½ ææƒ§ï¼Œæ— æ³•ä½¿ç”¨æ”»å‡»ç‰Œï¼`);
                }
                if (card.cost > 0 && !card.self_damage && !card.weakness && !card.random_cost) {
                    addLog(`${cardName} æµªè´¹äº† ${card.cost} ç‚¹èƒ½é‡ï¼`);
                }
                return;
            }
            
            // å¤„ç†æ‰€æœ‰ç±»å‹å¡ç‰Œçš„self_damageæ•ˆæœï¼ˆéè¯…å’’å¡ç‰Œï¼‰
            if (card.self_damage) {
                gameState.playerHp -= card.self_damage;
                showDamageNumber(card.self_damage, false, 'player');
                addShakeEffect('player');
                addFlashEffect('player');
                addLog(`${cardName} å¯¹è‡ªå·±é€ æˆäº† ${card.self_damage} ç‚¹ä¼¤å®³ï¼`);
            }
            
            // å¤„ç†é™·é˜±å¡ç‰Œ
            if (card.trap) {
                gameState.trapActive = true;
                gameState.trapType = card.id || cardName;
                addLog(`ä½ è®¾ç½®äº†ä¸€ä¸ª${cardName}ï¼`);
                // é™·é˜±å¡ç‰Œä¸ç«‹å³æ‰§è¡Œä¼¤å®³å’Œæ•ˆæœï¼Œè€Œæ˜¯åœ¨æ•Œäººå›åˆè§¦å‘
                return;
            }
            
            // è§’è‰²è¢«åŠ¨æŠ€èƒ½å¤„ç†
            if (gameState.passiveAbility === 'combo_mastery' && gameState.firstCardThisTurn) {
                gameState.energy += 1; // è¿”è¿˜1ç‚¹èƒ½é‡
                gameState.firstCardThisTurn = false;
                addLog('è¿å‡»ç²¾é€šï¼šç¬¬ä¸€å¼ ç‰Œæ¶ˆè€—-1ï¼');
            }
            
            if (gameState.passiveAbility === 'arcane_intellect' && card.type === 'magic') {
                gameState.spellsPlayedThisTurn++;
                if (gameState.spellsPlayedThisTurn % 2 === 0) {
                    drawCards(1);
                    addLog('å¥¥æœ¯æ™ºæ…§ï¼šæŠ½1å¼ ç‰Œï¼');
                }
            }
            
            if (gameState.passiveAbility === 'precision_shot' && card.range && gameState.firstRangedAttackThisTurn) {
                damage = Math.floor(damage * 1.5);
                gameState.firstRangedAttackThisTurn = false;
                addLog('ç²¾å‡†å°„å‡»ï¼šè¿™å‘è¿œç¨‹æ”»å‡»é€ æˆ1.5å€ä¼¤å®³ï¼');
            }
            
            // æœ¯å£«è¢«åŠ¨ï¼šé‚ªèƒ½å¢å¹…
            if (gameState.passiveAbility === 'demonic_amplification' && card.self_damage) {
                gameState.demonicEnergy = (gameState.demonicEnergy || 0) + 1;
                addLog(`é‚ªèƒ½å¢å¹…ï¼šè·å¾—1å±‚é‚ªèƒ½ï¼Œå½“å‰${gameState.demonicEnergy}å±‚ï¼`);
            }
            
            if (card.damage) {
                damage = card.damage;
                
                // åº”ç”¨è§’è‰²åŠ æˆ
                if (card.type === 'attack' && gameState.selectedCharacter === 'warrior') {
                    damage += characters.warrior.attackBonus;
                }
                if (card.type === 'magic' && gameState.selectedCharacter === 'mage') {
                    damage += characters.mage.spellPower;
                }
                if (card.range && gameState.selectedCharacter === 'hunter') {
                    damage += characters.hunter.rangeBonus;
                    
                    // åº”ç”¨ç²¾å‡†æ•ˆæœï¼ˆé¹°çœ¼ï¼‰
                    if (gameState.precisionStacks > 0) {
                        const precisionBonus = gameState.precisionStacks * 4;
                        damage += precisionBonus;
                        gameState.precisionStacks = 0;
                        addLog(`ç²¾å‡†æ•ˆæœï¼šé¢å¤–é€ æˆ${precisionBonus}ç‚¹ä¼¤å®³ï¼`);
                    }
                }
                
                // åº”ç”¨çŒäººæ ‡è®°æ•ˆæœ
                if (gameState.enemyMarked && card.type === 'attack') {
                    damage += 3;
                    addLog(`çŒäººæ ‡è®°ï¼šé¢å¤–é€ æˆ3ç‚¹ä¼¤å®³ï¼`);
                    
                    // ç„å‡†å°„å‡»ç‰¹æ®Šæ•ˆæœï¼šå¯¹æ ‡è®°çš„æ•Œäººä¼¤å®³ç¿»å€
                    if (card.precision) {
                        damage *= 2;
                        addLog(`ç„å‡†å°„å‡»ï¼šå¯¹æ ‡è®°çš„æ•Œäººä¼¤å®³ç¿»å€ï¼`);
                    }
                }
                // éª‘å£«ç¥åœ£ä¼¤å®³åŠ æˆ
                if (card.holy && gameState.selectedCharacter === 'knight' && characters.knight) {
                    damage += (characters.knight.holyBonus || 0);
                }
                // å…¨å±€é‚ªèƒ½ä¼¤å®³åŠ æˆ
                if (gameState.felPower && gameState.selectedCharacter === 'warlock') {
                    const felBonus = Math.floor(damage * gameState.felPower);
                    damage += felBonus;
                    addLog(`é‚ªèƒ½å¢å¹…ï¼šé¢å¤–é€ æˆ${felBonus}ç‚¹ä¼¤å®³ï¼`);
                }
                // æœ¯å£«é‚ªèƒ½ä¼¤å®³åŠ æˆ
                if (gameState.selectedCharacter === 'warlock' && gameState.demonicEnergy > 0) {
                    damage += gameState.demonicEnergy;
                }
                
                // åº”ç”¨buffåŠ æˆ - åŒæ—¶å¤„ç†nameä¸º'åŠ›é‡'å’Œtypeä¸º'strength'çš„buff
                const strengthBuff = gameState.buffs.find(b => b.name === 'åŠ›é‡' || b.type === 'strength');
                if (strengthBuff && (card.type === 'attack' || card.type === 'magic')) {
                    damage += strengthBuff.stacks * 2;
                }
                
                // åº”ç”¨è™šå¼±å‡ç›Š
                const weaknessBuff = gameState.buffs.find(b => b.name === 'è™šå¼±');
                if (weaknessBuff && card.type === 'attack') {
                    damage = Math.max(1, damage - weaknessBuff.stacks);
                }
                
                // å…¨å±€æš´å‡»å‡ ç‡
                if (gameState.critChance && Math.random() < gameState.critChance) {
                    damage = Math.floor(damage * 1.5);
                    addLog('æš´å‡»ï¼');
                }
                
                // ç›—è´¼æš´å‡»å‡ ç‡
                else if (gameState.selectedCharacter === 'rogue' && Math.random() < characters.rogue.critChance) {
                    damage = Math.floor(damage * 1.5);
                    addLog('æš´å‡»ï¼');
                }
                
                // ç‰¹æ®Šæš´å‡»æ•ˆæœ
                if (card.crit_bonus && Math.random() < card.crit_bonus) {
                    damage *= 2;
                    addLog('è‡´å‘½æš´å‡»ï¼');
                }
                
                // æ½œè¡ŒåŠ æˆ
                if (card.stealth_bonus && gameState.stealthTurns > 0) {
                    damage *= 2;
                    addLog('æ½œè¡Œæ”»å‡»ï¼ä¼¤å®³ç¿»å€ï¼');
                }
                
                // é—ªç”µé“¾æ•ˆæœ
                if (card.chain) {
                    const spellsInHand = gameState.hand.filter(cardName => cardDatabase[cardName].type === 'magic').length;
                    damage += spellsInHand * 2;
                    addLog(`é—ªç”µé“¾ï¼šæ‰‹ç‰Œä¸­æœ‰${spellsInHand}å¼ æ³•æœ¯ç‰Œï¼Œé¢å¤–é€ æˆ${spellsInHand * 2}ç‚¹ä¼¤å®³ï¼`);
                }
                
                // è¿å‡»æ•ˆæœ
                if (card.combo) {
                    const comboCount = gameState.comboThisTurn || 0;
                    const comboBonus = gameState.comboBonus || 0;
                    
                    if (card.type === 'attack') {
                        const damageBonus = Math.floor(3 * (1 + comboBonus));
                        damage += damageBonus; // è¿å‡»æ”»å‡»ç‰Œé¢å¤–ä¼¤å®³
                        addLog(`è¿å‡»ï¼šé¢å¤–é€ æˆ${damageBonus}ç‚¹ä¼¤å®³${comboBonus > 0 ? 'ï¼ˆè¿å‡»å¤§å¸ˆå¢å¼ºï¼‰' : ''}ï¼`);
                    } else if (card.type === 'defense') {
                        const blockBonus = Math.floor(4 * (1 + comboBonus));
                        card.block = (card.block || 0) + blockBonus; // è¿å‡»é˜²å¾¡ç‰Œé¢å¤–æŠ¤ç›¾
                        addLog(`è¿å‡»ï¼šé¢å¤–è·å¾—${blockBonus}ç‚¹æŠ¤ç›¾${comboBonus > 0 ? 'ï¼ˆè¿å‡»å¤§å¸ˆå¢å¼ºï¼‰' : ''}ï¼`);
                    }
                    gameState.comboThisTurn = comboCount + 1;
                }
                
                // æš´å‡»æ•ˆæœ
                if (card.crit && Math.random() < 0.5) {
                    damage *= 2;
                    addLog('æš´å‡»ï¼');
                }
                
                // å„è¿æ•ˆæœï¼šå‡åŠæ‰€æœ‰æ•ˆæœ
                let actualDamage = damage;
                if (gameState.badLuckActive > 0) {
                    actualDamage = Math.floor(actualDamage / 2);
                }
                
                // æ³•æœ¯å¼ºåº¦åŠ æˆ
                const spellPowerBuff = gameState.buffs.find(b => b.type === 'spellpower');
                if (spellPowerBuff && card.type === 'magic') {
                    actualDamage += spellPowerBuff.stacks;
                }
                
                // å…¨å±€æ³•æœ¯ç²¾é€šåŠ æˆ
                if (gameState.spellPower && card.type === 'magic') {
                    const spellBonus = Math.floor(actualDamage * gameState.spellPower);
                    actualDamage += spellBonus;
                    addLog(`æ³•æœ¯ç²¾é€šï¼šé¢å¤–é€ æˆ${spellBonus}ç‚¹ä¼¤å®³ï¼`);
                }
                
                // é™„åŠ ç›®æ ‡æœ€å¤§ç”Ÿå‘½å€¼ç™¾åˆ†æ¯”ä¼¤å®³
                if (card.maxHealthBonus && gameState.currentEnemy) {
                    const healthBonus = Math.floor(gameState.currentEnemy.maxHp * card.maxHealthBonus);
                    actualDamage += healthBonus;
                    addLog(`é™„åŠ ä¼¤å®³ï¼šé€ æˆç›®æ ‡æœ€å¤§ç”Ÿå‘½å€¼${Math.round(card.maxHealthBonus * 100)}%çš„é¢å¤–ä¼¤å®³(${healthBonus}ç‚¹)ï¼`);
                }
                
                // æºåˆé­”é¾™é³ç‰‡æŠ¤ç”²å‡ä¼¤æ•ˆæœ
                const enemy = gameState.currentEnemy;
                if (enemy && enemy.name === 'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹' && gameState.scaleArmor > 0) {
                    const armorReduction = Math.min(actualDamage, gameState.scaleArmor * 3);
                    actualDamage = Math.max(1, actualDamage - armorReduction);
                    addLog(`æºåˆé­”é¾™çš„é³ç‰‡æŠ¤ç”²å‡å°‘äº† ${armorReduction} ç‚¹ä¼¤å®³ï¼`);
                }
                
                // éª¨ç”²å‡ä¼¤æ•ˆæœ
                if (enemy && enemy.abilities && enemy.abilities.includes('bone_armor')) {
                    const boneArmorReduction = Math.min(actualDamage, 3);
                    actualDamage = Math.max(1, actualDamage - boneArmorReduction);
                    addLog(`éª¨ç”²å‡å°‘äº† ${boneArmorReduction} ç‚¹ä¼¤å®³ï¼`);
                }
                
                // å†°ç”²å‡ä¼¤æ•ˆæœ
                if (enemy && enemy.abilities && enemy.abilities.includes('ice_armor')) {
                    const iceArmorReduction = Math.min(actualDamage, 5);
                    actualDamage = Math.max(1, actualDamage - iceArmorReduction);
                    addLog(`å†°ç”²å‡å°‘äº† ${iceArmorReduction} ç‚¹ä¼¤å®³ï¼`);
                }
                
                // ç«ç›¾æ•ˆæœï¼šå—åˆ°ä¼¤å®³æ—¶åå¼¹ç‡ƒçƒ§ä¼¤å®³
                if (enemy && enemy.abilities && enemy.abilities.includes('fire_shield')) {
                    const fireShieldDamage = 2;
                    gameState.enemyBurn = (gameState.enemyBurn || 0) + fireShieldDamage;
                    addLog(`ç«ç›¾è§¦å‘ï¼å¯¹ç©å®¶é€ æˆ ${fireShieldDamage} ç‚¹ç‡ƒçƒ§ä¼¤å®³ï¼`);
                }
                
                // ç©¿åˆºæ•ˆæœï¼ˆæ— è§†æŠ¤ç›¾ï¼‰
                if (card.pierce) {
                    gameState.currentEnemy.hp -= actualDamage;
                    showDamageNumber(actualDamage);
                    addShakeEffect('enemy');
                    addFlashEffect('enemy');
                    addLog(`${cardName} ç©¿åˆºæ”»å‡»é€ æˆäº† ${actualDamage} ç‚¹ä¼¤å®³ï¼`);
                    
                    // çµé­‚é“¾æ¥æ•ˆæœ
                    if (gameState.soulLinkActive) {
                        const sharedDamage = Math.floor(actualDamage / 3);
                        gameState.playerHp -= sharedDamage;
                        addLog(`çµé­‚é“¾æ¥ï¼šä½ å—åˆ°äº† ${sharedDamage} ç‚¹å…±äº«ä¼¤å®³ï¼`);
                    }
                } else {
                    // å¤šæ®µæ”»å‡»
                    const hits = card.hits || 1;
                    let totalDamage = 0;
                    for (let i = 0; i < hits; i++) {
                        gameState.currentEnemy.hp -= actualDamage;
                        totalDamage += actualDamage;
                        if (hits > 1) {
                            addLog(`${cardName} ç¬¬${i+1}å‡»é€ æˆäº† ${actualDamage} ç‚¹ä¼¤å®³ï¼`);
                        }
                        
                        // çµé­‚é“¾æ¥æ•ˆæœ
                        if (gameState.soulLinkActive) {
                            const sharedDamage = Math.floor(actualDamage / 3);
                            gameState.playerHp -= sharedDamage;
                            if (hits === 1) {
                                addLog(`çµé­‚é“¾æ¥ï¼šä½ å—åˆ°äº† ${sharedDamage} ç‚¹å…±äº«ä¼¤å®³ï¼`);
                            }
                        }
                    }
                    showDamageNumber(totalDamage);
                    addShakeEffect('enemy');
                    addFlashEffect('enemy');
                    if (hits === 1) {
                        addLog(`${cardName} å¯¹æ•Œäººé€ æˆäº† ${actualDamage} ç‚¹ä¼¤å®³ï¼`);
                    }
                }
                
                // æ–©é¦–æ•ˆæœ
                if (card.execute && gameState.currentEnemy.hp / gameState.currentEnemy.maxHp <= card.execute) {
                    gameState.currentEnemy.hp = 0;
                    showDamageNumber(9999);
                    addShakeEffect('enemy');
                    addLog(`${cardName} è§¦å‘æ–©é¦–æ•ˆæœï¼æ•Œäººè¢«ç§’æ€ï¼`);
                }
                
                // å¸è¡€æ•ˆæœ
                if (card.lifesteal || (gameState.relics && gameState.relics.includes('å¸è¡€é¬¼ä¹‹ç‰™'))) {
                    let healAmount;
                    if (card.lifesteal && (gameState.relics && gameState.relics.includes('å¸è¡€é¬¼ä¹‹ç‰™'))) {
                        // åŒæ—¶æœ‰å¡ç‰Œå¸è¡€å’Œå¸è¡€é¬¼ä¹‹ç‰™ï¼Œå¡ç‰Œå¸è¡€æ•ˆæœä¿æŒä¸å˜
                        healAmount = Math.min(damage, gameState.playerMaxHp - gameState.playerHp);
                    } else if (card.lifesteal) {
                        // åªæœ‰å¡ç‰Œå¸è¡€æ•ˆæœ
                        healAmount = Math.min(damage, gameState.playerMaxHp - gameState.playerHp);
                    } else {
                        // åªæœ‰å¸è¡€é¬¼ä¹‹ç‰™ï¼Œæ•ˆæœå‰Šå¼±è‡³50%
                        healAmount = Math.min(Math.floor(damage * 0.5), gameState.playerMaxHp - gameState.playerHp);
                    }
                    gameState.playerHp += healAmount;
                    showDamageNumber(healAmount, true, 'player');
                    if (card.lifesteal) {
                        addLog(`å¸è¡€æ¢å¤äº† ${healAmount} ç‚¹ç”Ÿå‘½å€¼ï¼`);
                    } else {
                        addLog(`å¸è¡€é¬¼ä¹‹ç‰™ï¼šæ¢å¤äº† ${healAmount} ç‚¹ç”Ÿå‘½å€¼ï¼`);
                    }
                }
                
                // æº…å°„ä¼¤å®³
                if (card.splash && gameState.enemies && gameState.enemies.length > 1) {
                    let splashTargets = 0;
                    for (let i = 0; i < gameState.enemies.length; i++) {
                        if (gameState.enemies[i].hp > 0 && gameState.enemies[i] !== gameState.currentEnemy) {
                            gameState.enemies[i].hp -= card.splash;
                            splashTargets++;
                        }
                    }
                    if (splashTargets > 0) {
                        addLog(`${cardName} é€ æˆäº† ${card.splash} ç‚¹æº…å°„ä¼¤å®³ï¼`);
                    }
                }
                
                // çœ©æ™•æ•ˆæœ
                if (card.stun) {
                    // æ£€æŸ¥çœ©æ™•ç–²åŠ³æœºåˆ¶
                    const isBoss = gameState.currentEnemy && gameState.currentEnemy.isBoss;
                    const maxStunCount = isBoss ? 2 : 3;
                    
                    if (gameState.stunCount < maxStunCount) {
                        gameState.enemyStunned = card.stun;
                        gameState.stunCount++;
                        addLog(`${cardName} çœ©æ™•äº†æ•Œäºº ${card.stun} å›åˆï¼`);
                    } else {
                        addLog(`æ§åˆ¶ç–²åŠ³ï¼${cardName} çš„çœ©æ™•æ•ˆæœå¯¹æ•Œäººæ— æ•ˆï¼`);
                    }
                }
            }
            
            if (card.block) {
                gameState.playerBlock = (gameState.playerBlock || 0) + card.block;
                addLog(`${cardName} è·å¾—äº† ${card.block} ç‚¹æŠ¤ç›¾ï¼`);
            }
            
            if (card.heal) {
                let healAmount = card.heal;
                // åº”ç”¨ç‰§å¸ˆçš„æ²»ç–—åŠ æˆ
                if (gameState.selectedCharacter === 'priest' && characters.priest) {
                    healAmount += (characters.priest.healingPower || 0);
                }
                healAmount = Math.min(healAmount, gameState.playerMaxHp - gameState.playerHp);
                gameState.playerHp += healAmount;
                showDamageNumber(healAmount, true, 'player');
                addLog(`${cardName} æ¢å¤äº† ${healAmount} ç‚¹ç”Ÿå‘½å€¼ï¼`);
            }
            
            if (card.poison) {
                gameState.enemyPoison = (gameState.enemyPoison || 0) + card.poison;
                addLog(`${cardName} ç»™æ•Œäººæ–½åŠ äº† ${card.poison} å±‚æ¯’ç´ ï¼`);
            }
            
            // æµè¡€æ•ˆæœ
            if (card.bleed) {
                gameState.enemyBleed = (gameState.enemyBleed || 0) + card.bleed;
                addLog(`${cardName} ç»™æ•Œäººæ–½åŠ äº† ${card.bleed} å±‚æµè¡€ï¼`);
            }
            
            if (card.burn) {
                gameState.enemyBurn = (gameState.enemyBurn || 0) + card.burn;
                addLog(`${cardName} ç»™æ•Œäººæ–½åŠ äº† ${card.burn} å±‚ç‡ƒçƒ§ï¼`);
            }
            
            if (card.freeze) {
                // æ£€æŸ¥å†°å†»ç–²åŠ³æœºåˆ¶
                const isBoss = gameState.currentEnemy && gameState.currentEnemy.isBoss;
                const maxFreezeCount = isBoss ? 2 : 3;
                
                if (gameState.freezeCount < maxFreezeCount) {
                    gameState.enemyFrozen = card.freeze;
                    gameState.freezeCount++;
                    addLog(`${cardName} å†°å†»äº†æ•Œäºº ${card.freeze} å›åˆï¼`);
                } else {
                    addLog(`æ§åˆ¶ç–²åŠ³ï¼${cardName} çš„å†°å†»æ•ˆæœå¯¹æ•Œäººæ— æ•ˆï¼`);
                }
            }
            
            if (card.stealth) {
                // å¢åŠ æ½œè¡Œä½¿ç”¨æ¬¡æ•°
                gameState.stealthCount = (gameState.stealthCount || 0) + 1;
                
                // è®¡ç®—å¤±è´¥æ¦‚ç‡ï¼šä½¿ç”¨è¶…è¿‡2æ¬¡åï¼Œæ¯å¤šä½¿ç”¨ä¸€æ¬¡å¢åŠ 20%å¤±è´¥æ¦‚ç‡
                let failChance = 0;
                if (gameState.stealthCount > 2) {
                    failChance = Math.min(0.8, (gameState.stealthCount - 2) * 0.2);
                }
                
                // æ£€æŸ¥æ˜¯å¦æˆåŠŸ
                if (Math.random() >= failChance) {
                    gameState.stealthTurns = 1;
                    addLog(`${cardName} è¿›å…¥æ½œè¡ŒçŠ¶æ€ï¼`);
                    
                    // å¦‚æœå·²ç»æœ‰è¾ƒé«˜çš„å¤±è´¥æ¦‚ç‡ï¼Œæé†’ç©å®¶
                    if (failChance > 0) {
                        addLog(`âš ï¸ æ½œè¡Œç–²åŠ³ï¼šä¸‹æ¬¡å°è¯•æœ‰ ${Math.floor(failChance * 100)}% æ¦‚ç‡å¤±è´¥ï¼`);
                    }
                } else {
                    addLog(`${cardName} å°è¯•è¿›å…¥æ½œè¡ŒçŠ¶æ€ï¼Œä½†å¤±è´¥äº†ï¼`);
                    addLog(`âš ï¸ æ½œè¡Œç–²åŠ³ï¼šå½“å‰æœ‰ ${Math.floor(failChance * 100)}% æ¦‚ç‡å¤±è´¥ï¼`);
                }
            }
            
            if (card.counter) {
                gameState.counterDamage = (gameState.counterDamage || 0) + card.counter;
                addLog(`${cardName} è·å¾—äº† ${card.counter} ç‚¹åå‡»ä¼¤å®³ï¼`);
            }
            
            if (card.thorns) {
                gameState.playerThorns = (gameState.playerThorns || 0) + card.thorns;
                addLog(`${cardName} è·å¾—äº† ${card.thorns} å±‚è†æ£˜ï¼`);
            }
            
            // æ— æ•Œæ•ˆæœ
            if (card.invulnerable) {
                gameState.playerInvulnerable = card.invulnerable;
                addLog(`${cardName} è·å¾—äº† ${card.invulnerable} å›åˆæ— æ•Œæ•ˆæœï¼`);
                
                // å¦‚æœå¡ç‰Œæœ‰exhaustå±æ€§ï¼Œä½¿ç”¨åæ¶ˆè€—
                if (card.exhaust) {
                    addLog(`${cardName} ä½¿ç”¨åè¢«æ¶ˆè€—ï¼`);
                }
            }
            
            // å˜²è®½æ•ˆæœ
            if (card.taunt) {
                gameState.tauntActive = true;
                addLog(`${cardName} å¸å¼•æ•Œäººæ”»å‡»ï¼`);
            }
            
            // ææƒ§æ•ˆæœ
            if (card.fear && card.type !== 'curse') {
                // æ£€æŸ¥ææƒ§ç–²åŠ³æœºåˆ¶
                const isBoss = gameState.currentEnemy && gameState.currentEnemy.isBoss;
                const maxFearCount = isBoss ? 2 : 3;
                
                if (gameState.fearCount < maxFearCount) {
                    gameState.enemyFear = 1; // ä½¿æ•Œäººææƒ§1å›åˆ
                    gameState.fearCount++;
                    addLog(`${cardName} ä½¿æ•Œäººææƒ§ï¼Œè·³è¿‡ä¸‹å›åˆï¼`);
                } else {
                    addLog(`æ§åˆ¶ç–²åŠ³ï¼${cardName} çš„ææƒ§æ•ˆæœå¯¹æ•Œäººæ— æ•ˆï¼`);
                }
            }
            
            // å„è¿æ•ˆæœ
            if (card.bad_luck) {
                const badLuckDuration = card.duration || 1;
                gameState.badLuckActive = badLuckDuration;
                addLog(`${cardName} å¸¦æ¥äº†å„è¿ï¼Œ${badLuckDuration}å›åˆå†…æ‰€æœ‰æ•ˆæœå‡åŠï¼`);
            }
            
            // Buffæ•ˆæœ
            if (card.buff) {
                // ç‰¹æ®Šå¤„ç†ç²¾å‡†buffï¼ˆé¹°çœ¼æ•ˆæœï¼‰
                if (card.buff === 'precision') {
                    gameState.precisionStacks += (card.stacks || 1);
                    addLog(`${cardName} è·å¾—äº† ${card.stacks || 1} å±‚ç²¾å‡†ï¼ä¸‹æ¬¡è¿œç¨‹æ”»å‡»+${(card.stacks || 1) * 4} ä¼¤å®³ï¼`);
                } else {
                    let buff = gameState.buffs.find(b => b.name === card.buff);
                    const stacks = card.stacks || 1;
                    if (buff) {
                        buff.stacks += stacks;
                    } else {
                        const buffNames = {
                            'rage': 'ç‹‚æ€’',
                            'armor': 'æŠ¤ç”²',
                            'frenzy': 'ç‹‚çƒ­',
                            'power': 'åŠ›é‡',
                            'strength': 'åŠ›é‡',
                            'spellpower': 'æ³•æœ¯å¼ºåº¦'
                        };
                        gameState.buffs.push({ name: buffNames[card.buff] || card.buff, stacks: stacks, type: card.buff });
                    }
                    addLog(`${cardName} å¢åŠ äº†${card.buff === 'strength' ? 'åŠ›é‡' : card.buff === 'spellpower' ? 'æ³•æœ¯å¼ºåº¦' : card.buff}æ•ˆæœï¼`);
                }
            }
            
            // å¤„ç†çŒäººæ ‡è®°æ•ˆæœ
            if (card.mark) {
                gameState.enemyMarked = true;
                addLog(`${cardName} æ ‡è®°äº†æ•Œäººï¼æ‰€æœ‰å¯¹å…¶çš„æ”»å‡»+3ä¼¤å®³ï¼`);
            }
            
            if (card.draw) {
                drawCards(card.draw);
                addLog(`${cardName} æŠ½äº† ${card.draw} å¼ ç‰Œï¼`);
            }
            
            if (card.energy_gain) {
                gameState.energy += card.energy_gain;
                addLog(`${cardName} è·å¾—äº† ${card.energy_gain} ç‚¹èƒ½é‡ï¼`);
            }
            
            if (card.curse) {
                gameState.enemyCursed = (gameState.enemyCursed || 0) + card.curse;
                addLog(`${cardName} è¯…å’’äº†æ•Œäºº ${card.curse} å›åˆï¼`);
            }
            
            if (card.cleanse) {
                gameState.buffs = gameState.buffs.filter(b => b.type !== 'debuff');
                addLog(`${cardName} å‡€åŒ–äº†æ‰€æœ‰è´Ÿé¢æ•ˆæœï¼`);
            }
            
            if (card.sacrifice) {
                gameState.playerHp -= card.sacrifice;
                addLog(`${cardName} çŒ®ç¥­äº† ${card.sacrifice} ç‚¹ç”Ÿå‘½å€¼ï¼`);
            }
            
            if (card.dodge_next) {
                gameState.dodgeNext = true;
                addLog(`${cardName} ä¸‹æ¬¡æ”»å‡»å¿…å®šé—ªé¿ï¼`);
            }
            
            if (card.clone) {
                gameState.cloneNext = true;
                addLog(`${cardName} ä¸‹å¼ æ”»å‡»ç‰Œå°†æ‰“å‡ºä¸¤æ¬¡ï¼`);
            }
            
            if (card.discard_hand) {
                const discardedCount = gameState.hand.length;
                gameState.discardPile.push(...gameState.hand);
                gameState.hand = [];
                addLog(`${cardName} å¼ƒæ‰äº† ${discardedCount} å¼ æ‰‹ç‰Œï¼`);
                updateHandDisplay();
            }
            
            // çµé­‚é“¾æ¥æ•ˆæœ
            if (card.link) {
                gameState.soulLinkActive = true;
                gameState.soulLinkTurns = card.link_duration || 2;
                addLog(`${cardName} å»ºç«‹äº†çµé­‚é“¾æ¥ï¼Œ${gameState.soulLinkTurns}å›åˆå†…åŒæ–¹ä¼¤å®³å…±äº«ï¼`);
            }
            
            // å…ƒç´ èåˆæ•ˆæœ
            if (card.combine_elements) {
                // è®¡ç®—æ•Œäººèº«ä¸Šçš„è´Ÿé¢æ•ˆæœæ€»æ•°
                const totalEffects = (gameState.enemyBurn || 0) + (gameState.enemyFrozen || 0) + (gameState.enemyPoison || 0) + (gameState.enemyBleed || 0);
                
                // åŸºç¡€ä¼¤å®³å’Œæ¯å±‚æ•ˆæœçš„ä¼¤å®³å€ç‡
                const baseDamage = card.base_damage || 5;
                const effectMultiplier = card.effect_multiplier || 3;
                
                // æ€»ä¼¤å®³ = åŸºç¡€ä¼¤å®³ Ã— (1 + æ•ˆæœæ•°é‡ Ã— å€ç‡)
                const fusionDamage = Math.round(baseDamage * (1 + totalEffects * effectMultiplier));
                
                gameState.currentEnemy.hp -= fusionDamage;
                addLog(`${cardName} èåˆäº† ${totalEffects} ç§è´Ÿé¢æ•ˆæœï¼Œé€ æˆ ${fusionDamage} ç‚¹ä¼¤å®³ï¼`);
            }
            
            // æ— é™å¾ªç¯æ•ˆæœ
            if (card.loop && gameState.hand.length > 0) {
                const randomCard = gameState.hand[Math.floor(Math.random() * gameState.hand.length)];
                gameState.drawPile.unshift(randomCard);
                addLog(`${cardName} å°† ${randomCard} æ”¾å›ç‰Œåº“é¡¶éƒ¨ï¼`);
            }
            
            if (card.lucky) {
                const effects = ['heal', 'energy', 'draw', 'buff'];
                const randomEffect = effects[Math.floor(Math.random() * effects.length)];
                switch(randomEffect) {
                    case 'heal':
                        gameState.playerHp = Math.min(gameState.playerMaxHp, gameState.playerHp + 10);
                        addLog('å¹¸è¿æ•ˆæœï¼šæ¢å¤10ç‚¹ç”Ÿå‘½å€¼ï¼');
                        break;
                    case 'energy':
                        gameState.energy += 2;
                        addLog('å¹¸è¿æ•ˆæœï¼šè·å¾—2ç‚¹èƒ½é‡ï¼');
                        break;
                    case 'draw':
                        drawCards(2);
                        addLog('å¹¸è¿æ•ˆæœï¼šæŠ½2å¼ ç‰Œï¼');
                        break;
                    case 'buff':
                        let buff = gameState.buffs.find(b => b.name === 'åŠ›é‡');
                        if (buff) {
                            buff.stacks++;
                        } else {
                            gameState.buffs.push({ name: 'åŠ›é‡', stacks: 1, type: 'power' });
                        }
                        addLog('å¹¸è¿æ•ˆæœï¼šè·å¾—1å±‚åŠ›é‡ï¼');
                        break;
                }
            }
            
            if (card.exhaust) {
                // ä½¿ç”¨åç§»é™¤çš„å¡ç‰Œé€»è¾‘
                addLog(`${cardName} ä½¿ç”¨åè¢«ç§»é™¤ï¼`);
            }
        }

        // ç»“æŸå›åˆ
        function endTurn() {
            // å°†æ‰‹ç‰Œæ”¾å…¥å¼ƒç‰Œå †ï¼ˆæ’é™¤è¯…å’’å¡ç­‰ä¸å¯ç§»é™¤çš„å¡ç‰Œï¼‰
            gameState.hand.forEach(cardName => {
                const card = cardDatabase[cardName];
                if (!card.unremovable) {
                    gameState.discardPile.push(cardName);
                }
            });
            gameState.hand = [];
            
            // æ•Œäººå›åˆ
            enemyTurn();
            
            // æ£€æŸ¥æ•Œäººæ˜¯å¦æ­»äº¡ï¼ˆåœ¨æ•Œäººå›åˆåï¼‰
            if (gameState.currentEnemy.hp <= 0) {
                victory();
                return;
            }
            
            // æ£€æŸ¥ç©å®¶æ˜¯å¦æ­»äº¡
            if (gameState.playerHp <= 0) {
                gameOver();
                return;
            }
            
            // ç‰§å¸ˆè¢«åŠ¨ï¼šç¥åœ£æ²»ç–—
            if (gameState.passiveAbility === 'holy_healing' && gameState.playerHp < gameState.playerMaxHp * 0.5) {
                const healAmount = 6;
                gameState.playerHp = Math.min(gameState.playerMaxHp, gameState.playerHp + healAmount);
                showDamageNumber(healAmount, true, 'player');
                addLog('ç¥åœ£æ²»ç–—ï¼šæ¢å¤6ç‚¹ç”Ÿå‘½å€¼ï¼');
            }
            
            // å¼€å§‹æ–°çš„ç©å®¶å›åˆ
            startPlayerTurn();
        }
        
        // å¼€å§‹ç©å®¶å›åˆ
        function startPlayerTurn() {
            // ç©å®¶å›åˆå¼€å§‹
            gameState.energy = gameState.maxEnergy;
            gameState.playerBlock = 0; // æŠ¤ç›¾åœ¨å›åˆç»“æŸæ—¶æ¶ˆå¤±
            gameState.comboThisTurn = 0; // é‡ç½®è¿å‡»è®¡æ•°
            gameState.spellsPlayedThisTurn = 0; // é‡ç½®æ³•æœ¯è®¡æ•°
            gameState.firstCardThisTurn = true; // é‡ç½®é¦–å¼ ç‰Œæ ‡è®°
            gameState.fearThisTurn = false; // é‡ç½®ææƒ§çŠ¶æ€
            gameState.cardsPlayedThisTurn = 0; // é‡ç½®æœ¬å›åˆæ‰“ç‰Œè®¡æ•°
            gameState.realityRewrite = false; // é‡ç½®ç°å®é‡æ„æ•ˆæœ
            gameState.tauntActive = false; // é‡ç½®å˜²è®½æ•ˆæœ
            gameState.enemyBleed = 0; // é‡ç½®æµè¡€æ•ˆæœ
            
            // å‡å°‘æ— æ•ŒçŠ¶æ€æŒç»­æ—¶é—´
            if (gameState.playerInvulnerable > 0) {
                gameState.playerInvulnerable--;
                if (gameState.playerInvulnerable === 0) {
                    addLog('æ— æ•ŒçŠ¶æ€æ¶ˆå¤±ï¼');
                }
            }
            
            // å¤„ç†å„è¿æ•ˆæœæŒç»­æ—¶é—´
            if (gameState.badLuckActive > 0) {
                gameState.badLuckActive--;
                if (gameState.badLuckActive <= 0) {
                    addLog('å„è¿æ•ˆæœæ¶ˆå¤±ï¼');
                } else {
                    addLog(`å„è¿æ•ˆæœæŒç»­ä¸­...å‰©ä½™ ${gameState.badLuckActive} å›åˆ`);
                }
            }
            
            // å¤„ç†çµé­‚é“¾æ¥æŒç»­æ—¶é—´
            if (gameState.soulLinkActive) {
                gameState.soulLinkTurns--;
                if (gameState.soulLinkTurns <= 0) {
                    gameState.soulLinkActive = false;
                    addLog('çµé­‚é“¾æ¥æ•ˆæœæ¶ˆå¤±ï¼');
                } else {
                    addLog(`çµé­‚é“¾æ¥æŒç»­ä¸­...å‰©ä½™ ${gameState.soulLinkTurns} å›åˆ`);
                }
            }
            
            // æˆ˜å£«è¢«åŠ¨ï¼šæŠ¤ç”²ç²¾é€š
            if (gameState.passiveAbility === 'armor_mastery') {
                gameState.playerBlock += 2;
                addLog('æŠ¤ç”²ç²¾é€šï¼šè·å¾—2ç‚¹æŠ¤ç›¾ï¼');
            }
            
            // éª‘å£«è¢«åŠ¨ï¼šç¥åœ£å®ˆæŠ¤
            if (gameState.passiveAbility === 'holy_guardian') {
                if (Math.random() < 0.5) {
                    gameState.energy += 1;
                    gameState.playerBlock += 2;
                    addLog('ç¥åœ£å®ˆæŠ¤ï¼šè·å¾—1ç‚¹èƒ½é‡å’Œ2ç‚¹æŠ¤ç›¾ï¼');
                }
            }
            
            // æ°¸æ’å†°æ™¶æ•ˆæœ
            if (gameState.eternalIce) {
                gameState.playerBlock += 3;
                addLog('æ°¸æ’å†°æ™¶ï¼šè·å¾—3ç‚¹æŠ¤ç›¾ï¼');
            }
            
            // ç¥å™¨æ•ˆæœå¤„ç†
            if (gameState.relics) {
                if (gameState.relics.includes('å¹¸è¿ç¡¬å¸') && Math.random() < 0.25) {
                    gameState.energy += 1;
                    addLog('å¹¸è¿ç¡¬å¸ï¼šè·å¾—1ç‚¹é¢å¤–èƒ½é‡ï¼');
                }
                
                if (gameState.relics.includes('è†æ£˜æŠ¤ç¬¦')) {
                    gameState.playerThorns = (gameState.playerThorns || 0) + 3;
                    addLog('è†æ£˜æŠ¤ç¬¦ï¼šè·å¾—3å±‚è†æ£˜ï¼');
                }
            }
            
            // å¤„ç†æ½œè¡Œ
            if (gameState.stealthTurns > 0) {
                gameState.stealthTurns--;
            }
            
            // é‡ç½®çŒäººçš„ç¬¬ä¸€å‘è¿œç¨‹æ”»å‡»æ ‡è®°
            if (gameState.firstRangedAttackThisTurn === false) {
                gameState.firstRangedAttackThisTurn = true;
            }
            
            // ç§»é™¤æœ¯å£«çš„é‚ªèƒ½æ•ˆæœ
            if (gameState.demonicEnergy > 0) {
                gameState.demonicEnergy = 0;
                addLog('é‚ªèƒ½æ•ˆæœæ¶ˆå¤±ï¼');
            }
            
            // å¤„ç†BOSSæˆ˜æ–—ç‰¹æ®ŠçŠ¶æ€
            if (gameState.currentEnemy && gameState.currentEnemy.isBoss) {
                // å¤„ç†ç«ç„°å…‰ç¯
                if (gameState.fireAura > 0) {
                    const fireDamage = 5;
                    gameState.playerHp -= fireDamage;
                    addLog(`ç«ç„°å…‰ç¯é€ æˆäº† ${fireDamage} ç‚¹ä¼¤å®³ï¼`);
                    gameState.fireAura--;
                }
                
                // å¤„ç†ç°å®å´©å¡Œ
                if (gameState.realityCollapse) {
                    const voidDamage = 8;
                    gameState.playerHp -= voidDamage;
                    addLog(`ç°å®å´©å¡Œé€ æˆäº† ${voidDamage} ç‚¹è™šç©ºä¼¤å®³ï¼`);
                }
                
                // å¤„ç†ç©å®¶è¯…å’’çŠ¶æ€
                if (gameState.playerCursed > 0) {
                    gameState.playerCursed--;
                    addLog(`è¯…å’’æ•ˆæœæŒç»­ä¸­...å‰©ä½™ ${gameState.playerCursed} å›åˆ`);
                }
                
                // å¤„ç†æ—¶é—´æ‰­æ›²ï¼ˆæš—å½±é¾™ç‹ç»æœ›é˜¶æ®µï¼‰
                if (gameState.timeDistortion) {
                    if (Math.random() < 0.3) {
                        addLog('æ—¶é—´æ‰­æ›²ï¼å›åˆé¡ºåºæ··ä¹±ï¼Œä½ å¤±å»äº†ä¸€å¼ æ‰‹ç‰Œï¼');
                        if (gameState.hand.length > 0) {
                            gameState.discardPile.push(gameState.hand.pop());
                            updateHandDisplay();
                        }
                    }
                }
                
                // å¤„ç†å†°å†»æˆ˜åœºï¼ˆå…ƒç´ é¢†ä¸»å†°éœœå½¢æ€ï¼‰
                if (gameState.frozenField > 0) {
                    const freezeChance = 0.3;
                    if (Math.random() < freezeChance) {
                        addLog('å†°å†»æˆ˜åœºï¼šä½ è¢«å†»ä½äº†ï¼Œæœ¬å›åˆå°‘æŠ½ä¸€å¼ ç‰Œï¼');
                        gameState.frozenDrawPenalty = true;
                    }
                    gameState.frozenField--;
                }
                
                // å¤„ç†é›·ç”µé£æš´ï¼ˆå…ƒç´ é¢†ä¸»é›·ç”µå½¢æ€ï¼‰
                if (gameState.stormField > 0) {
                    const lightningDamage = 4;
                    gameState.playerHp -= lightningDamage;
                    addLog(`é›·ç”µé£æš´å‡»ä¸­äº†ä½ ï¼Œé€ æˆäº† ${lightningDamage} ç‚¹ä¼¤å®³ï¼`);
                    gameState.stormField--;
                }
                
                // å¤„ç†ç¥åœ£æŠ¤ç›¾ï¼ˆåˆ›ä¸–ç¥è¯•ç‚¼é˜¶æ®µï¼‰
                if (gameState.divineShield > 0) {
                    addLog(`ç¥åœ£æŠ¤ç›¾ä¿æŠ¤ç€æ•Œäººï¼Œå‡å°‘æ‰€æœ‰ä¼¤å®³ ${Math.floor(gameState.divineShield * 0.2)} ç‚¹ï¼`);
                }
            }
            
            // å¤„ç†ç‹‚çƒ­buff
            const frenzyBuff = gameState.buffs.find(b => b.name === 'ç‹‚çƒ­');
            if (frenzyBuff) {
                drawCards(frenzyBuff.stacks);
                addLog(`ç‹‚çƒ­æ•ˆæœï¼šæŠ½äº† ${frenzyBuff.stacks} å¼ ç‰Œï¼`);
            }
            
            // æŠ½å¡ï¼ˆä¿®å¤ï¼šç¡®ä¿æ¯å›åˆéƒ½æŠ½ç‰Œï¼‰
            const baseDrawCount = 5;
            const rogueBonus = (gameState.selectedCharacter === 'rogue') ? 1 : 0;
            const totalDrawCount = baseDrawCount + rogueBonus;
            
            drawCards(totalDrawCount);
            addLog(`æ–°å›åˆå¼€å§‹ï¼æŠ½äº† ${totalDrawCount} å¼ ç‰Œã€‚`);
            
            updateBattleUI();
        }

        // æ•Œäººå›åˆ
        function enemyTurn() {
            const enemy = gameState.currentEnemy;
            
            // æ£€æŸ¥å¹¶è§¦å‘é™·é˜±æ•ˆæœ
            if (gameState.trapActive) {
                const trapType = gameState.trapType;
                let trapDamage = 0;
                let stunDuration = 0;
                let poisonStacks = 0;
                
                // æ ¹æ®é™·é˜±ç±»å‹è®¾ç½®æ•ˆæœ
                switch(trapType) {
                    case 'trap':
                        trapDamage = 8;
                        stunDuration = 1;
                        break;
                    case 'explosive-trap':
                        trapDamage = 12;
                        // çˆ†ç‚¸é™·é˜±çš„æº…å°„ä¼¤å®³åœ¨executeCardEffectä¸­å·²ç»å¤„ç†
                        break;
                    case 'snake-trap':
                        trapDamage = 6;
                        poisonStacks = 3;
                        break;
                }
                
                // é€ æˆé™·é˜±ä¼¤å®³
                gameState.currentEnemy.hp -= trapDamage;
                showDamageNumber(trapDamage);
                addShakeEffect('enemy');
                addFlashEffect('enemy');
                addLog(`é™·é˜±è§¦å‘ï¼æ•Œäººå—åˆ°äº† ${trapDamage} ç‚¹ä¼¤å®³ï¼`);
                
                // åº”ç”¨çœ©æ™•æ•ˆæœï¼ˆå¦‚æœæœ‰ï¼‰å¹¶æ£€æŸ¥çœ©æ™•ç–²åŠ³æœºåˆ¶
                if (stunDuration > 0) {
                    const isBoss = gameState.currentEnemy && gameState.currentEnemy.isBoss;
                    const maxStunCount = isBoss ? 2 : 3;
                    
                    if (gameState.stunCount < maxStunCount) {
                        gameState.enemyStunned = stunDuration;
                        gameState.stunCount++;
                        addLog(`é™·é˜±è§¦å‘äº†çœ©æ™•æ•ˆæœï¼æ•Œäººè¢«çœ©æ™• ${stunDuration} å›åˆï¼`);
                    } else {
                        addLog(`æ§åˆ¶ç–²åŠ³ï¼é™·é˜±çš„çœ©æ™•æ•ˆæœå¯¹æ•Œäººæ— æ•ˆï¼`);
                    }
                }
                
                // åº”ç”¨æ¯’ç´ æ•ˆæœï¼ˆå¦‚æœæœ‰ï¼‰
                if (poisonStacks > 0) {
                    gameState.enemyPoison = (gameState.enemyPoison || 0) + poisonStacks;
                    addLog(`é™·é˜±è§¦å‘äº†æ¯’ç´ æ•ˆæœï¼æ•Œäººè¢«æ–½åŠ äº† ${poisonStacks} å±‚æ¯’ç´ ï¼`);
                }
                
                // é‡ç½®é™·é˜±çŠ¶æ€
                gameState.trapActive = false;
                gameState.trapType = null;
                
                // æ£€æŸ¥æ•Œäººæ˜¯å¦å› é™·é˜±ä¼¤å®³è€Œæ­»äº¡
                if (gameState.currentEnemy.hp <= 0) {
                    victory();
                    return;
                }
            }
            
            // æ£€æŸ¥ææƒ§çŠ¶æ€
            if (gameState.enemyFear > 0) {
                gameState.enemyFear--;
                addLog(`æ•Œäººè¢«ææƒ§ï¼Œæ— æ³•è¡ŒåŠ¨ï¼`);
                // é‡ç½®æ„å›¾ä¸ºä¸‹å›åˆå‡†å¤‡
                enemy.currentIntent = predictEnemyIntent(enemy);
                return;
            }
            
            // æ£€æŸ¥å†°å†»çŠ¶æ€
            if (gameState.enemyFrozen > 0) {
                gameState.enemyFrozen--;
                addLog(`æ•Œäººè¢«å†°å†»ï¼Œè·³è¿‡å›åˆï¼`);
                // é‡ç½®æ„å›¾ä¸ºä¸‹å›åˆå‡†å¤‡
                enemy.currentIntent = predictEnemyIntent(enemy);
                return;
            }
            
            // æ£€æŸ¥çœ©æ™•çŠ¶æ€
            if (gameState.enemyStunned > 0) {
                addLog(`æ•Œäººè¢«çœ©æ™•ï¼Œæ— æ³•è¡ŒåŠ¨ï¼`);
                // é‡ç½®æ„å›¾ä¸ºä¸‹å›åˆå‡†å¤‡
                enemy.currentIntent = predictEnemyIntent(enemy);
                return;
            }
            
            // æ•ŒäººAIè¡Œä¸º
            executeEnemyAI(enemy);
            
            // å¤„ç†æ•ŒäººçŠ¶æ€æ•ˆæœ
            processEnemyStatusEffects();
            
            // ä¸ºä¸‹å›åˆç”Ÿæˆæ–°çš„æ„å›¾
            enemy.currentIntent = predictEnemyIntent(enemy);
            
            // å¢åŠ å›åˆè®¡æ•°
            enemy.turnCount = (enemy.turnCount || 0) + 1;
            
            // æºåˆé­”é¾™ç‰¹æ®Šå¤„ç†ï¼šç¬¬4é˜¶æ®µ5å›åˆåè¿›å…¥ç¬¬5é˜¶æ®µ
            if (enemy.name === 'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹' && enemy.currentPhase === 3) {
                enemy.phase4Turns = (enemy.phase4Turns || 0) + 1;
                
                // æ˜¾ç¤ºç¬¬4é˜¶æ®µå‰©ä½™å›åˆæ•°
                if (enemy.phase4Turns < 5) {
                    addLog(`æºåˆé­”é¾™æ­»äº¡è½®å›é˜¶æ®µå‰©ä½™å›åˆï¼š${5 - enemy.phase4Turns}`);
                } else {
                    // è¿›å…¥ç¬¬5é˜¶æ®µï¼ˆç»ˆç„‰æ—¶åˆ»ï¼‰
                    enemy.currentPhase = 4;
                    enemy.phaseTransitioned = true;
                    addLog(`ğŸ”¥ ${enemy.name} è¿›å…¥ç»ˆç„‰æ—¶åˆ»ï¼å®Œå…¨è§‰é†’ä¸ºé¾™ç¥å½¢æ€ï¼`);
                    addLog(`æºåˆé­”é¾™çš„åŠ›é‡è¾¾åˆ°äº†é¡¶ç‚¹ï¼ä¸–ç•Œæœ«æ—¥å³å°†æ¥ä¸´ï¼`);
                    
                    // æ‰§è¡Œç¬¬5é˜¶æ®µè½¬æ¢æ•ˆæœ
                    executeBossPhaseTransition(enemy, enemy.phases[4]);
                }
            }
        }
        
        // æ‰§è¡Œæ•ŒäººAI
        function executeEnemyAI(enemy) {
            let damage = enemy.attack;
            let willAttack = true;
            
            // BOSSç‰¹æ®ŠAIé€»è¾‘
            if (enemy.isBoss) {
                executeBossAI(enemy);
                return;
            }
            
            // æ™®é€šæ•ŒäººAIé€»è¾‘
            // æ ¹æ®æ•Œäººèƒ½åŠ›æ‰§è¡Œç‰¹æ®Šè¡Œä¸º
            if (enemy.abilities.includes('stealth') && Math.random() < 0.3) {
                gameState.enemyStealth = 1;
                addLog(`${enemy.name} è¿›å…¥æ½œè¡ŒçŠ¶æ€ï¼`);
                willAttack = false;
            }
            
            if (enemy.abilities.includes('rage') && enemy.hp < enemy.maxHp * 0.5) {
                damage = Math.floor(damage * 1.5);
                addLog(`${enemy.name} è¿›å…¥ç‹‚æ€’çŠ¶æ€ï¼æ”»å‡»åŠ›æå‡ï¼`);
            }
            
            if (enemy.abilities.includes('heal') && enemy.hp < enemy.maxHp * 0.3 && Math.random() < 0.4) {
                const healAmount = Math.floor(enemy.maxHp * 0.2);
                enemy.hp = Math.min(enemy.maxHp, enemy.hp + healAmount);
                addLog(`${enemy.name} æ¢å¤äº† ${healAmount} ç‚¹ç”Ÿå‘½å€¼ï¼`);
                willAttack = false;
            }
            
            if (enemy.abilities.includes('summon_minions') && Math.random() < 0.2) {
                addLog(`${enemy.name} å¬å”¤äº†å°æ€ªï¼ä¸‹å›åˆæ”»å‡»åŠ›ç¿»å€ï¼`);
                gameState.enemyNextTurnDouble = true;
                willAttack = false;
            }
            
            // æ–°å¢ç‰¹æ€§å®ç°
            // é—ªé¿ç‰¹æ€§ - æ¯’è›‡
            if (enemy.abilities.includes('dodge') && Math.random() < 0.25) {
                gameState.enemyDodge = true;
                addLog(`${enemy.name} è¿›å…¥é—ªé¿çŠ¶æ€ï¼æœ¬æ¬¡æ”»å‡»æœ‰30%å‡ ç‡é—ªé¿ï¼`);
            }
            
            // ç²¾å‡†å°„å‡»ç‰¹æ€§ - å“¥å¸ƒæ—å¼“æ‰‹
            if (enemy.abilities.includes('precise_shot')) {
                damage = Math.floor(damage * 1.2);
                addLog(`${enemy.name} å‘åŠ¨ç²¾å‡†å°„å‡»ï¼æ”»å‡»åŠ›æå‡20%ï¼`);
            }
            
            // éª¨ç”²ç‰¹æ€§ - éª·é«…æˆ˜å£«
            if (enemy.abilities.includes('bone_armor') && !enemy.boneArmorActive) {
                enemy.boneArmorActive = true;
                gameState.enemyArmor = (gameState.enemyArmor || 0) + 3;
                addLog(`${enemy.name} æ¿€æ´»äº†éª¨ç”²ï¼è·å¾—3ç‚¹æŠ¤ç”²ï¼`);
            }
            
            // å†°ç”²ç‰¹æ€§ - å†°éœœæ³•å¸ˆ
            if (enemy.abilities.includes('ice_armor') && !enemy.iceArmorActive) {
                enemy.iceArmorActive = true;
                gameState.enemyArmor = (gameState.enemyArmor || 0) + 5;
                addLog(`${enemy.name} æ¿€æ´»äº†å†°ç”²ï¼è·å¾—5ç‚¹æŠ¤ç”²ï¼`);
            }
            
            // ç«ç›¾ç‰¹æ€§ - ç«ç„°æ¶é­”
            if (enemy.abilities.includes('fire_shield') && !enemy.fireShieldActive) {
                enemy.fireShieldActive = true;
                gameState.enemyFireShield = (gameState.enemyFireShield || 0) + 2;
                addLog(`${enemy.name} æ¿€æ´»äº†ç«ç›¾ï¼æ¯æ¬¡å—åˆ°æ”»å‡»ä¼šé€ æˆ2ç‚¹ç‡ƒçƒ§ä¼¤å®³ï¼`);
            }
            
            if (willAttack) {
                executeEnemyAttack(damage);
            }
        }
        
        // æ‰§è¡ŒBOSS AI
        function executeBossAI(enemy) {
            const currentPhase = enemy.phases[enemy.currentPhase];
            const abilities = currentPhase.abilities;
            
            // æ ¹æ®å½“å‰é˜¶æ®µçš„èƒ½åŠ›æ‰§è¡Œè¡ŒåŠ¨
            const selectedAbility = abilities[Math.floor(Math.random() * abilities.length)];
            
            switch(selectedAbility) {
                case 'shadow_breath':
                    const breathDamage = enemy.attack + 5;
                    executeEnemyAttack(breathDamage);
                    addLog(`${enemy.name} é‡Šæ”¾äº†æš—å½±åæ¯ï¼`);
                    break;
                    
                case 'wing_attack':
                    executeEnemyAttack(enemy.attack);
                    addLog(`${enemy.name} ä½¿ç”¨ç¿…è†€æ”»å‡»ï¼`);
                    break;
                    
                case 'shadow_clone':
                    gameState.shadowClones = (gameState.shadowClones || 0) + 1;
                    addLog(`${enemy.name} å¬å”¤äº†æš—å½±åˆ†èº«ï¼ä¸‹å›åˆå°†å—åˆ°é¢å¤–æ”»å‡»ï¼`);
                    break;
                    
                case 'curse_aura':
                    gameState.playerCursed = 2;
                    addLog(`${enemy.name} é‡Šæ”¾è¯…å’’å…‰ç¯ï¼ä½ è¢«è¯…å’’äº†2å›åˆï¼`);
                    break;
                    
                case 'reality_tear':
                    const tearDamage = Math.floor(enemy.attack * 1.5);
                    executeEnemyAttack(tearDamage);
                    gameState.hand.splice(0, 1); // ç§»é™¤ä¸€å¼ æ‰‹ç‰Œ
                    addLog(`${enemy.name} æ’•è£‚ç°å®ï¼é€ æˆå¼ºå¤§ä¼¤å®³å¹¶ç ´åäº†ä¸€å¼ æ‰‹ç‰Œï¼`);
                    break;
                    
                case 'time_distortion':
                    gameState.energy = Math.max(0, gameState.energy - 1);
                    addLog(`${enemy.name} æ‰­æ›²æ—¶é—´ï¼ä½ å¤±å»äº†1ç‚¹èƒ½é‡ï¼`);
                    break;
                    
                case 'final_judgment':
                    const judgmentDamage = Math.floor(gameState.playerMaxHp * 0.3);
                    executeEnemyAttack(judgmentDamage);
                    addLog(`${enemy.name} é‡Šæ”¾æœ€ç»ˆå®¡åˆ¤ï¼é€ æˆå·¨é¢ä¼¤å®³ï¼`);
                    break;
                    
                case 'meteor_strike':
                    executeEnemyAttack(enemy.attack + 8);
                    gameState.enemyBurn = (gameState.enemyBurn || 0) + 2;
                    addLog(`${enemy.name} å¬å”¤æµæ˜Ÿæ‰“å‡»ï¼ä½ è¢«ç‡ƒçƒ§äº†ï¼`);
                    break;
                    
                case 'fire_aura':
                    gameState.fireAura = 3;
                    addLog(`${enemy.name} æ¿€æ´»ç«ç„°å…‰ç¯ï¼æ¥ä¸‹æ¥3å›åˆä½ æ¯å›åˆå—åˆ°ç«ç„°ä¼¤å®³ï¼`);
                    break;
                    
                case 'blizzard':
                    executeEnemyAttack(enemy.attack);
                    gameState.enemyFrozen = 1;
                    addLog(`${enemy.name} å¬å”¤æš´é£é›ªï¼ä½ è¢«å†°å†»äº†1å›åˆï¼`);
                    break;
                    
                case 'chain_lightning':
                    executeEnemyAttack(enemy.attack);
                    gameState.energy = Math.max(0, gameState.energy - 2);
                    addLog(`${enemy.name} é‡Šæ”¾è¿é”é—ªç”µï¼ä½ å¤±å»äº†2ç‚¹èƒ½é‡ï¼`);
                    break;
                     
                // æºåˆé­”é¾™èƒ½åŠ› - ç¬¬ä¸€é˜¶æ®µ
                case 'primal_flame_breath':
                    const flameDamage = enemy.attack + 10;
                    executeEnemyAttack(flameDamage);
                    gameState.enemyBurn = (gameState.enemyBurn || 0) + 3;
                    addLog(`${enemy.name} é‡Šæ”¾åŸå§‹ç«ç„°åæ¯ï¼é€ æˆé«˜é¢ä¼¤å®³å¹¶è®©ä½ ç‡ƒçƒ§3å›åˆï¼`);
                    break;
                     
                case 'dragon_roar':
                    gameState.playerSilenced = 2;
                    gameState.energy = Math.max(0, gameState.energy - 2);
                    addLog(`${enemy.name} å‘å‡ºéœ‡å¤©é¾™åŸï¼ä½ è¢«æ²‰é»˜2å›åˆå¹¶å¤±å»2ç‚¹èƒ½é‡ï¼`);
                    break;
                     
                case 'scale_armor':
                    gameState.scaleArmor = (gameState.scaleArmor || 0) + 2;
                    addLog(`${enemy.name} æ¿€æ´»é³ç‰‡æŠ¤ç”²ï¼è·å¾—2å±‚æŠ¤ç”²ï¼Œæ¯å±‚å‡å°‘3ç‚¹å—åˆ°çš„ä¼¤å®³ï¼`);
                    break;
                     
                // æºåˆé­”é¾™èƒ½åŠ› - ç¬¬äºŒé˜¶æ®µ
                case 'elemental_chaos':
                    const chaosDamage = Math.floor(enemy.attack * 1.3);
                    executeEnemyAttack(chaosDamage);
                    // éšæœºæ–½åŠ ä¸€ä¸ªè´Ÿé¢æ•ˆæœ
                    const negativeEffects = ['enemyBurn', 'enemyFrozen', 'enemyPoison'];
                    const randomEffect = negativeEffects[Math.floor(Math.random() * negativeEffects.length)];
                    gameState[randomEffect] = (gameState[randomEffect] || 0) + 2;
                    const effectNames = {
                        'enemyBurn': 'ç‡ƒçƒ§',
                        'enemyFrozen': 'å†°å†»',
                        'enemyPoison': 'ä¸­æ¯’'
                    };
                    addLog(`${enemy.name} å¼•å‘å…ƒç´ æ··ä¹±ï¼é€ æˆä¼¤å®³å¹¶è®©ä½ ${effectNames[randomEffect]}2å›åˆï¼`);
                    break;
                     
                case 'reality_fracture':
                    const fractureDamage = Math.floor(enemy.attack * 1.5);
                    executeEnemyAttack(fractureDamage);
                    if (gameState.hand.length > 0) {
                        const randomIndex = Math.floor(Math.random() * gameState.hand.length);
                        gameState.hand.splice(randomIndex, 1);
                        addLog(`${enemy.name} æ–­è£‚ç°å®ï¼é€ æˆä¼¤å®³å¹¶æ‘§æ¯äº†ä¸€å¼ éšæœºæ‰‹ç‰Œï¼`);
                    }
                    break;
                     
                case 'time_eclipse':
                    gameState.timeEclipse = 2;
                    gameState.nextDrawCount = Math.max(1, gameState.nextDrawCount - 1);
                    addLog(`${enemy.name} å¼•å‘æ—¶é—´æ—¥é£Ÿï¼æ¥ä¸‹æ¥2å›åˆä½ æ¯å›åˆå°‘æŠ½1å¼ ç‰Œï¼`);
                    break;
                     
                // æºåˆé­”é¾™èƒ½åŠ› - ç¬¬ä¸‰é˜¶æ®µ
                case 'cataclysm':
                    const cataclysmDamage = Math.floor(enemy.attack * 2);
                    executeEnemyAttack(cataclysmDamage);
                    gameState.playerMaxHp -= 10;
                    gameState.playerHp = Math.min(gameState.playerHp, gameState.playerMaxHp);
                    addLog(`${enemy.name} é‡Šæ”¾å¤§ç¾å˜ï¼é€ æˆå·¨é¢ä¼¤å®³å¹¶æ°¸ä¹…é™ä½ä½ çš„æœ€å¤§ç”Ÿå‘½å€¼ï¼`);
                    break;
                     
                case 'void_absorption':
                    const absorptionDamage = enemy.attack;
                    executeEnemyAttack(absorptionDamage);
                    // å¸æ”¶é€ æˆä¼¤å®³çš„30%ä½œä¸ºç”Ÿå‘½å€¼
                    const absorbedHp = Math.floor(absorptionDamage * 0.3);
                    if (gameState.currentEnemy) {
                        gameState.currentEnemy.hp = Math.min(gameState.currentEnemy.hp + absorbedHp, gameState.currentEnemy.maxHp);
                    }
                    addLog(`${enemy.name} å¸æ”¶è™šç©ºèƒ½é‡ï¼é€ æˆä¼¤å®³å¹¶æ¢å¤äº†${absorbedHp}ç‚¹ç”Ÿå‘½å€¼ï¼`);
                    break;
                     
                case 'dragon_madness':
                    gameState.dragonMadness = 2;
                    addLog(`${enemy.name} é™·å…¥ç–¯ç‹‚ï¼æ¥ä¸‹æ¥2å›åˆä¼šè¿ç»­æ”»å‡»2æ¬¡ï¼`);
                    break;
                     
                // æºåˆé­”é¾™èƒ½åŠ› - ç¬¬å››é˜¶æ®µï¼ˆå¤æ´»åï¼‰
                case 'resurrection_flame':
                    executeEnemyAttack(enemy.attack + 5);
                    gameState.playerHp = Math.max(1, Math.floor(gameState.playerHp * 0.8)); // ç‡ƒçƒ§ç”Ÿå‘½å€¼ä¸Šé™
                    addLog(`${enemy.name} é‡Šæ”¾å¤æ´»ç«ç„°ï¼é€ æˆä¼¤å®³å¹¶ç‡ƒçƒ§ä½ çš„ç”Ÿå‘½ä¸Šé™ï¼`);
                    break;
                     
                case 'eternal_agony':
                    gameState.eternalAgony = 3;
                    addLog(`${enemy.name} æ–½åŠ æ°¸æ’ç—›è‹¦ï¼æ¥ä¸‹æ¥3å›åˆæ¯å›åˆå—åˆ°8ç‚¹ä¼¤å®³ï¼`);
                    break;
                     
                case 'life_drain':
                    const drainDamage = 10;
                    gameState.playerHp = Math.max(1, gameState.playerHp - drainDamage);
                    if (gameState.currentEnemy) {
                        gameState.currentEnemy.hp = Math.min(gameState.currentEnemy.hp + drainDamage, gameState.currentEnemy.maxHp);
                    }
                    addLog(`${enemy.name} æ±²å–ä½ çš„ç”Ÿå‘½èƒ½é‡ï¼ä½ å¤±å»10ç‚¹ç”Ÿå‘½å€¼ï¼Œæ•Œäººæ¢å¤10ç‚¹ç”Ÿå‘½å€¼ï¼`);
                    break;
                     
                // æºåˆé­”é¾™èƒ½åŠ› - ç¬¬äº”é˜¶æ®µï¼ˆé¾™ç¥å½¢æ€ï¼‰
                case 'apocalypse_beam':
                    const beamDamage = Math.floor(gameState.playerMaxHp * 0.4);
                    executeEnemyAttack(beamDamage);
                    addLog(`${enemy.name} å‘å°„å¯ç¤ºå½•å…‰æŸï¼é€ æˆç›¸å½“äºä½ ç”Ÿå‘½å€¼ä¸Šé™40%çš„ä¼¤å®³ï¼`);
                    break;
                     
                case 'primal_annihilation':
                    // æ‘§æ¯ç©å®¶æ‰€æœ‰æ‰‹ç‰Œå’Œä¸€åŠç‰Œåº“
                    gameState.hand = [];
                    const deckHalf = Math.ceil(gameState.deck.length / 2);
                    gameState.deck = gameState.deck.slice(0, deckHalf);
                    addLog(`${enemy.name} é‡Šæ”¾åŸå§‹æ¹®ç­ï¼æ‘§æ¯äº†ä½ æ‰€æœ‰æ‰‹ç‰Œå’Œä¸€åŠç‰Œåº“ï¼`);
                    break;
                     
                case 'dragon_god_form':
                    gameState.dragonGodForm = true;
                    addLog(`${enemy.name} å®Œå…¨è§‰é†’ä¸ºé¾™ç¥å½¢æ€ï¼æ”»å‡»åŠ›æå‡30%ï¼Œå¹¶ä¸”å…ç–«æ‰€æœ‰è´Ÿé¢æ•ˆæœï¼`);
                    break;
                     
                default:
                    // é»˜è®¤æ”»å‡»
                    executeEnemyAttack(enemy.attack);
                    addLog(`${enemy.name} è¿›è¡Œäº†æ™®é€šæ”»å‡»ï¼`);
                    break;
            }
            
            // å¤„ç†æš—å½±åˆ†èº«æ”»å‡»
            if (gameState.shadowClones > 0) {
                const cloneDamage = Math.floor(enemy.attack * 0.5);
                executeEnemyAttack(cloneDamage);
                addLog(`æš—å½±åˆ†èº«æ”»å‡»é€ æˆäº† ${cloneDamage} ç‚¹é¢å¤–ä¼¤å®³ï¼`);
                gameState.shadowClones--;
            }
        }
        
        // æ‰§è¡Œæ•Œäººæ”»å‡»
        function executeEnemyAttack(damage) {
            // æ£€æŸ¥ç©å®¶æ— æ•ŒçŠ¶æ€
            if (gameState.playerInvulnerable > 0) {
                addLog('æ— æ•ŒçŠ¶æ€ï¼å®Œå…¨å…ç–«äº†æ•Œäººçš„æ”»å‡»ï¼');
                return;
            }
            
            // æ£€æŸ¥æ•Œäººç²¾å‡†å°„å‡»ç‰¹æ€§
            const enemy = gameState.currentEnemy;
            if (enemy && enemy.abilities && enemy.abilities.includes('precise_shot')) {
                // ç²¾å‡†å°„å‡»ï¼šæ•Œäººæ”»å‡»å¿…å®šå‘½ä¸­ï¼Œæ— è§†ç©å®¶é—ªé¿
                damage = Math.floor(damage * 1.2); // ç²¾å‡†å°„å‡»æå‡20%æ”»å‡»åŠ›
                addLog('æ•Œäººå‘åŠ¨ç²¾å‡†å°„å‡»ï¼æ”»å‡»åŠ›æå‡ä¸”æ— è§†é—ªé¿ï¼');
            } else {
                // æ£€æŸ¥ç©å®¶é—ªé¿
                if (gameState.dodgeNext) {
                    gameState.dodgeNext = false;
                    addLog('å®Œç¾é—ªé¿äº†æ•Œäººçš„æ”»å‡»ï¼');
                    return;
                }
                
                // æ£€æŸ¥ç©å®¶é—ªé¿å‡ ç‡
                if (gameState.dodgeChance && Math.random() < gameState.dodgeChance) {
                    addLog('æˆåŠŸé—ªé¿äº†æ•Œäººçš„æ”»å‡»ï¼');
                    return;
                }
            }
            
            if (gameState.stealthTurns > 0) {
                addLog('æ•Œäººçš„æ”»å‡»è¢«æ½œè¡Œèº²é¿äº†ï¼');
                return;
            }
            
            // è™šç©ºå›ä¸»èƒ½é‡å½¢æ€ï¼šç‰©ç†æ”»å‡»å‡åŠ
            if (gameState.energyForm) {
                const reducedDamage = Math.floor(damage * 0.5);
                const damageReduction = damage - reducedDamage;
                damage = reducedDamage;
                addLog('è™šç©ºå›ä¸»å¤„äºèƒ½é‡å½¢æ€ï¼ç‰©ç†æ”»å‡»ä¼¤å®³å‡å°‘äº†' + damageReduction + 'ç‚¹ï¼');
            }
            
            // åˆ›ä¸–ç¥ç”Ÿæ­»è½®å›å’Œæ°¸æ’è½®å›ï¼šæ­»äº¡æ—¶æœ‰å‡ ç‡å¤æ´»
            if ((gameState.rebirthCycle || gameState.eternalCycle) && gameState.playerHp - damage <= 0) {
                let triggerChance = gameState.eternalCycle ? 0.4 : 0.3; // æ°¸æ’è½®å›æœ‰æ›´é«˜çš„è§¦å‘å‡ ç‡
                
                if (Math.random() < triggerChance) {
                    gameState.playerHp = Math.floor(gameState.playerMaxHp * 0.2);
                    
                    if (gameState.eternalCycle) {
                        // æ°¸æ’è½®å›é¢å¤–æ•ˆæœï¼šè·å¾—æ‰€æœ‰ä¼ å¥‡å¡ç‰Œ
                        const allLegendaryCards = availableCards.filter(card => card.rarity === 'legendary');
                        gameState.hand = gameState.hand.concat(allLegendaryCards);
                        gameState.eternalCycle = false; // æ¶ˆè€—æ°¸æ’è½®å›æ•ˆæœ
                        addLog('åˆ›ä¸–ç¥çš„æ°¸æ’è½®å›è§¦å‘ï¼ä½ ä»¥20%ç”Ÿå‘½å€¼å¤æ´»å¹¶è·å¾—äº†æ‰€æœ‰ä¼ å¥‡å¡ç‰Œï¼');
                    } else {
                        addLog('åˆ›ä¸–ç¥çš„ç”Ÿæ­»è½®å›è§¦å‘ï¼ä½ ä»¥20%ç”Ÿå‘½å€¼å¤æ´»ï¼');
                    }
                    
                    return; // è·³è¿‡æœ¬æ¬¡ä¼¤å®³
                }
            }
            
            // åº”ç”¨è¯…å’’æ•ˆæœ
            if (gameState.enemyCursed > 0) {
                damage += 3;
                addLog('è¯…å’’å¢åŠ äº†æ•Œäººå—åˆ°çš„ä¼¤å®³ï¼');
            }
            
            // åº”ç”¨æŠ¤ç”²å‡ä¼¤
            const armorBuff = gameState.buffs.find(b => b.name === 'æŠ¤ç”²');
            if (armorBuff) {
                damage = Math.max(1, damage - armorBuff.stacks);
                addLog(`æŠ¤ç”²å‡å°‘äº† ${armorBuff.stacks} ç‚¹ä¼¤å®³ï¼`);
            }
            
            // æŠ¤ç›¾å‡ä¼¤
            if (gameState.playerBlock > 0) {
                const blockedDamage = Math.min(damage, gameState.playerBlock);
                damage -= blockedDamage;
                gameState.playerBlock -= blockedDamage;
                addLog(`æŠ¤ç›¾æŠµæŒ¡äº† ${blockedDamage} ç‚¹ä¼¤å®³ï¼`);
            }
            
            // åº”ç”¨æœ€ç»ˆä¼¤å®³
            if (damage > 0) {
                // æ£€æŸ¥æ˜¯å¦ä¸ºç¥åœ£ä¼¤å®³ï¼ˆåˆ›ä¸–ç¥çš„æ”»å‡»ï¼‰
                let isHolyDamage = false;
                const enemy = gameState.currentEnemy;
                if (enemy && (enemy.name === 'åˆ›ä¸–ç¥' || 
                    (enemy.abilities && (enemy.abilities.includes('divine_judgment') || enemy.abilities.includes('holy_light'))))) {
                    isHolyDamage = true;
                }
                
                // åº”ç”¨ç¥åœ£ä¼¤å®³å‡å…
                let finalDamage = damage;
                if (isHolyDamage && gameState.holyResistance) {
                    const reducedDamage = Math.floor(damage * (1 - gameState.holyResistance));
                    const damageReduction = damage - reducedDamage;
                    finalDamage = reducedDamage;
                    addLog(`ç¥åœ£å®ˆæŠ¤ï¼šå‡å°‘äº† ${damageReduction} ç‚¹ç¥åœ£ä¼¤å®³ï¼`);
                }
                
                gameState.playerHp -= finalDamage;
                showDamageNumber(damage, false, 'player');
                addShakeEffect('player');
                addFlashEffect('player');
                addLog(`æ•Œäººæ”»å‡»é€ æˆäº† ${damage} ç‚¹ä¼¤å®³ï¼`);
                
                // çµé­‚é“¾æ¥æ•ˆæœ
                if (gameState.soulLinkActive) {
                    const sharedDamage = Math.floor(damage / 3);
                    gameState.currentEnemy.hp -= sharedDamage;
                    addLog(`çµé­‚é“¾æ¥ï¼šæ•Œäººå—åˆ°äº† ${sharedDamage} ç‚¹å…±äº«ä¼¤å®³ï¼`);
                }
                
                // åå‡»ä¼¤å®³
                if (gameState.counterDamage > 0) {
                    gameState.currentEnemy.hp -= gameState.counterDamage;
                    showDamageNumber(gameState.counterDamage);
                    addShakeEffect('enemy');
                    addLog(`åå‡»é€ æˆäº† ${gameState.counterDamage} ç‚¹ä¼¤å®³ï¼`);
                    gameState.counterDamage = 0;
                }
                
                // è†æ£˜ä¼¤å®³
                if (gameState.playerThorns > 0) {
                    gameState.currentEnemy.hp -= gameState.playerThorns;
                    showDamageNumber(gameState.playerThorns);
                    addShakeEffect('enemy');
                    addLog(`è†æ£˜é€ æˆäº† ${gameState.playerThorns} ç‚¹ä¼¤å®³ï¼`);
                }
            }
            
            // æ£€æŸ¥ç©å®¶æ˜¯å¦æ­»äº¡
            if (gameState.playerHp <= 0) {
                // æ£€æŸ¥é‡ç”Ÿæ•ˆæœ
                const reviveBuff = gameState.buffs.find(b => b.name === 'é‡ç”Ÿ');
                if (reviveBuff) {
                    gameState.playerHp = Math.floor(gameState.playerMaxHp * 0.5);
                    gameState.buffs = gameState.buffs.filter(b => b.name !== 'é‡ç”Ÿ');
                    addLog('é‡ç”Ÿæ•ˆæœè§¦å‘ï¼å¤æ´»å¹¶æ¢å¤50%ç”Ÿå‘½å€¼ï¼');
                } else {
                    gameOver();
                }
            }
        }
        
        // å¤„ç†æ•ŒäººçŠ¶æ€æ•ˆæœ
        function processEnemyStatusEffects() {
            // æ¯’ç´ ä¼¤å®³
            if (gameState.enemyPoison > 0) {
                gameState.currentEnemy.hp -= gameState.enemyPoison;
                addLog(`æ•Œäººå—åˆ° ${gameState.enemyPoison} ç‚¹æ¯’ç´ ä¼¤å®³ï¼`);
                gameState.enemyPoison = Math.max(0, gameState.enemyPoison - 1);
            }
            
            // ç‡ƒçƒ§ä¼¤å®³
            if (gameState.enemyBurn > 0) {
                gameState.currentEnemy.hp -= gameState.enemyBurn * 2;
                addLog(`æ•Œäººå—åˆ° ${gameState.enemyBurn * 2} ç‚¹ç‡ƒçƒ§ä¼¤å®³ï¼`);
                gameState.enemyBurn = Math.max(0, gameState.enemyBurn - 1);
            }
            
            // æµè¡€ä¼¤å®³
            if (gameState.enemyBleed > 0) {
                const bleedDamage = Math.floor(gameState.enemyBleed * 0.75); // ä½¿ç”¨0.75çš„å€ç‡é™ä½æµè¡€ä¼¤å®³
                gameState.currentEnemy.hp -= bleedDamage;
                addLog(`æ•Œäººå—åˆ° ${bleedDamage} ç‚¹æµè¡€ä¼¤å®³ï¼`);
                // æµè¡€æ•ˆæœä¸é€’å‡
            }
            
            // è¯…å’’æŒç»­æ—¶é—´
            if (gameState.enemyCursed > 0) {
                gameState.enemyCursed--;
            }
            
            // çœ©æ™•æŒç»­æ—¶é—´
            if (gameState.enemyStunned > 0) {
                gameState.enemyStunned--;
            }
            
            // æºåˆé­”é¾™ç‰¹æ®ŠçŠ¶æ€æ•ˆæœå¤„ç†
            const enemy = gameState.currentEnemy;
            if (enemy && enemy.name === 'æºåˆé­”é¾™å°¼ä¼¯ç½—æ ¹') {
                // å¤„ç†æ°¸æ’ç—›è‹¦çŠ¶æ€ï¼ˆç©å®¶æŒç»­å—åˆ°ä¼¤å®³ï¼‰
                if (gameState.eternalPain > 0) {
                    const painDamage = 5;
                    gameState.playerHp = Math.max(0, gameState.playerHp - painDamage);
                    showDamageNumber(painDamage);
                    addFlashEffect('player');
                    addLog(`æ°¸æ’ç—›è‹¦ï¼ä½ å—åˆ° ${painDamage} ç‚¹ä¼¤å®³ï¼`);
                    gameState.eternalPain--;
                }
                
                // å¤„ç†æ­»äº¡è½®å›é˜¶æ®µçš„ä¸æ­»ç‰¹æ€§
                if (enemy.currentPhase === 3 && gameState.deathImmunity > 0) {
                    // æ­»äº¡è½®å›é˜¶æ®µç»“æŸï¼Œæ¸…é™¤ä¸æ­»ç‰¹æ€§
                    if (enemy.phase4Turns >= 5) {
                        gameState.deathImmunity = 0;
                        addLog(`æºåˆé­”é¾™çš„ä¸æ­»ç‰¹æ€§æ¶ˆå¤±ï¼ç°åœ¨å¯ä»¥çœŸæ­£æ¶ˆç­å®ƒäº†ï¼`);
                    }
                }
                
                // å¤„ç†ç»ˆç„‰æ—¶åˆ»é˜¶æ®µçš„æ— æ•ŒçŠ¶æ€
                if (enemy.currentPhase === 4 && gameState.eternalShield > 0) {
                    gameState.eternalShield--;
                    if (gameState.eternalShield === 0) {
                        addLog(`æºåˆé­”é¾™çš„æ— æ•ŒæŠ¤ç›¾æ¶ˆå¤±äº†ï¼ç°åœ¨æ˜¯å‡»è´¥å®ƒçš„æœ€ä½³æ—¶æœºï¼`);
                    }
                }
            }
        }

        // æ’¤é€€
        function retreat() {
            gameState.playerHp = Math.max(1, gameState.playerHp - 10);
            addLog('æ’¤é€€æˆåŠŸï¼Œä½†æŸå¤±äº†10ç‚¹ç”Ÿå‘½å€¼ï¼');
            showScreen('deckScreen');
            updateDeckDisplay();
            updateUI();
        }

        // æ£€æŸ¥æˆå°±
        function checkAchievements() {
            // åˆæ¬¡èƒœåˆ©
            if (!achievements.first_victory.unlocked && gameState.level >= 2) {
                unlockAchievement('first_victory');
            }
            
            // BOSSæ€æ‰‹
            if (!achievements.boss_slayer.unlocked && gameState.currentEnemy && gameState.currentEnemy.isBoss) {
                unlockAchievement('boss_slayer');
            }
            
            // ä¼ å¥‡æ”¶è—å®¶
            if (!achievements.legendary_collector.unlocked) {
                const hasLegendary = gameState.playerDeck.some(card => cardDatabase[card] && cardDatabase[card].rarity === 'legendary');
                if (hasLegendary) {
                    unlockAchievement('legendary_collector');
                }
            }
            
            // è¿å‡»å¤§å¸ˆ
            if (!achievements.combo_master.unlocked && gameState.cardsPlayedThisTurn >= 5) {
                unlockAchievement('combo_master');
            }
            
            // å¹¸å­˜è€…
            if (!achievements.survivor.unlocked && gameState.playerHp <= 10 && gameState.currentEnemy && gameState.currentEnemy.hp <= 0) {
                unlockAchievement('survivor');
            }
            
            // å®Œç¾ä¸»ä¹‰è€…
            if (!achievements.perfectionist.unlocked && gameState.battleStartHp && gameState.playerHp >= gameState.battleStartHp) {
                unlockAchievement('perfectionist');
            }
            
            // å›¤ç§¯è€…
            if (!achievements.hoarder.unlocked && gameState.gold >= 100) {
                unlockAchievement('hoarder');
            }
            
            // é£å‡è€…
            if (!achievements.ascension.unlocked && gameState.difficultyMultiplier && gameState.difficultyMultiplier > 1) {
                unlockAchievement('ascension');
            }
        }

        // è§£é”æˆå°±
        function unlockAchievement(achievementId) {
            if (!achievements[achievementId].unlocked) {
                achievements[achievementId].unlocked = true;
                const achievement = achievements[achievementId];
                addLog(`ğŸ† æˆå°±è§£é”: ${achievement.name} - ${achievement.description}`);
                
                // æˆå°±å¥–åŠ±
                gameState.gold += 25;
                addLog('è·å¾—æˆå°±å¥–åŠ±ï¼š25é‡‘å¸ï¼');
            }
        }

        // æ˜¾ç¤ºæˆå°±åˆ—è¡¨
        function displayAchievements() {
            const achievementsList = document.getElementById('achievementsList');
            achievementsList.innerHTML = '';
            
            Object.entries(achievements).forEach(([id, achievement]) => {
                const achievementCard = document.createElement('div');
                achievementCard.className = 'reward-card';
                achievementCard.style.cssText = `
                    background: ${achievement.unlocked ? 'linear-gradient(135deg, #ffd700, #ffb347)' : 'rgba(255,255,255,0.1)'};
                    border: 2px solid ${achievement.unlocked ? '#ffd700' : '#666'};
                    border-radius: 15px;
                    padding: 20px;
                    text-align: center;
                    color: ${achievement.unlocked ? '#333' : 'white'};
                    cursor: default;
                `;
                
                achievementCard.innerHTML = `
                    <h3>${achievement.unlocked ? 'ğŸ†' : 'ğŸ”’'} ${achievement.name}</h3>
                    <p>${achievement.description}</p>
                    <p style="font-size: 0.9rem; opacity: 0.8;">${achievement.unlocked ? 'å·²è§£é”' : 'æœªè§£é”'}</p>
                `;
                
                achievementsList.appendChild(achievementCard);
            });
        }

        // èƒœåˆ©
        function victory() {
            const enemy = gameState.currentEnemy;
            
            // é‡ç½®çŒäººæ ‡è®°çŠ¶æ€
            gameState.enemyMarked = false;
            
            // è®°å½•æˆ˜æ–—ç»“æŸæ—¶çš„ç”Ÿå‘½å€¼ç”¨äºæˆå°±æ£€æŸ¥
            gameState.battleEndHp = gameState.playerHp;
            
            // æ£€æŸ¥æˆå°±
            checkAchievements();
            
            // æ£€æŸ¥æ˜¯å¦å‡»è´¥äº†BOSS
            if (enemy.isBoss) {
                addLog(`ğŸ† æ­å–œï¼ä½ å‡»è´¥äº†å®ˆå…³BOSSï¼š${enemy.name}ï¼`);
                
                // BOSSé€šå…³å¥–åŠ±
                gameState.gold += 100 + gameState.level * 10;
                addLog('è·å¾—äº†ä¸°åšçš„é‡‘å¸å¥–åŠ±ï¼');
                
                // æ˜¾ç¤ºé€šå…³ç•Œé¢
                document.getElementById('victoryLevel').textContent = gameState.level;
                generateBossRewards();
                showScreen('victoryScreen');
                return;
            }
            
            // æ™®é€šæ•Œäººèƒœåˆ©
            gameState.gold += 20 + gameState.level * 5;
            addLog('èƒœåˆ©ï¼è·å¾—äº†é‡‘å¸å¥–åŠ±ï¼');
            
            // ç¥å™¨æ•ˆæœï¼šæˆ˜å£«ä¹‹é­‚
            if (gameState.relics && gameState.relics.includes('æˆ˜å£«ä¹‹é­‚')) {
                const healAmount = Math.min(10, gameState.playerMaxHp - gameState.playerHp);
                gameState.playerHp += healAmount;
                addLog(`æˆ˜å£«ä¹‹é­‚ï¼šå‡»æ€æ•Œäººåæ¢å¤äº† ${healAmount} ç‚¹ç”Ÿå‘½å€¼ï¼`);
            }
            
            // ç”Ÿæˆå¥–åŠ±
            generateRewards();
            showScreen('rewardScreen');
        }

        // ç”ŸæˆBOSSå¥–åŠ±
        function generateBossRewards() {
            const rewardsContainer = document.getElementById('victoryRewards');
            rewardsContainer.innerHTML = '';
            
            const boss = bosses[gameState.level];
            const legendaryCards = boss.rewards;
            
            // æ˜¾ç¤ºä¼ å¥‡å¡ç‰Œå¥–åŠ±
            legendaryCards.forEach(cardName => {
                const cardElement = createCardElement(cardName, () => {
                    gameState.playerDeck.push(cardName);
                    addLog(`è·å¾—äº†ä¼ å¥‡å¡ç‰Œ: ${cardName}ï¼`);
                    document.querySelectorAll('.reward-card').forEach(card => {
                        card.style.pointerEvents = 'none';
                        card.style.opacity = '0.5';
                    });
                });
                cardElement.classList.add('reward-card');
                cardElement.style.margin = '10px';
                rewardsContainer.appendChild(cardElement);
            });
            
            // æ·»åŠ ä¼ å¥‡BUFFå¥–åŠ±é€‰é¡¹
            const legendaryBuff = document.createElement('div');
            legendaryBuff.className = 'reward-card';
            legendaryBuff.style.cssText = `
                background: linear-gradient(135deg, #ffd700, #ff8c00);
                border: 3px solid #ffff00;
                border-radius: 15px;
                padding: 20px;
                margin: 10px;
                text-align: center;
                cursor: pointer;
                color: #333;
                font-weight: bold;
                box-shadow: 0 4px 12px rgba(255, 215, 0, 0.8);
            `;
            legendaryBuff.innerHTML = `
                <h3>ğŸŒŸ ä¼ å¥‡å¼ºåŒ–</h3>
                <p>æœ€å¤§ç”Ÿå‘½å€¼ +50</p>
                <p>æœ€å¤§èƒ½é‡ +2</p>
                <p>æ°¸ä¹…è·å¾—3å±‚åŠ›é‡</p>
            `;
            addTouchAndClickEvent(legendaryBuff, () => {
                gameState.playerMaxHp += 50;
                gameState.playerHp += 50;
                gameState.maxEnergy += 2;
                let strengthBuff = gameState.buffs.find(b => b.name === 'åŠ›é‡');
                if (strengthBuff) strengthBuff.stacks += 3;
                else gameState.buffs.push({ name: 'åŠ›é‡', stacks: 3, type: 'power' });
                addLog('è·å¾—äº†ä¼ å¥‡å¼ºåŒ–ï¼');
                document.querySelectorAll('.reward-card').forEach(card => {
                    card.style.pointerEvents = 'none';
                    card.style.opacity = '0.5';
                });
            });
            rewardsContainer.appendChild(legendaryBuff);
        }

        // ç”Ÿæˆå¥–åŠ±
        function generateRewards() {
            const rewardsContainer = document.getElementById('rewards');
            rewardsContainer.innerHTML = '';
            
            // æ ¹æ®å…³å¡ç”Ÿæˆä¸åŒå“è´¨çš„å¥–åŠ±
            const rewardTypes = ['card', 'buff', 'heal', 'relic', 'curse_removal'];
            const selectedTypes = [];
            
            // ç¡®ä¿è‡³å°‘æœ‰ä¸€å¼ å¡ç‰Œå¥–åŠ±
            selectedTypes.push('card');
            
            // éšæœºé€‰æ‹©å¦å¤–ä¸¤ä¸ªå¥–åŠ±
            while (selectedTypes.length < 3) {
                const randomType = rewardTypes[Math.floor(Math.random() * rewardTypes.length)];
                if (!selectedTypes.includes(randomType)) {
                    selectedTypes.push(randomType);
                }
            }
            
            selectedTypes.forEach(type => {
                const rewardCard = document.createElement('div');
                rewardCard.className = 'reward-card';
                
                if (type === 'card') {
                    // æ ¹æ®å…³å¡æä¾›æ›´å¥½çš„å¡ç‰Œï¼Œé«˜å…³å¡æ›´å®¹æ˜“è·å¾—ç¨€æœ‰å¡ç‰Œ
                    const rarityWeights = {
                        'common': Math.max(20, 70 - gameState.level * 5),
                        'uncommon': Math.min(50, 20 + gameState.level * 3),
                        'rare': Math.min(30, gameState.level * 2)
                    };
                    
                    const totalWeight = Object.values(rarityWeights).reduce((a, b) => a + b, 0);
                    let random = Math.random() * totalWeight;
                    let selectedRarity = 'common';
                    
                    for (const [rarity, weight] of Object.entries(rarityWeights)) {
                        random -= weight;
                        if (random <= 0) {
                            selectedRarity = rarity;
                            break;
                        }
                    }
                    
                    const availableCards = Object.keys(cardDatabase).filter(name => {
                        const card = cardDatabase[name];
                        return card.type !== 'curse' && card.rarity === selectedRarity && card.rarity !== 'legendary';
                    });
                    
                    const randomCard = availableCards[Math.floor(Math.random() * availableCards.length)];
                    const rarityText = {
                        'common': 'æ™®é€š',
                        'uncommon': 'ç½•è§',
                        'rare': 'ç¨€æœ‰'
                    };
                    
                    rewardCard.innerHTML = `
                        <h3>ğŸƒ ${rarityText[selectedRarity]}å¡ç‰Œ</h3>
                        <div class="card-art">${createStickmanArt(cardDatabase[randomCard].art)}</div>
                        <p><strong>${randomCard}</strong></p>
                        <p>${cardDatabase[randomCard].description}</p>
                    `;
                    addTouchAndClickEvent(rewardCard, () => {
                        gameState.playerDeck.push(randomCard);
                        addLog(`è·å¾—äº†${rarityText[selectedRarity]}å¡ç‰Œ: ${randomCard}ï¼`);
                        selectReward();
                    });
                } else if (type === 'buff') {
                    const buffOptions = [
                        { name: 'ç”Ÿå‘½å¼ºåŒ–', desc: 'æœ€å¤§ç”Ÿå‘½å€¼ +15', effect: () => { gameState.playerMaxHp += 15; gameState.playerHp += 15; } },
                        { name: 'èƒ½é‡æå‡', desc: 'æœ€å¤§èƒ½é‡ +1', effect: () => { gameState.maxEnergy += 1; } },
                        { name: 'åŠ›é‡ç¥ç¦', desc: 'æ°¸ä¹…è·å¾—2å±‚åŠ›é‡', effect: () => { 
                            let buff = gameState.buffs.find(b => b.name === 'åŠ›é‡');
                            if (buff) buff.stacks += 2;
                            else gameState.buffs.push({ name: 'åŠ›é‡', stacks: 2, type: 'power' });
                        }},
                        { name: 'æŠ¤ç”²å¼ºåŒ–', desc: 'æ°¸ä¹…è·å¾—1å±‚æŠ¤ç”²', effect: () => {
                            let buff = gameState.buffs.find(b => b.name === 'æŠ¤ç”²');
                            if (buff) buff.stacks += 1;
                            else gameState.buffs.push({ name: 'æŠ¤ç”²', stacks: 1, type: 'armor' });
                        }},
                        { name: 'é—ªé¿å¢å¼º', desc: 'è·å¾—5%é—ªé¿å‡ ç‡', effect: () => {
                            gameState.dodgeChance = (gameState.dodgeChance || 0) + 0.05;
                        }},
                        { name: 'æ³•æœ¯ç²¾é€š', desc: 'æ³•æœ¯ä¼¤å®³å¢åŠ 10%', effect: () => {
                            gameState.spellPower = (gameState.spellPower || 0) + 0.1;
                        }},
                        { name: 'è¿å‡»å¤§å¸ˆ', desc: 'è¿å‡»æ•ˆæœå¢å¼º50%', effect: () => {
                            gameState.comboBonus = (gameState.comboBonus || 0) + 0.5;
                        }},
                        { name: 'å¹¸è¿ä¹‹æ˜Ÿ', desc: 'æš´å‡»å‡ ç‡å¢åŠ 5%', effect: () => {
                            gameState.critChance = (gameState.critChance || 0) + 0.05;
                        }},
                        { name: 'ç¥åœ£å®ˆæŠ¤', desc: 'ç¥åœ£ä¼¤å®³å‡å…15%', effect: () => {
                            gameState.holyResistance = (gameState.holyResistance || 0) + 0.15;
                        }},
                        { name: 'é‚ªèƒ½å¢å¹…', desc: 'é‚ªèƒ½ä¼¤å®³å¢åŠ 15%', effect: () => {
                            gameState.felPower = (gameState.felPower || 0) + 0.15;
                        }}
                    ];
                    const selectedBuff = buffOptions[Math.floor(Math.random() * buffOptions.length)];
                    rewardCard.innerHTML = `
                        <h3>ğŸ’ª ${selectedBuff.name}</h3>
                        <p>${selectedBuff.desc}</p>
                        <p>æ°¸ä¹…æ•ˆæœ</p>
                    `;
                    addTouchAndClickEvent(rewardCard, () => {
                        selectedBuff.effect();
                        addLog(`è·å¾—äº†${selectedBuff.name}ï¼`);
                        selectReward();
                    });
                } else if (type === 'heal') {
                    rewardCard.innerHTML = `
                        <h3>â¤ï¸ å®Œå…¨æ²»ç–—</h3>
                        <p>æ¢å¤æ‰€æœ‰ç”Ÿå‘½å€¼</p>
                        <p>ç§»é™¤æ‰€æœ‰è´Ÿé¢æ•ˆæœ</p>
                    `;
                    addTouchAndClickEvent(rewardCard, () => {
                        gameState.playerHp = gameState.playerMaxHp;
                        gameState.buffs = gameState.buffs.filter(b => b.type !== 'debuff');
                        addLog('ç”Ÿå‘½å€¼å®Œå…¨æ¢å¤ï¼Œè´Ÿé¢æ•ˆæœè¢«æ¸…é™¤ï¼');
                        selectReward();
                    });
                } else if (type === 'relic') {
                    const relics = [
                        { name: 'å¸è¡€é¬¼ä¹‹ç‰™', desc: 'æ‰€æœ‰æ”»å‡»éƒ½æœ‰å¸è¡€æ•ˆæœ' },
                        { name: 'è†æ£˜æŠ¤ç¬¦', desc: 'æ°¸ä¹…è·å¾—3å±‚è†æ£˜' },
                        { name: 'å¹¸è¿ç¡¬å¸', desc: 'æ¯å›åˆå¼€å§‹æ—¶æœ‰25%å‡ ç‡è·å¾—1ç‚¹èƒ½é‡' },
                        { name: 'æˆ˜å£«ä¹‹é­‚', desc: 'æ¯æ¬¡å‡»æ€æ•Œäººåæ¢å¤10ç‚¹ç”Ÿå‘½å€¼' }
                    ];
                    const selectedRelic = relics[Math.floor(Math.random() * relics.length)];
                    rewardCard.innerHTML = `
                        <h3>ğŸº ${selectedRelic.name}</h3>
                        <p>${selectedRelic.desc}</p>
                        <p>ç¥å™¨æ•ˆæœ</p>
                    `;
                    addTouchAndClickEvent(rewardCard, () => {
                        gameState.relics = gameState.relics || [];
                        gameState.relics.push(selectedRelic.name);
                        addLog(`è·å¾—äº†ç¥å™¨: ${selectedRelic.name}ï¼`);
                        selectReward();
                    });
                } else if (type === 'curse_removal') {
                    const curseCards = gameState.playerDeck.filter(card => cardDatabase[card].type === 'curse');
                    if (curseCards.length > 0) {
                        rewardCard.innerHTML = `
                            <h3>âœ¨ å‡€åŒ–ä»ªå¼</h3>
                            <p>ç§»é™¤ä¸€å¼ è¯…å’’å¡ç‰Œ</p>
                            <p>å‡€åŒ–ä½ çš„ç‰Œç»„</p>
                        `;
                        addTouchAndClickEvent(rewardCard, () => {
                            const curseToRemove = curseCards[0];
                            const index = gameState.playerDeck.indexOf(curseToRemove);
                            gameState.playerDeck.splice(index, 1);
                            addLog(`ç§»é™¤äº†è¯…å’’å¡ç‰Œ: ${curseToRemove}ï¼`);
                            selectReward();
                        });
                    } else {
                        // å¦‚æœæ²¡æœ‰è¯…å’’å¡ï¼Œæä¾›é‡‘å¸å¥–åŠ±
                        rewardCard.innerHTML = `
                            <h3>ğŸ’° é‡‘å¸å¥–åŠ±</h3>
                            <p>è·å¾—50é‡‘å¸</p>
                            <p>ç”¨äºå•†åº—è´­ä¹°</p>
                        `;
                        addTouchAndClickEvent(rewardCard, () => {
                            gameState.gold += 50;
                            addLog('è·å¾—äº†50é‡‘å¸ï¼');
                            selectReward();
                        });
                    }
                }
                
                rewardsContainer.appendChild(rewardCard);
            });
        }

        // é€‰æ‹©å¥–åŠ±
        function selectReward() {
            document.querySelectorAll('.reward-card').forEach(card => {
                card.style.pointerEvents = 'none';
                card.style.opacity = '0.5';
            });
            document.getElementById('nextLevel').style.display = 'block';
        }

        // ä¸‹ä¸€å…³
        function nextLevel() {
            gameState.level++;
            // é‡ç½®æ§åˆ¶ç–²åŠ³çŠ¶æ€å’Œæ•ŒäººçŠ¶æ€
            gameState.fearCount = 0;
            gameState.enemyFear = 0;
            gameState.stunCount = 0;
            gameState.freezeCount = 0;
            gameState.stealthCount = 0;
            gameState.enemyMarked = false; // é‡ç½®çŒäººæ ‡è®°çŠ¶æ€
            gameState.precisionStacks = 0; // é‡ç½®ç²¾å‡†å±‚æ•°ï¼ˆé¹°çœ¼æ•ˆæœï¼‰
            
            updateUI();
            showScreen('deckScreen');
            updateDeckDisplay();
        }

        // æ¸¸æˆç»“æŸ
        function gameOver() {
            document.getElementById('finalLevel').textContent = gameState.level;
            
            // æ˜¾ç¤ºæœ¬æ¬¡æ¸¸æˆè§£é”çš„æˆå°±
            const gameOverAchievements = document.getElementById('gameOverAchievements');
            const unlockedCount = Object.values(achievements).filter(a => a.unlocked).length;
            gameOverAchievements.innerHTML = `
                <p>å·²è§£é”æˆå°±: ${unlockedCount}/${Object.keys(achievements).length}</p>
            `;
            
            // æ›´æ–°æˆå°±æ˜¾ç¤º
            displayAchievements();
            
            showScreen('gameOverScreen');
        }

        // ç»§ç»­å†’é™©ï¼ˆéš¾åº¦æå‡ï¼‰
        function continueAdventure() {
            // æ£€æŸ¥æ˜¯å¦å·²é€šå…³ç¬¬25å…³
            if (gameState.level >= 25) {
                // é€šå…³ç¬¬25å…³åï¼Œå¼€å§‹æ–°å‘¨ç›®ï¼ˆé‡ç½®åˆ°ç¬¬1å…³å¹¶æé«˜éš¾åº¦ï¼‰
                gameState.difficultyMultiplier = (gameState.difficultyMultiplier || 1) + 0.5;
                gameState.level = 1;
                addLog(`ğŸ† æ­å–œé€šå…³æ‰€æœ‰å…³å¡ï¼æ–°å‘¨ç›®å¼€å§‹ï¼éš¾åº¦å€æ•°: ${gameState.difficultyMultiplier}`);
            } else {
                // æœªé€šå…³ç¬¬25å…³ï¼Œç»§ç»­ä¸‹ä¸€å…³
                gameState.level++;
                addLog(`ç»§ç»­å†’é™©ï¼å½“å‰ä¸ºç¬¬${gameState.level}å…³`);
            }
            
            // é‡ç½®æ§åˆ¶ç–²åŠ³çŠ¶æ€å’Œæ•ŒäººçŠ¶æ€
            gameState.fearCount = 0;
            gameState.enemyFear = 0;
            gameState.stunCount = 0;
            gameState.freezeCount = 0;
            gameState.stealthCount = 0;
            
            updateUI();
            showScreen('deckScreen');
            updateDeckDisplay();
        }
        
        // è¿”å›ä¸»é¡µ
        function backToMenu() {
            // å®Œå…¨é‡ç½®æ¸¸æˆçŠ¶æ€
            restartGame();
        }

        // é‡æ–°å¼€å§‹
        function restartGame() {
            gameState = {
                level: 1,
                gold: 50,
                selectedCharacter: null,
                playerDeck: [],
                playerHp: 100,
                playerMaxHp: 100,
                energy: 3,
                maxEnergy: 3,
                hand: [],
                buffs: [],
                currentEnemy: null,
                battleLog: [],
                // æ–°å¡ç‰Œæ•ˆæœç›¸å…³çŠ¶æ€
                enemyBleed: 0,
                enemyStunned: 0,
                enemyFear: 0,
                enemyMarked: false, // çŒäººæ ‡è®°çŠ¶æ€
                precisionStacks: 0, // ç²¾å‡†å±‚æ•°ï¼ˆé¹°çœ¼æ•ˆæœï¼‰
                tauntActive: false,
                soulLinkActive: false,
                soulLinkTurns: 0,
                firstRangedAttackThisTurn: true,
                badLuckThisTurn: false,
                // æ§åˆ¶æ•ˆæœç–²åŠ³è®¡æ•°å™¨
                stunCount: 0,
                freezeCount: 0,
                fearCount: 0,
                // æ½œè¡Œæ•ˆæœç–²åŠ³è®¡æ•°å™¨
                stealthCount: 0,
                badLuckActive: 0,
                // æºåˆé­”é¾™ç‰¹æ®ŠçŠ¶æ€
                scaleArmor: 0,
                eternalPain: 0,
                deathReincarnationCount: 0,
                // æ–°è§’è‰²ç›¸å…³å±æ€§
                passiveAbility: '',
                spellsPlayedThisTurn: 0,
                firstCardThisTurn: true,
                demonicEnergy: 0,
                // é™·é˜±ç›¸å…³çŠ¶æ€
                trapActive: false,
                trapType: null
            };
            
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.getElementById('startGame').disabled = true;
            
            showScreen('characterScreen');
            updateUI();
        }

        // æ˜¾ç¤ºå±å¹•
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // æ§åˆ¶æ¸¸æˆç»Ÿè®¡ä¿¡æ¯å’Œæ ‡é¢˜çš„æ˜¾ç¤ºå’Œéšè—
            const gameStats = document.querySelector('.game-stats');
            const gameTitle = document.querySelector('.game-title');
            
            if (gameStats && gameTitle) {
                if (screenId === 'homeScreen') {
                    gameStats.style.display = 'none';
                    gameTitle.style.display = 'none';
                } else {
                    gameStats.style.display = 'flex';
                    gameTitle.style.display = 'block';
                }
            }
            
            // å¦‚æœæ˜¾ç¤ºçš„æ˜¯è§’è‰²é€‰æ‹©ç•Œé¢ï¼Œé‡æ–°ä¸ºæ‰€æœ‰è§’è‰²å¡ç‰‡æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            if (screenId === 'characterScreen') {
                document.querySelectorAll('.character-card').forEach(card => {
                    // å…ˆç§»é™¤æ‰€æœ‰ç°æœ‰çš„ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
                    const newCard = card.cloneNode(true);
                    card.parentNode.replaceChild(newCard, card);
                    // æ·»åŠ æ–°çš„ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
                    addTouchAndClickEvent(newCard, () => selectCharacter(newCard.dataset.character));
                });
            }
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(message) {
            gameState.battleLog.push(message);
            updateBattleLog();
        }

        // æ›´æ–°æˆ˜æ–—æ—¥å¿—
        function updateBattleLog() {
            // ç¡®ä¿å³ä½¿åœ¨BOSSå…³å¡ä¸­ä¹Ÿèƒ½æ­£ç¡®æ‰¾åˆ°æˆ˜æ–—æ—¥å¿—å…ƒç´ 
            let logContainer = document.getElementById('battleLog');
            
            // å¦‚æœæ‰¾ä¸åˆ°ï¼Œå°è¯•é‡æ–°è·å–å…ƒç´ ï¼ˆå¤„ç†åŠ¨æ€åŠ è½½çš„æƒ…å†µï¼‰
            if (!logContainer) {
                // æ£€æŸ¥battleScreenæ˜¯å¦å·²ç»æ˜¾ç¤º
                const battleScreen = document.getElementById('battleScreen');
                if (battleScreen && battleScreen.classList.contains('active')) {
                    // åˆ›å»ºæ—¥å¿—å®¹å™¨å…ƒç´ å¦‚æœä¸å­˜åœ¨
                    logContainer = document.createElement('div');
                    logContainer.id = 'battleLog';
                    logContainer.className = 'log';
                    
                    // æ·»åŠ åˆ°battleScreenä¸­
                    const battleScreenContent = battleScreen.querySelector('div');
                    if (battleScreenContent) {
                        battleScreenContent.appendChild(logContainer);
                    }
                }
            }
            
            if (logContainer) {
                logContainer.innerHTML = '';
                gameState.battleLog.slice(-10).forEach(log => {
                    const logEntry = document.createElement('div');
                    logEntry.className = 'log-entry';
                    logEntry.textContent = log;
                    
                    // æ ¹æ®æ—¥å¿—å†…å®¹æ·»åŠ ä¸åŒçš„CSSç±»ï¼Œåº”ç”¨ä¸åŒçš„é¢œè‰²æ ·å¼
                    if (log.includes('ä¼¤å®³') || log.includes('æ”»å‡»') || log.includes('æ€æ­»')) {
                        logEntry.classList.add('damage');
                    } else if (log.includes('æ¢å¤') || log.includes('æ²»ç–—') || log.includes('ç”Ÿå‘½')) {
                        logEntry.classList.add('heal');
                    } else if (log.includes('è·å¾—') || log.includes('å¢å¼º') || log.includes('æŠ¤ç›¾') || log.includes('èƒ½é‡')) {
                        logEntry.classList.add('buff');
                    } else if (log.includes('è™šå¼±') || log.includes('ä¸­æ¯’') || log.includes('å‡ç›Š') || log.includes('è¯…å’’')) {
                        logEntry.classList.add('debuff');
                    } else {
                        logEntry.classList.add('system');
                    }
                    
                    logContainer.appendChild(logEntry);
                });
                logContainer.scrollTop = logContainer.scrollHeight;
            }
        }

        // å¯åŠ¨æ¸¸æˆ
        initGame();
        
        // æ•™ç¨‹ç³»ç»Ÿé€»è¾‘
        document.addEventListener('DOMContentLoaded', function() {
            // ä½¿ç”¨classé€‰æ‹©å™¨é€‰æ‹©å³ä¸Šè§’çš„æ•™ç¨‹æŒ‰é’®ï¼Œé¿å…idé‡å¤é—®é¢˜
            const tutorialButton = document.querySelector('.tutorial-button');
            const tutorialModal = document.getElementById('tutorialModal');
            const closeTutorial = document.getElementById('closeTutorial');
            const tutorialClose = document.querySelector('.tutorial-close');
            
            // æ˜¾ç¤ºæ•™ç¨‹å¼¹çª—
            function showTutorial() {
                tutorialModal.style.display = 'block';
                // æ·»åŠ æ·¡å…¥åŠ¨ç”»
                setTimeout(() => {
                    tutorialModal.querySelector('.tutorial-content').style.opacity = '1';
                }, 10);
            }
            
            // éšè—æ•™ç¨‹å¼¹çª—
            function hideTutorial() {
                const tutorialContent = tutorialModal.querySelector('.tutorial-content');
                tutorialContent.style.opacity = '0';
                // æ·»åŠ æ·¡å‡ºåŠ¨ç”»
                setTimeout(() => {
                    tutorialModal.style.display = 'none';
                }, 300);
            }
            
            // ç‚¹å‡»æ•™ç¨‹æŒ‰é’®æ˜¾ç¤ºå¼¹çª—
            addTouchAndClickEvent(tutorialButton, showTutorial);
            
            // ç‚¹å‡»å…³é—­æŒ‰é’®éšè—å¼¹çª—
            addTouchAndClickEvent(closeTutorial, hideTutorial);
            addTouchAndClickEvent(tutorialClose, hideTutorial);
            
            // æ·»åŠ æ•™ç¨‹é€‰é¡¹å¡çš„è§¦æ‘¸å’Œç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.tutorial-tab').forEach(tab => {
                addTouchAndClickEvent(tab, (event) => {
                    openTutorialTab(event, tab.dataset.tab);
                });
            });
            
            // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­å¼¹çª—
            window.addEventListener('click', function(event) {
                if (event.target === tutorialModal) {
                    hideTutorial();
                }
            });
            
            // é”®ç›˜Escapeé”®å…³é—­å¼¹çª—
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && tutorialModal.style.display === 'block') {
                    hideTutorial();
                }
            });
        });
        
        // æ•™ç¨‹æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
        function openTutorialTab(evt, tabName) {
            // è·å–æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹å’ŒæŒ‰é’®
            const tabContent = document.getElementsByClassName('tutorial-tab-content');
            const tabLinks = document.getElementsByClassName('tutorial-tab');
            
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            for (let i = 0; i < tabContent.length; i++) {
                tabContent[i].classList.remove('active');
            }
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µæŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
            for (let i = 0; i < tabLinks.length; i++) {
                tabLinks[i].classList.remove('active');
            }
            
            // æ˜¾ç¤ºå½“å‰æ ‡ç­¾é¡µå†…å®¹å¹¶æ¿€æ´»å½“å‰æŒ‰é’®
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
            
            // æ»šåŠ¨åˆ°æ ‡ç­¾é¡µé¡¶éƒ¨
            document.getElementById(tabName).scrollTop = 0;
        }
        
        // æ€ªç‰©å›¾é‰´åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            const monsterPediaButton = document.getElementById('monsterPediaButton');
            const monsterPediaModal = document.getElementById('monsterPediaModal');
            const closeMonsterPedia = document.getElementById('closeMonsterPedia');
            const monsterPediaClose = document.querySelector('.monster-pedia-close');
            
            // æ˜¾ç¤ºæ€ªç‰©å›¾é‰´å¼¹çª—
            function showMonsterPedia() {
                monsterPediaModal.style.display = 'block';
                // æ·»åŠ æ·¡å…¥åŠ¨ç”»
                setTimeout(() => {
                    monsterPediaModal.querySelector('.monster-pedia-content').style.opacity = '1';
                }, 10);
            }
            
            // éšè—æ€ªç‰©å›¾é‰´å¼¹çª—
            function hideMonsterPedia() {
                const monsterPediaContent = monsterPediaModal.querySelector('.monster-pedia-content');
                monsterPediaContent.style.opacity = '0';
                // æ·»åŠ æ·¡å‡ºåŠ¨ç”»
                setTimeout(() => {
                    monsterPediaModal.style.display = 'none';
                }, 300);
            }
            
            // ç‚¹å‡»æ€ªç‰©å›¾é‰´æŒ‰é’®æ˜¾ç¤ºå¼¹çª—
            addTouchAndClickEvent(monsterPediaButton, showMonsterPedia);
            
            // ç‚¹å‡»å…³é—­æŒ‰é’®éšè—å¼¹çª—
            addTouchAndClickEvent(closeMonsterPedia, hideMonsterPedia);
            addTouchAndClickEvent(monsterPediaClose, hideMonsterPedia);
            
            // æ·»åŠ æ€ªç‰©å›¾é‰´é€‰é¡¹å¡çš„è§¦æ‘¸å’Œç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.monster-pedia-tab').forEach(tab => {
                addTouchAndClickEvent(tab, (event) => {
                    openMonsterPediaTab(event, tab.dataset.tab);
                });
            });
            
            // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­å¼¹çª—
            window.addEventListener('click', function(event) {
                if (event.target === monsterPediaModal) {
                    hideMonsterPedia();
                }
            });
            
            // é”®ç›˜Escapeé”®å…³é—­å¼¹çª—
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && monsterPediaModal.style.display === 'block') {
                    hideMonsterPedia();
                }
            });
        });
        
        // æ€ªç‰©å›¾é‰´æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
        function openMonsterPediaTab(evt, tabName) {
            // è·å–æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹å’ŒæŒ‰é’®
            const tabContent = document.getElementsByClassName('monster-pedia-tab-content');
            const tabLinks = document.getElementsByClassName('monster-pedia-tab');
            
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            for (let i = 0; i < tabContent.length; i++) {
                tabContent[i].classList.remove('active');
            }
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µæŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
            for (let i = 0; i < tabLinks.length; i++) {
                tabLinks[i].classList.remove('active');
            }
            
            // æ˜¾ç¤ºå½“å‰æ ‡ç­¾é¡µå†…å®¹å¹¶æ¿€æ´»å½“å‰æŒ‰é’®
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
            
            // æ»šåŠ¨åˆ°æ ‡ç­¾é¡µé¡¶éƒ¨
            document.getElementById(tabName).scrollTop = 0;
        }
    </script>
</body>
</html>
